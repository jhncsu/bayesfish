<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Mortality Components | A Bayesian Introduction to Fish Population Analysis</title>
  <meta name="description" content="This book is intended to be a bridge between traditional fisheries analytical methods and Bayesian statistics. It is a hands-on introduction to models for estimating abundance, survival, growth, and recruitment." />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Mortality Components | A Bayesian Introduction to Fish Population Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book is intended to be a bridge between traditional fisheries analytical methods and Bayesian statistics. It is a hands-on introduction to models for estimating abundance, survival, growth, and recruitment." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Mortality Components | A Bayesian Introduction to Fish Population Analysis" />
  
  <meta name="twitter:description" content="This book is intended to be a bridge between traditional fisheries analytical methods and Bayesian statistics. It is a hands-on introduction to models for estimating abundance, survival, growth, and recruitment." />
  

<meta name="author" content="Joseph E. Hightower" />


<meta name="date" content="2025-01-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Survival.html"/>
<link rel="next" href="Growth.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian fish population analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-information-and-conventions"><i class="fa fa-check"></i>Software information and conventions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="R-intro.html"><a href="R-intro.html"><i class="fa fa-check"></i><b>2</b> A Brief Introduction to R and RStudio</a></li>
<li class="chapter" data-level="3" data-path="Distributions.html"><a href="Distributions.html"><i class="fa fa-check"></i><b>3</b> Probability Distributions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Distributions.html"><a href="Distributions.html#Discrete"><i class="fa fa-check"></i><b>3.1</b> Discrete</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="Distributions.html"><a href="Distributions.html#Bernoulli"><i class="fa fa-check"></i><b>3.1.1</b> Bernoulli</a></li>
<li class="chapter" data-level="3.1.2" data-path="Distributions.html"><a href="Distributions.html#BinomialDist"><i class="fa fa-check"></i><b>3.1.2</b> Binomial</a></li>
<li class="chapter" data-level="3.1.3" data-path="Distributions.html"><a href="Distributions.html#Multinomial"><i class="fa fa-check"></i><b>3.1.3</b> Multinomial</a></li>
<li class="chapter" data-level="3.1.4" data-path="Distributions.html"><a href="Distributions.html#PoissonDist"><i class="fa fa-check"></i><b>3.1.4</b> Poisson</a></li>
<li class="chapter" data-level="3.1.5" data-path="Distributions.html"><a href="Distributions.html#NegBinom"><i class="fa fa-check"></i><b>3.1.5</b> Negative binomial</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="Distributions.html"><a href="Distributions.html#Continuous"><i class="fa fa-check"></i><b>3.2</b> Continuous</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="Distributions.html"><a href="Distributions.html#Uniform"><i class="fa fa-check"></i><b>3.2.1</b> Uniform</a></li>
<li class="chapter" data-level="3.2.2" data-path="Distributions.html"><a href="Distributions.html#BetaDist"><i class="fa fa-check"></i><b>3.2.2</b> Beta</a></li>
<li class="chapter" data-level="3.2.3" data-path="Distributions.html"><a href="Distributions.html#NormalDist"><i class="fa fa-check"></i><b>3.2.3</b> Normal</a></li>
<li class="chapter" data-level="3.2.4" data-path="Distributions.html"><a href="Distributions.html#LognormalDist"><i class="fa fa-check"></i><b>3.2.4</b> Lognormal</a></li>
<li class="chapter" data-level="3.2.5" data-path="Distributions.html"><a href="Distributions.html#GammaDist"><i class="fa fa-check"></i><b>3.2.5</b> Gamma</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="Distributions.html"><a href="Distributions.html#exercises"><i class="fa fa-check"></i><b>3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Model-fit.html"><a href="Model-fit.html"><i class="fa fa-check"></i><b>4</b> Model Fitting</a>
<ul>
<li class="chapter" data-level="4.1" data-path="Model-fit.html"><a href="Model-fit.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="Model-fit.html"><a href="Model-fit.html#Model-fit-sim"><i class="fa fa-check"></i><b>4.2</b> Using simulation</a></li>
<li class="chapter" data-level="4.3" data-path="Model-fit.html"><a href="Model-fit.html#JAGS-model-fit"><i class="fa fa-check"></i><b>4.3</b> Using Bayesian methods</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="Model-fit.html"><a href="Model-fit.html#FirstExampleBayesian"><i class="fa fa-check"></i><b>4.3.1</b> Example: mark-recapture</a></li>
<li class="chapter" data-level="4.3.2" data-path="Model-fit.html"><a href="Model-fit.html#Debug"><i class="fa fa-check"></i><b>4.3.2</b> Debugging code</a></li>
<li class="chapter" data-level="4.3.3" data-path="Model-fit.html"><a href="Model-fit.html#Convergence"><i class="fa fa-check"></i><b>4.3.3</b> Judging convergence</a></li>
<li class="chapter" data-level="4.3.4" data-path="Model-fit.html"><a href="Model-fit.html#Likelihood"><i class="fa fa-check"></i><b>4.3.4</b> What is a likelihood?</a></li>
<li class="chapter" data-level="4.3.5" data-path="Model-fit.html"><a href="Model-fit.html#Deviance"><i class="fa fa-check"></i><b>4.3.5</b> Deviance as a measure of model fit</a></li>
<li class="chapter" data-level="4.3.6" data-path="Model-fit.html"><a href="Model-fit.html#Model-checking"><i class="fa fa-check"></i><b>4.3.6</b> Model checking</a></li>
<li class="chapter" data-level="4.3.7" data-path="Model-fit.html"><a href="Model-fit.html#Model-selection"><i class="fa fa-check"></i><b>4.3.7</b> Model selection</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="Model-fit.html"><a href="Model-fit.html#exercises-1"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Abundance.html"><a href="Abundance.html"><i class="fa fa-check"></i><b>5</b> Abundance</a>
<ul>
<li class="chapter" data-level="5.1" data-path="Abundance.html"><a href="Abundance.html#Removal"><i class="fa fa-check"></i><b>5.1</b> Removal</a></li>
<li class="chapter" data-level="5.2" data-path="Abundance.html"><a href="Abundance.html#MarkRecap"><i class="fa fa-check"></i><b>5.2</b> Mark-recapture</a></li>
<li class="chapter" data-level="5.3" data-path="Abundance.html"><a href="Abundance.html#NMix"><i class="fa fa-check"></i><b>5.3</b> Binomial-mixture</a></li>
<li class="chapter" data-level="5.4" data-path="Abundance.html"><a href="Abundance.html#exercises-2"><i class="fa fa-check"></i><b>5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Survival.html"><a href="Survival.html"><i class="fa fa-check"></i><b>6</b> Survival</a>
<ul>
<li class="chapter" data-level="6.1" data-path="Survival.html"><a href="Survival.html#AgeComp"><i class="fa fa-check"></i><b>6.1</b> Age-composition</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="Survival.html"><a href="Survival.html#CC_Selectivity"><i class="fa fa-check"></i><b>6.1.1</b> Accounting For Gear Selectivity</a></li>
<li class="chapter" data-level="6.1.2" data-path="Survival.html"><a href="Survival.html#Cohort"><i class="fa fa-check"></i><b>6.1.2</b> Cohort model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="Survival.html"><a href="Survival.html#TelemetryBased"><i class="fa fa-check"></i><b>6.2</b> Telemetry-based</a></li>
<li class="chapter" data-level="6.3" data-path="Survival.html"><a href="Survival.html#BrownieSurvival"><i class="fa fa-check"></i><b>6.3</b> Tag-based</a></li>
<li class="chapter" data-level="6.4" data-path="Survival.html"><a href="Survival.html#exercises-3"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Mortality.html"><a href="Mortality.html"><i class="fa fa-check"></i><b>7</b> Mortality Components</a>
<ul>
<li class="chapter" data-level="7.1" data-path="Mortality.html"><a href="Mortality.html#ExpRate"><i class="fa fa-check"></i><b>7.1</b> Exploitation rate</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="Mortality.html"><a href="Mortality.html#InformativePriors"><i class="fa fa-check"></i><b>7.1.1</b> Informative prior distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="Mortality.html"><a href="Mortality.html#Hearn"><i class="fa fa-check"></i><b>7.2</b> Completed tagging study</a></li>
<li class="chapter" data-level="7.3" data-path="Mortality.html"><a href="Mortality.html#BrownieFandM"><i class="fa fa-check"></i><b>7.3</b> Multi-year tagging study</a></li>
<li class="chapter" data-level="7.4" data-path="Mortality.html"><a href="Mortality.html#TelemetryFandM"><i class="fa fa-check"></i><b>7.4</b> Telemetry-based</a></li>
<li class="chapter" data-level="7.5" data-path="Mortality.html"><a href="Mortality.html#exercises-4"><i class="fa fa-check"></i><b>7.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Growth.html"><a href="Growth.html"><i class="fa fa-check"></i><b>8</b> Growth</a>
<ul>
<li class="chapter" data-level="8.1" data-path="Growth.html"><a href="Growth.html#vonBert"><i class="fa fa-check"></i><b>8.1</b> Growth in length</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="Growth.html"><a href="Growth.html#Otolith"><i class="fa fa-check"></i><b>8.1.1</b> Age-length</a></li>
<li class="chapter" data-level="8.1.2" data-path="Growth.html"><a href="Growth.html#GrowthInc"><i class="fa fa-check"></i><b>8.1.2</b> Using tagging data</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="Growth.html"><a href="Growth.html#LnWgt"><i class="fa fa-check"></i><b>8.2</b> Growth in weight</a></li>
<li class="chapter" data-level="8.3" data-path="Growth.html"><a href="Growth.html#exercises-5"><i class="fa fa-check"></i><b>8.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Recruit.html"><a href="Recruit.html"><i class="fa fa-check"></i><b>9</b> Recruitment</a>
<ul>
<li class="chapter" data-level="9.1" data-path="Recruit.html"><a href="Recruit.html#Recruit-Fit"><i class="fa fa-check"></i><b>9.1</b> Fitting a stock-recruitment curve</a></li>
<li class="chapter" data-level="9.2" data-path="Recruit.html"><a href="Recruit.html#Recruit-DIC"><i class="fa fa-check"></i><b>9.2</b> Does spawning stock size affect recruitment?</a></li>
<li class="chapter" data-level="9.3" data-path="Recruit.html"><a href="Recruit.html#exercises-6"><i class="fa fa-check"></i><b>9.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="PopModels.html"><a href="PopModels.html"><i class="fa fa-check"></i><b>10</b> Integrated Population Models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="PopModels.html"><a href="PopModels.html#TwoAge"><i class="fa fa-check"></i><b>10.1</b> Two-age model</a></li>
<li class="chapter" data-level="10.2" data-path="PopModels.html"><a href="PopModels.html#CAGEAN"><i class="fa fa-check"></i><b>10.2</b> Full age-structured model</a></li>
<li class="chapter" data-level="10.3" data-path="PopModels.html"><a href="PopModels.html#exercises-7"><i class="fa fa-check"></i><b>10.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="FinalThoughts.html"><a href="FinalThoughts.html"><i class="fa fa-check"></i><b>11</b> Final Thoughts</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="real-data-examples.html"><a href="real-data-examples.html"><i class="fa fa-check"></i><b>A</b> Real-data examples</a>
<ul>
<li class="chapter" data-level="A.1" data-path="real-data-examples.html"><a href="real-data-examples.html#RemovalRealData"><i class="fa fa-check"></i><b>A.1</b> Removal</a></li>
<li class="chapter" data-level="A.2" data-path="real-data-examples.html"><a href="real-data-examples.html#MarkRecapRealData"><i class="fa fa-check"></i><b>A.2</b> Mark-recapture</a></li>
<li class="chapter" data-level="A.3" data-path="real-data-examples.html"><a href="real-data-examples.html#AgeCompRealData"><i class="fa fa-check"></i><b>A.3</b> Age-composition</a></li>
<li class="chapter" data-level="A.4" data-path="real-data-examples.html"><a href="real-data-examples.html#BrownieSurvivalRealData"><i class="fa fa-check"></i><b>A.4</b> Tag-based</a></li>
<li class="chapter" data-level="A.5" data-path="real-data-examples.html"><a href="real-data-examples.html#vonBertRealData"><i class="fa fa-check"></i><b>A.5</b> Growth in length</a></li>
<li class="chapter" data-level="A.6" data-path="real-data-examples.html"><a href="real-data-examples.html#Recruit-FitRealData"><i class="fa fa-check"></i><b>A.6</b> Fitting a stock-recruitment curve</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Bayesian Introduction to Fish Population Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Mortality" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Mortality Components<a href="Mortality.html#Mortality" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Reliable estimates of the survival rate (Chapter <a href="Survival.html#Survival">6</a>) are essential in understanding fish population dynamics, but for exploited species, there is generally interest in partitioning mortality (1-survival) into its component rates. Knowing the relative importance of fishing versus natural mortality clarifies the extent to which fishery managers can use regulations to affect population change. The sections that follow illustrate different approaches for examining the impact of fishing and for estimating fishing and natural mortality rates.</p>
<div id="ExpRate" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Exploitation rate<a href="Mortality.html#ExpRate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A tagging study can provide a real-time estimate of the exploitation rate, or the fraction of the population being harvested. Similar to the tag-return method of estimating survival (Section <a href="Survival.html#BrownieSurvival">6.3</a>), the only field work required is the initial tagging effort. Here there is a single release of fish with external tags at the start of the study, and the number of returned tags is recorded over a specified interval. The study duration could be an entire year, or a fishing season for a population managed by seasonal harvest. A high exploitation rate might indicate that harvest regulations such as a size limit or creel limit could be worthwhile. Alternatively a low estimate might indicate that other factors such as natural mortality or recruitment may be more important in regulating population size. With only a single release, we cannot estimate survival (or its complement, mortality) but it is nevertheless an important first step in judging the relative impact of fishing.</p>
<p>There are several practical issues to consider in planning an exploitation rate study. We want to ensure that essentially all tags of harvested fish are reported, so high-reward tags (e.g., $100) could be used <span class="citation">(<a href="#ref-pollock.etal_2001">K. H. Pollock et al. 2001</a>)</span>. Tag loss is another potential source of bias. It can be estimated by double-tagging (giving some or all fish two tags, and recording returns of two versus only one tag), but it greatly complicates the analysis. For this example, we will keep things simple and assume that tag loss is negligible. We also assume that there is no immediate tagging mortality (i.e., due to capture, handling and tagging). This can be challenging to investigate. It is sometimes estimated by holding a sample of fish in a cage after tagging but this can itself be a source of mortality <span class="citation">(<a href="#ref-pollock.pine2007">K. Pollock and Pine 2007</a>)</span>. For now, we assume that there is no short- or long-term mortality associated with tagging. We assume that all caught fish are harvested. If catch-and-release was occurring, our model could be extended to estimate rates of harvest and catch-and-release. The decision of how many fish to tag will depend on the required precision of the study, and as usual can be examined through simulation. Finally, it is important that tagged fish be representative of the entire population. This refers not only to size or age, but also the spatial distribution. Tagging could be done at randomly selected locations, or when the entire study population is concentrated within a single area (e.g., winter holding area or spawning location). The key is for all fish, including the tagged subset, to have the same probability of being harvested.</p>
<p>Our simulation code uses an assumed exploitation rate (u) of 0.4. The value could be based on a literature review or prior work from the study area or similar areas regionally. The number of returned tags has a binomial distribution (Section <a href="Distributions.html#BinomialDist">3.1.2</a>):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="Mortality.html#cb1-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb1-2"><a href="Mortality.html#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="Mortality.html#cb1-3" tabindex="-1"></a><span class="co"># Tagging study to estimate exploitation rate</span></span>
<span id="cb1-4"><a href="Mortality.html#cb1-4" tabindex="-1"></a>u.true <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb1-5"><a href="Mortality.html#cb1-5" tabindex="-1"></a>n.tagged <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1-6"><a href="Mortality.html#cb1-6" tabindex="-1"></a>n.returned <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">prob=</span>u.true, <span class="at">size=</span>n.tagged)</span></code></pre></div>
<p>The simulation provides only a single observation for the number of returned tags. What lines of code could you add to look at the distribution of returned tags (using a new variable for the vector of tag returns)?</p>
<p>The JAGS code is also extremely simple. We have one line of code for the uninformative prior distribution for the exploitation rate, and one for the likelihood.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="Mortality.html#cb2-1" tabindex="-1"></a><span class="co"># Load necessary library packages</span></span>
<span id="cb2-2"><a href="Mortality.html#cb2-2" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb2-3"><a href="Mortality.html#cb2-3" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb2-4"><a href="Mortality.html#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="Mortality.html#cb2-5" tabindex="-1"></a><span class="co"># JAGS code</span></span>
<span id="cb2-6"><a href="Mortality.html#cb2-6" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;ExpRate.txt&quot;</span>)</span>
<span id="cb2-7"><a href="Mortality.html#cb2-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb2-8"><a href="Mortality.html#cb2-8" tabindex="-1"></a><span class="st">model{</span></span>
<span id="cb2-9"><a href="Mortality.html#cb2-9" tabindex="-1"></a><span class="st">    # Priors</span></span>
<span id="cb2-10"><a href="Mortality.html#cb2-10" tabindex="-1"></a><span class="st">    u.est ~ dunif(0,1)  # Exploitation rate</span></span>
<span id="cb2-11"><a href="Mortality.html#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="Mortality.html#cb2-12" tabindex="-1"></a><span class="st">    # Likelihood</span></span>
<span id="cb2-13"><a href="Mortality.html#cb2-13" tabindex="-1"></a><span class="st">    n.returned ~ dbin(u.est, n.tagged)</span></span>
<span id="cb2-14"><a href="Mortality.html#cb2-14" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb2-15"><a href="Mortality.html#cb2-15" tabindex="-1"></a><span class="st">    &quot;</span>,<span class="at">fill=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-16"><a href="Mortality.html#cb2-16" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb2-17"><a href="Mortality.html#cb2-17" tabindex="-1"></a></span>
<span id="cb2-18"><a href="Mortality.html#cb2-18" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb2-19"><a href="Mortality.html#cb2-19" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;n.returned&quot;</span>, <span class="st">&quot;n.tagged&quot;</span>)</span>
<span id="cb2-20"><a href="Mortality.html#cb2-20" tabindex="-1"></a></span>
<span id="cb2-21"><a href="Mortality.html#cb2-21" tabindex="-1"></a><span class="co"># Initial values</span></span>
<span id="cb2-22"><a href="Mortality.html#cb2-22" tabindex="-1"></a>jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){ <span class="fu">list</span>(<span class="at">u.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">1</span>))}</span>
<span id="cb2-23"><a href="Mortality.html#cb2-23" tabindex="-1"></a></span>
<span id="cb2-24"><a href="Mortality.html#cb2-24" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;ExpRate.txt&#39;</span></span>
<span id="cb2-25"><a href="Mortality.html#cb2-25" tabindex="-1"></a></span>
<span id="cb2-26"><a href="Mortality.html#cb2-26" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb2-27"><a href="Mortality.html#cb2-27" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;u.est&quot;</span>)</span>
<span id="cb2-28"><a href="Mortality.html#cb2-28" tabindex="-1"></a></span>
<span id="cb2-29"><a href="Mortality.html#cb2-29" tabindex="-1"></a><span class="co"># Call JAGS from R</span></span>
<span id="cb2-30"><a href="Mortality.html#cb2-30" tabindex="-1"></a>jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb2-31"><a href="Mortality.html#cb2-31" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">4000</span>, <span class="at">n.burnin=</span><span class="dv">2000</span>,</span>
<span id="cb2-32"><a href="Mortality.html#cb2-32" tabindex="-1"></a>                model.file)</span>
<span id="cb2-33"><a href="Mortality.html#cb2-33" tabindex="-1"></a><span class="fu">print</span>(jagsfit)</span>
<span id="cb2-34"><a href="Mortality.html#cb2-34" tabindex="-1"></a><span class="fu">plot</span>(jagsfit)</span></code></pre></div>
<p>A single run with a release of 100 tagged fish provided a credible interval of 0.27-0.46 (from a random return of 36 tags). Experiment with different sample sizes and consider what level of precision would be adequate for management purposes. As always, this is an optimistic scenario, with the number of returned tags perfectly conforming to a binomial distribution.</p>
<div id="InformativePriors" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Informative prior distribution<a href="Mortality.html#InformativePriors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="citation">Banner, Irvine, and Rodhouse (<a href="#ref-banner.etal_2020">2020</a>)</span> discourage the (at least uncritical) use of “default” prior distributions (which are used throughout this book). It is often true that previous studies contain relevant information, and Bayesian methods provide an objective framework for building on that previous information <span class="citation">(<a href="#ref-mccarthy_2007">McCarthy 2007</a>)</span>. The simple example of estimating the exploitation rate is a perfect opportunity to look at how an informative prior would be implemented and to explore its effect on the posterior distribution.</p>
<p>To compare posterior distributions obtained using uninformative and informative priors, we use two copies of the above code. In the uninformative prior version, we simply replace <code>dunif(0,1)</code> with <code>dbeta(1,1)</code> in the JAGS code, and replace the uniform initial value with the corresponding beta (<code>rbeta(n=1, shape1=1, shape2=1)</code>). Neither change affects the calculations because the two distributions are equivalent, but it sets up the model for the informative prior version.</p>
<p>For the informative case, the exploitation rate simulation is unchanged. We simply add two lines of code for the pilot study that will be used for the prior. The informative beta distribution in the JAGS code has two parameters: successes+1 and failures+1 <span class="citation">(<a href="#ref-bolker2008">Bolker 2008</a>)</span>. We augment jags.data with the pilot study data, and use initial values from the informative prior. The JAGS code is followed by R code for producing two plots, showing the prior and posterior distributions for the uninformative (upper plot) and informative (lower) cases. We specify margins for each plot to reduce blank space. The <code>density()</code> function provides a smoothed probability density for the exploitation rate estimates. The <code>lines()</code> function adds the prior distribution to each plot, generated using the <code>dbeta()</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="Mortality.html#cb3-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb3-2"><a href="Mortality.html#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="Mortality.html#cb3-3" tabindex="-1"></a><span class="co"># Tagging study to estimate exploitation rate</span></span>
<span id="cb3-4"><a href="Mortality.html#cb3-4" tabindex="-1"></a>u.true <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb3-5"><a href="Mortality.html#cb3-5" tabindex="-1"></a>n.tagged <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb3-6"><a href="Mortality.html#cb3-6" tabindex="-1"></a>n.returned <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">prob=</span>u.true, <span class="at">size=</span>n.tagged)</span>
<span id="cb3-7"><a href="Mortality.html#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="Mortality.html#cb3-8" tabindex="-1"></a><span class="co"># Load necessary library packages</span></span>
<span id="cb3-9"><a href="Mortality.html#cb3-9" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb3-10"><a href="Mortality.html#cb3-10" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb3-11"><a href="Mortality.html#cb3-11" tabindex="-1"></a></span>
<span id="cb3-12"><a href="Mortality.html#cb3-12" tabindex="-1"></a><span class="co"># JAGS code</span></span>
<span id="cb3-13"><a href="Mortality.html#cb3-13" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;ExpRate.txt&quot;</span>)</span>
<span id="cb3-14"><a href="Mortality.html#cb3-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb3-15"><a href="Mortality.html#cb3-15" tabindex="-1"></a><span class="st">model{</span></span>
<span id="cb3-16"><a href="Mortality.html#cb3-16" tabindex="-1"></a><span class="st">    # Priors</span></span>
<span id="cb3-17"><a href="Mortality.html#cb3-17" tabindex="-1"></a><span class="st">    u.est ~ dbeta(1,1)  # Exploitation rate</span></span>
<span id="cb3-18"><a href="Mortality.html#cb3-18" tabindex="-1"></a></span>
<span id="cb3-19"><a href="Mortality.html#cb3-19" tabindex="-1"></a><span class="st">    # Likelihood</span></span>
<span id="cb3-20"><a href="Mortality.html#cb3-20" tabindex="-1"></a><span class="st">    n.returned ~ dbin(u.est, n.tagged)</span></span>
<span id="cb3-21"><a href="Mortality.html#cb3-21" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb3-22"><a href="Mortality.html#cb3-22" tabindex="-1"></a><span class="st">    &quot;</span>,<span class="at">fill=</span><span class="cn">TRUE</span>)</span>
<span id="cb3-23"><a href="Mortality.html#cb3-23" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb3-24"><a href="Mortality.html#cb3-24" tabindex="-1"></a></span>
<span id="cb3-25"><a href="Mortality.html#cb3-25" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb3-26"><a href="Mortality.html#cb3-26" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;n.returned&quot;</span>, <span class="st">&quot;n.tagged&quot;</span>)</span>
<span id="cb3-27"><a href="Mortality.html#cb3-27" tabindex="-1"></a></span>
<span id="cb3-28"><a href="Mortality.html#cb3-28" tabindex="-1"></a><span class="co"># Initial values</span></span>
<span id="cb3-29"><a href="Mortality.html#cb3-29" tabindex="-1"></a>jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){ <span class="fu">list</span>(<span class="at">u.est=</span><span class="fu">rbeta</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">shape1=</span><span class="dv">1</span>, <span class="at">shape2=</span><span class="dv">1</span>))}</span>
<span id="cb3-30"><a href="Mortality.html#cb3-30" tabindex="-1"></a></span>
<span id="cb3-31"><a href="Mortality.html#cb3-31" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;ExpRate.txt&#39;</span></span>
<span id="cb3-32"><a href="Mortality.html#cb3-32" tabindex="-1"></a></span>
<span id="cb3-33"><a href="Mortality.html#cb3-33" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb3-34"><a href="Mortality.html#cb3-34" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;u.est&quot;</span>)</span>
<span id="cb3-35"><a href="Mortality.html#cb3-35" tabindex="-1"></a></span>
<span id="cb3-36"><a href="Mortality.html#cb3-36" tabindex="-1"></a><span class="co"># Call JAGS from R</span></span>
<span id="cb3-37"><a href="Mortality.html#cb3-37" tabindex="-1"></a>jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb3-38"><a href="Mortality.html#cb3-38" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">4000</span>, <span class="at">n.burnin=</span><span class="dv">2000</span>,</span>
<span id="cb3-39"><a href="Mortality.html#cb3-39" tabindex="-1"></a>                model.file)</span>
<span id="cb3-40"><a href="Mortality.html#cb3-40" tabindex="-1"></a><span class="fu">print</span>(jagsfit)</span>
<span id="cb3-41"><a href="Mortality.html#cb3-41" tabindex="-1"></a><span class="fu">plot</span>(jagsfit)</span>
<span id="cb3-42"><a href="Mortality.html#cb3-42" tabindex="-1"></a></span>
<span id="cb3-43"><a href="Mortality.html#cb3-43" tabindex="-1"></a><span class="co"># Informative prior</span></span>
<span id="cb3-44"><a href="Mortality.html#cb3-44" tabindex="-1"></a>n.pilot <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb3-45"><a href="Mortality.html#cb3-45" tabindex="-1"></a>n.returned.pilot <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">prob=</span>u.true, <span class="at">size=</span>n.pilot)</span>
<span id="cb3-46"><a href="Mortality.html#cb3-46" tabindex="-1"></a></span>
<span id="cb3-47"><a href="Mortality.html#cb3-47" tabindex="-1"></a><span class="co"># Load necessary library packages</span></span>
<span id="cb3-48"><a href="Mortality.html#cb3-48" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb3-49"><a href="Mortality.html#cb3-49" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb3-50"><a href="Mortality.html#cb3-50" tabindex="-1"></a></span>
<span id="cb3-51"><a href="Mortality.html#cb3-51" tabindex="-1"></a><span class="co"># JAGS code</span></span>
<span id="cb3-52"><a href="Mortality.html#cb3-52" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;ExpRate.txt&quot;</span>)</span>
<span id="cb3-53"><a href="Mortality.html#cb3-53" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb3-54"><a href="Mortality.html#cb3-54" tabindex="-1"></a><span class="st">model{</span></span>
<span id="cb3-55"><a href="Mortality.html#cb3-55" tabindex="-1"></a><span class="st">    # Priors</span></span>
<span id="cb3-56"><a href="Mortality.html#cb3-56" tabindex="-1"></a><span class="st">    u.est ~ dbeta((n.returned.pilot+1), </span></span>
<span id="cb3-57"><a href="Mortality.html#cb3-57" tabindex="-1"></a><span class="st">         (n.pilot-n.returned.pilot+1)) # Exploitation rate</span></span>
<span id="cb3-58"><a href="Mortality.html#cb3-58" tabindex="-1"></a></span>
<span id="cb3-59"><a href="Mortality.html#cb3-59" tabindex="-1"></a><span class="st">    # Likelihood</span></span>
<span id="cb3-60"><a href="Mortality.html#cb3-60" tabindex="-1"></a><span class="st">    n.returned ~ dbin(u.est, n.tagged)</span></span>
<span id="cb3-61"><a href="Mortality.html#cb3-61" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb3-62"><a href="Mortality.html#cb3-62" tabindex="-1"></a><span class="st">    &quot;</span>,<span class="at">fill=</span><span class="cn">TRUE</span>)</span>
<span id="cb3-63"><a href="Mortality.html#cb3-63" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb3-64"><a href="Mortality.html#cb3-64" tabindex="-1"></a></span>
<span id="cb3-65"><a href="Mortality.html#cb3-65" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb3-66"><a href="Mortality.html#cb3-66" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;n.returned&quot;</span>, <span class="st">&quot;n.tagged&quot;</span>, <span class="st">&quot;n.pilot&quot;</span>, </span>
<span id="cb3-67"><a href="Mortality.html#cb3-67" tabindex="-1"></a>                  <span class="st">&quot;n.returned.pilot&quot;</span>)</span>
<span id="cb3-68"><a href="Mortality.html#cb3-68" tabindex="-1"></a></span>
<span id="cb3-69"><a href="Mortality.html#cb3-69" tabindex="-1"></a><span class="co"># Initial values</span></span>
<span id="cb3-70"><a href="Mortality.html#cb3-70" tabindex="-1"></a>jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){ <span class="fu">list</span>(<span class="at">u.est=</span><span class="fu">rbeta</span>(<span class="at">n=</span><span class="dv">1</span>, </span>
<span id="cb3-71"><a href="Mortality.html#cb3-71" tabindex="-1"></a>                          <span class="at">shape1=</span>(n.returned.pilot<span class="sc">+</span><span class="dv">1</span>), </span>
<span id="cb3-72"><a href="Mortality.html#cb3-72" tabindex="-1"></a>                          <span class="at">shape2=</span>(n.pilot<span class="sc">-</span>n.returned.pilot<span class="sc">+</span><span class="dv">1</span>)))}</span>
<span id="cb3-73"><a href="Mortality.html#cb3-73" tabindex="-1"></a></span>
<span id="cb3-74"><a href="Mortality.html#cb3-74" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;ExpRate.txt&#39;</span></span>
<span id="cb3-75"><a href="Mortality.html#cb3-75" tabindex="-1"></a></span>
<span id="cb3-76"><a href="Mortality.html#cb3-76" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb3-77"><a href="Mortality.html#cb3-77" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;u.est&quot;</span>)</span>
<span id="cb3-78"><a href="Mortality.html#cb3-78" tabindex="-1"></a></span>
<span id="cb3-79"><a href="Mortality.html#cb3-79" tabindex="-1"></a><span class="co"># Call JAGS from R</span></span>
<span id="cb3-80"><a href="Mortality.html#cb3-80" tabindex="-1"></a>informative <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb3-81"><a href="Mortality.html#cb3-81" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">4000</span>, <span class="at">n.burnin=</span><span class="dv">2000</span>,</span>
<span id="cb3-82"><a href="Mortality.html#cb3-82" tabindex="-1"></a>                model.file)</span>
<span id="cb3-83"><a href="Mortality.html#cb3-83" tabindex="-1"></a><span class="fu">print</span>(informative)</span>
<span id="cb3-84"><a href="Mortality.html#cb3-84" tabindex="-1"></a><span class="fu">plot</span>(informative)</span>
<span id="cb3-85"><a href="Mortality.html#cb3-85" tabindex="-1"></a></span>
<span id="cb3-86"><a href="Mortality.html#cb3-86" tabindex="-1"></a><span class="co"># Vague prior and posterior</span></span>
<span id="cb3-87"><a href="Mortality.html#cb3-87" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb3-88"><a href="Mortality.html#cb3-88" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>)) <span class="co"># bottom, left, right, top margins</span></span>
<span id="cb3-89"><a href="Mortality.html#cb3-89" tabindex="-1"></a>dens1 <span class="ot">&lt;-</span> <span class="fu">density</span>(jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.list<span class="sc">$</span>u.est)</span>
<span id="cb3-90"><a href="Mortality.html#cb3-90" tabindex="-1"></a>dens2 <span class="ot">&lt;-</span> <span class="fu">density</span>(informative<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.list<span class="sc">$</span>u.est)</span>
<span id="cb3-91"><a href="Mortality.html#cb3-91" tabindex="-1"></a>y.bounds <span class="ot">&lt;-</span> <span class="fu">range</span>(dens1<span class="sc">$</span>y, dens2<span class="sc">$</span>y)</span>
<span id="cb3-92"><a href="Mortality.html#cb3-92" tabindex="-1"></a>x.bounds <span class="ot">&lt;-</span> <span class="fu">range</span>(jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.list<span class="sc">$</span>u.est, </span>
<span id="cb3-93"><a href="Mortality.html#cb3-93" tabindex="-1"></a>              informative<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.list<span class="sc">$</span>u.est)</span>
<span id="cb3-94"><a href="Mortality.html#cb3-94" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.list<span class="sc">$</span>u.est), <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>, </span>
<span id="cb3-95"><a href="Mortality.html#cb3-95" tabindex="-1"></a>     <span class="at">xlim=</span>x.bounds, <span class="at">ylim=</span>y.bounds)</span>
<span id="cb3-96"><a href="Mortality.html#cb3-96" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>u.true,  <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb3-97"><a href="Mortality.html#cb3-97" tabindex="-1"></a>x.vec <span class="ot">&lt;-</span> <span class="fu">seq</span>(x.bounds[<span class="dv">1</span>], x.bounds[<span class="dv">2</span>], <span class="at">length.out=</span><span class="dv">101</span>)</span>
<span id="cb3-98"><a href="Mortality.html#cb3-98" tabindex="-1"></a><span class="fu">lines</span>(x.vec,</span>
<span id="cb3-99"><a href="Mortality.html#cb3-99" tabindex="-1"></a>      <span class="fu">dbeta</span>(<span class="fu">seq</span>(x.bounds[<span class="dv">1</span>], x.bounds[<span class="dv">2</span>], <span class="at">length.out=</span><span class="dv">101</span>), <span class="at">shape1=</span><span class="dv">1</span>, </span>
<span id="cb3-100"><a href="Mortality.html#cb3-100" tabindex="-1"></a>            <span class="at">shape2=</span><span class="dv">1</span>), <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb3-101"><a href="Mortality.html#cb3-101" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">&quot;topleft&quot;</span>, <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">text.font =</span> <span class="dv">1</span>,  </span>
<span id="cb3-102"><a href="Mortality.html#cb3-102" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Prior&quot;</span>, <span class="st">&quot;Posterior&quot;</span>)) </span>
<span id="cb3-103"><a href="Mortality.html#cb3-103" tabindex="-1"></a></span>
<span id="cb3-104"><a href="Mortality.html#cb3-104" tabindex="-1"></a><span class="co"># Informative prior and posterior</span></span>
<span id="cb3-105"><a href="Mortality.html#cb3-105" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb3-106"><a href="Mortality.html#cb3-106" tabindex="-1"></a><span class="fu">plot</span>(dens2,<span class="at">xlab=</span><span class="st">&quot;Estimated exploitation rate&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>, </span>
<span id="cb3-107"><a href="Mortality.html#cb3-107" tabindex="-1"></a>     <span class="at">xlim=</span>x.bounds, <span class="at">ylim=</span>y.bounds)</span>
<span id="cb3-108"><a href="Mortality.html#cb3-108" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>u.true,  <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb3-109"><a href="Mortality.html#cb3-109" tabindex="-1"></a><span class="fu">lines</span>(x.vec, <span class="fu">dbeta</span>(<span class="fu">seq</span>(x.bounds[<span class="dv">1</span>], x.bounds[<span class="dv">2</span>], </span>
<span id="cb3-110"><a href="Mortality.html#cb3-110" tabindex="-1"></a>                    <span class="at">length.out=</span><span class="dv">101</span>), <span class="at">shape1=</span>(n.returned.pilot<span class="sc">+</span><span class="dv">1</span>), </span>
<span id="cb3-111"><a href="Mortality.html#cb3-111" tabindex="-1"></a>                    <span class="at">shape2=</span>(n.pilot<span class="sc">-</span>n.returned.pilot<span class="sc">+</span><span class="dv">1</span>)), <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p>A pilot study provides a valuable opportunity to work out field logistics, as well as allowing for construction of an informative prior. Informative priors can also be based on the mean and variance of published estimates, and can include the additional variation within individual studies <span class="citation">(<a href="#ref-mccarthy.masters_2005">McCarthy and Masters 2005</a>; <a href="#ref-regehr.etal_2018">Regehr et al. 2018</a>)</span>. Another approach is to base the prior on ecological theory, for example, a prior for survival rate based on its relationship to body mass [<span class="citation">(<a href="#ref-mccarthy.masters_2005">McCarthy and Masters 2005</a>)</span>. For our tagging example, the beta distribution worked well as an informative prior because the two parameters are based on the number of successes (returned tag) and failures (not returned). The plotted distributions suggest a modest gain in precision from a pilot release of 20 tagged fish, given a full study release of 100 (Figure <a href="Mortality.html#fig:InfPriorPlot">7.1</a>). The effect of an informative prior can also be evaluated by comparing the width of credible intervals <span class="citation">(<a href="#ref-mccarthy.masters_2005">McCarthy and Masters 2005</a>)</span>.</p>
<p>The benefit of an informative prior depends on the information content of the prior versus the new data <span class="citation">(<a href="#ref-mccarthy.masters_2005">McCarthy and Masters 2005</a>)</span>. <span class="citation">Lemoine (<a href="#ref-lemoine_2019">2019</a>)</span> recommends carrying out analyses of real data using multiple prior distributions of varying strength, to better understand the information content of the new data and the effect of priors. One other point to consider if conducting a pilot tagging study, rather than using published information, is the random aspect of the number returned. Try multiple runs with small pilot releases to see how often the prior is unhelpful for estimating the true exploitation rate. What factors would you consider when deciding whether to base an informative prior on a pilot study versus a summary of published estimates?</p>
<div class="figure"><span style="display:block;" id="fig:InfPriorPlot"></span>
<img src="bookdown_files/figure-html/InfPriorPlot-1.png" alt="Prior and posterior distributions for estimated exploitation rate, using uninformative (upper) and informative (lower) priors. The full study sample size is 100 tagged fish; the pilot study (lower panel) has a sample size of 20. The true exploitation rate is shown as a dotted vertical line." width="90%" />
<p class="caption">
FIGURE 7.1: Prior and posterior distributions for estimated exploitation rate, using uninformative (upper) and informative (lower) priors. The full study sample size is 100 tagged fish; the pilot study (lower panel) has a sample size of 20. The true exploitation rate is shown as a dotted vertical line.
</p>
</div>
</div>
</div>
<div id="Hearn" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Completed tagging study<a href="Mortality.html#Hearn" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A single release of tags (Section <a href="Mortality.html#ExpRate">7.1</a>) can also be used to estimate the rate of natural mortality. <span class="citation">Hearn, Sandland, and Hampton (<a href="#ref-hearn.etal1987">1987</a>)</span> provide a method that can be used in completed tagging studies, that is, a study of sufficient duration that tag returns have ceased (assumed to indicate that no live tagged fish remain). Their model uses instantaneous rates, which we have to this point avoided. The relationship between probabilities (survival, death, exploitation, natural death) and instantaneous rates is as follows. The instantaneous rate of population decline is <span class="math inline">\(dN/dt = -Zt\)</span>, where N is population size and Z is the instantaneous total mortality rate (rate of decline due to fishing and natural sources). An advantage of instantaneous rates is that they are additive. Stock assessment models routinely partition Z into whatever categories are useful and estimable; for example, fishing versus natural mortality, commmercial versus recreational fishing, longline versus trawl, etc. The most common partitioning is for fishing (F) versus natural (M) sources: <span class="math inline">\(dN/dt = -(M+F)t\)</span>. Integrating this equation provides us with an expression for population size at any time t:</p>
<p><span class="math inline">\(N_t = N_0 * exp(-(M+F)*t)\)</span></p>
<p>where N<sub>0</sub> is initial abundance and <span class="math inline">\(S=exp(-(M+F)*t)\)</span> is the survival rate. The total mortality rate (probability of dying from all causes) is A=1-S. The exploitation rate is obtained as u=FA/Z, which makes sense as the fraction of total mortality due to fishing (F/Z). Similarly the probability of natural death is v=MA/Z. These expressions make it possible to go back and forth between probabilities and instantaneous rates, depending on which is more useful or traditional for a particular model. These expressions apply for the most common situation where fishing and natural mortality occur simultaneously (referred to by <span class="citation">Ricker (<a href="#ref-ricker1975">1975</a>)</span> as a Type 2 fishery). <span class="citation">Ricker (<a href="#ref-ricker1975">1975</a>)</span> provides alternate expressions for the less common case (a Type 1 fishery) where natural mortality occurs after a short fishing season.</p>
<p>Unlike the probabilities for survival, harvest, etc., instantaneous rates are unbounded. In a Bayesian context, this makes them more challenging to estimate compared to probabilities, which are conveniently bounded by 0 and 1. Instantaneous rates are also less intuitive in terms of their magnitude compared to probabilities. There is typically more uncertainty about M than F because natural deaths are almost never observed <span class="citation">(<a href="#ref-hearn.etal1987">Hearn, Sandland, and Hampton 1987</a>; <a href="#ref-quinn.deriso_1999">Quinn and Deriso 1999</a>)</span>. The joke about M is that it is often assumed to be 0.2, because .2 looks like a distorted version of a question mark. In a review of published natural mortality estimates, <span class="citation">Vetter (<a href="#ref-vetter_1988">1988</a>)</span> found that a majority were less than 0.5 but values exceeding 2.0 were occasionally reported.</p>
<p>The <span class="citation">Hearn, Sandland, and Hampton (<a href="#ref-hearn.etal1987">1987</a>)</span> method requires only that fishing mortality in each period be greater than zero, in order to establish the study’s endpoint. Their model assumes a constant rate of natural mortality, so the estimated rate would in practice represent the average over the study. Their base model assumes that tags of harvested fish are always reported, there is no mortality associated with tagging, and there is no tag loss.</p>
<p>The <span class="citation">Hearn, Sandland, and Hampton (<a href="#ref-hearn.etal1987">1987</a>)</span> model used exact times at large for returned tags to estimate the natural mortality rate. The following Bayesian version is a modification of their method, using tag returns by period (assumed here to be annual) to establish the length of the completed study. Simulated fishing mortality rates are greater than 0 but vary randomly within a user-defined range. We begin with simulation code:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="Mortality.html#cb4-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb4-2"><a href="Mortality.html#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="Mortality.html#cb4-3" tabindex="-1"></a>n.tagged <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb4-4"><a href="Mortality.html#cb4-4" tabindex="-1"></a>Periods <span class="ot">&lt;-</span> <span class="dv">40</span> </span>
<span id="cb4-5"><a href="Mortality.html#cb4-5" tabindex="-1"></a><span class="co"># Set to high value to ensure that end of study is observed</span></span>
<span id="cb4-6"><a href="Mortality.html#cb4-6" tabindex="-1"></a>F.true <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n=</span>(Periods<span class="dv">-1</span>), <span class="at">min=</span><span class="fl">0.3</span>, <span class="at">max=</span><span class="fl">0.5</span>)</span>
<span id="cb4-7"><a href="Mortality.html#cb4-7" tabindex="-1"></a>M.true <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb4-8"><a href="Mortality.html#cb4-8" tabindex="-1"></a>S.true <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>F.true <span class="sc">-</span> M.true)</span>
<span id="cb4-9"><a href="Mortality.html#cb4-9" tabindex="-1"></a>u.true <span class="ot">&lt;-</span> F.true <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>S.true) <span class="sc">/</span> (F.true <span class="sc">+</span> M.true)</span>
<span id="cb4-10"><a href="Mortality.html#cb4-10" tabindex="-1"></a></span>
<span id="cb4-11"><a href="Mortality.html#cb4-11" tabindex="-1"></a>TagsAtRisk <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span>Periods)</span>
<span id="cb4-12"><a href="Mortality.html#cb4-12" tabindex="-1"></a>TagsAtRisk[<span class="dv">1</span>] <span class="ot">&lt;-</span> n.tagged</span>
<span id="cb4-13"><a href="Mortality.html#cb4-13" tabindex="-1"></a>TagFates <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span>(Periods<span class="dv">-1</span>)) <span class="co"># Returns by period</span></span>
<span id="cb4-14"><a href="Mortality.html#cb4-14" tabindex="-1"></a></span>
<span id="cb4-15"><a href="Mortality.html#cb4-15" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>Periods){</span>
<span id="cb4-16"><a href="Mortality.html#cb4-16" tabindex="-1"></a>  TagsAtRisk[j] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">size=</span>TagsAtRisk[j<span class="dv">-1</span>], <span class="at">prob=</span>S.true[j<span class="dv">-1</span>])</span>
<span id="cb4-17"><a href="Mortality.html#cb4-17" tabindex="-1"></a>  TagFates[j<span class="dv">-1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">size=</span>(TagsAtRisk[j<span class="dv">-1</span>]</span>
<span id="cb4-18"><a href="Mortality.html#cb4-18" tabindex="-1"></a>                     <span class="sc">-</span>TagsAtRisk[j]),<span class="at">prob=</span>(F.true[j<span class="dv">-1</span>]</span>
<span id="cb4-19"><a href="Mortality.html#cb4-19" tabindex="-1"></a>                      <span class="sc">/</span>(F.true[j<span class="dv">-1</span>]<span class="sc">+</span>M.true))) </span>
<span id="cb4-20"><a href="Mortality.html#cb4-20" tabindex="-1"></a>  <span class="co"># Random realization: fishing deaths</span></span>
<span id="cb4-21"><a href="Mortality.html#cb4-21" tabindex="-1"></a>} <span class="co">#j</span></span>
<span id="cb4-22"><a href="Mortality.html#cb4-22" tabindex="-1"></a></span>
<span id="cb4-23"><a href="Mortality.html#cb4-23" tabindex="-1"></a>t.Completed <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">which</span>(TagFates[]<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb4-24"><a href="Mortality.html#cb4-24" tabindex="-1"></a><span class="co"># Locate period when study completed (last return)</span></span>
<span id="cb4-25"><a href="Mortality.html#cb4-25" tabindex="-1"></a>NatDeaths <span class="ot">&lt;-</span> n.tagged <span class="sc">-</span> <span class="fu">sum</span>(TagFates)</span>
<span id="cb4-26"><a href="Mortality.html#cb4-26" tabindex="-1"></a>TagFates <span class="ot">&lt;-</span> <span class="fu">c</span>(TagFates[<span class="dv">1</span><span class="sc">:</span>t.Completed],NatDeaths) </span>
<span id="cb4-27"><a href="Mortality.html#cb4-27" tabindex="-1"></a><span class="co"># Returns + all natural deaths</span></span></code></pre></div>
<p>The vectors for tags-at-risk and fates are binomially-distributed random realizations. Tags at risk are obtained using the number at risk in the previous period and the survival rate. Tag returns (stored in tag fates vector) are obtained from the number of deaths between periods and the fraction of deaths due to fishing (F/Z). The <code>which()</code> function provides a vector of periods when tag returns are greater than 0, and the <code>max()</code> function chooses the final period with at least one tag return. Try <code>which(TagFates[]&gt;0)</code> in the Console to make clear how this expression works. The final version of the tag fates vector contains tag returns for the completed study length plus a final value for natural deaths (any tagged fish not seen in the completed tagging study).</p>
<p>The JAGS code for fitting the model is similar to that for the tag-based method of estimating survival (Section <a href="Survival.html#BrownieSurvival">6.3</a>), except that our parameters now are instantaneous rates. We use an arbitrary uniform prior distribution, with an upper bound (2) set high enough to ensure that the interval contains the true value. The likelihood uses a multinomial distribution (Section <a href="Distributions.html#Multinomial">3.1.3</a>), where cell probabilities represent the fraction returned in each period plus a final value for the fraction not seen again (natural deaths in our completed tagging study). The last three lines of code show the estimated posterior distribution compared to the true value.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="Mortality.html#cb5-1" tabindex="-1"></a><span class="co"># Load necessary library packages</span></span>
<span id="cb5-2"><a href="Mortality.html#cb5-2" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb5-3"><a href="Mortality.html#cb5-3" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb5-4"><a href="Mortality.html#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="Mortality.html#cb5-5" tabindex="-1"></a><span class="co"># JAGS code</span></span>
<span id="cb5-6"><a href="Mortality.html#cb5-6" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;Hearn.txt&quot;</span>)</span>
<span id="cb5-7"><a href="Mortality.html#cb5-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb5-8"><a href="Mortality.html#cb5-8" tabindex="-1"></a><span class="st">  model {</span></span>
<span id="cb5-9"><a href="Mortality.html#cb5-9" tabindex="-1"></a><span class="st">  # Priors</span></span>
<span id="cb5-10"><a href="Mortality.html#cb5-10" tabindex="-1"></a><span class="st">  M.est ~ dunif(0, 2)  # Instantaneous natural mortality rate</span></span>
<span id="cb5-11"><a href="Mortality.html#cb5-11" tabindex="-1"></a><span class="st">  for (i in 1:t.Completed) {</span></span>
<span id="cb5-12"><a href="Mortality.html#cb5-12" tabindex="-1"></a><span class="st">     F.est[i] ~ dunif(0,2) # Instantaneous fishing mortality rate</span></span>
<span id="cb5-13"><a href="Mortality.html#cb5-13" tabindex="-1"></a><span class="st">     S.est[i] &lt;- exp(-M.est - F.est[i])</span></span>
<span id="cb5-14"><a href="Mortality.html#cb5-14" tabindex="-1"></a><span class="st">     u.est[i] &lt;- F.est[i] * (1-S.est[i])/(F.est[i]+M.est) # FA/Z</span></span>
<span id="cb5-15"><a href="Mortality.html#cb5-15" tabindex="-1"></a><span class="st">  } #i</span></span>
<span id="cb5-16"><a href="Mortality.html#cb5-16" tabindex="-1"></a></span>
<span id="cb5-17"><a href="Mortality.html#cb5-17" tabindex="-1"></a><span class="st"># Cell probabilities</span></span>
<span id="cb5-18"><a href="Mortality.html#cb5-18" tabindex="-1"></a><span class="st">  p.est[1] &lt;- u.est[1]</span></span>
<span id="cb5-19"><a href="Mortality.html#cb5-19" tabindex="-1"></a><span class="st">  for (i in 2:t.Completed) {</span></span>
<span id="cb5-20"><a href="Mortality.html#cb5-20" tabindex="-1"></a><span class="st">    p.est[i] &lt;- prod(S.est[1:(i-1)])*u.est[i]</span></span>
<span id="cb5-21"><a href="Mortality.html#cb5-21" tabindex="-1"></a><span class="st">      } #i</span></span>
<span id="cb5-22"><a href="Mortality.html#cb5-22" tabindex="-1"></a><span class="st">    p.est[t.Completed+1] &lt;- 1 - sum(p.est[1:t.Completed])</span></span>
<span id="cb5-23"><a href="Mortality.html#cb5-23" tabindex="-1"></a><span class="st">      # Prob of not being seen again</span></span>
<span id="cb5-24"><a href="Mortality.html#cb5-24" tabindex="-1"></a><span class="st">  TagFates[1:(t.Completed+1)] ~ dmulti(p.est[1:(t.Completed+1)],</span></span>
<span id="cb5-25"><a href="Mortality.html#cb5-25" tabindex="-1"></a><span class="st">                                n.tagged)</span></span>
<span id="cb5-26"><a href="Mortality.html#cb5-26" tabindex="-1"></a><span class="st"> }</span></span>
<span id="cb5-27"><a href="Mortality.html#cb5-27" tabindex="-1"></a><span class="st">  &quot;</span>,<span class="at">fill=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-28"><a href="Mortality.html#cb5-28" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb5-29"><a href="Mortality.html#cb5-29" tabindex="-1"></a></span>
<span id="cb5-30"><a href="Mortality.html#cb5-30" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb5-31"><a href="Mortality.html#cb5-31" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;TagFates&quot;</span>, <span class="st">&quot;t.Completed&quot;</span>, <span class="st">&quot;n.tagged&quot;</span>)</span>
<span id="cb5-32"><a href="Mortality.html#cb5-32" tabindex="-1"></a></span>
<span id="cb5-33"><a href="Mortality.html#cb5-33" tabindex="-1"></a><span class="co"># Initial values</span></span>
<span id="cb5-34"><a href="Mortality.html#cb5-34" tabindex="-1"></a>jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){<span class="fu">list</span>(<span class="at">M.est=</span><span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>), </span>
<span id="cb5-35"><a href="Mortality.html#cb5-35" tabindex="-1"></a>                              <span class="at">F.est=</span><span class="fu">runif</span>(t.Completed, <span class="dv">0</span>, <span class="dv">2</span>))}</span>
<span id="cb5-36"><a href="Mortality.html#cb5-36" tabindex="-1"></a></span>
<span id="cb5-37"><a href="Mortality.html#cb5-37" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;Hearn.txt&#39;</span></span>
<span id="cb5-38"><a href="Mortality.html#cb5-38" tabindex="-1"></a></span>
<span id="cb5-39"><a href="Mortality.html#cb5-39" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb5-40"><a href="Mortality.html#cb5-40" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;M.est&quot;</span>, <span class="st">&quot;F.est&quot;</span>)</span>
<span id="cb5-41"><a href="Mortality.html#cb5-41" tabindex="-1"></a></span>
<span id="cb5-42"><a href="Mortality.html#cb5-42" tabindex="-1"></a><span class="co"># Call JAGS from R</span></span>
<span id="cb5-43"><a href="Mortality.html#cb5-43" tabindex="-1"></a>jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb5-44"><a href="Mortality.html#cb5-44" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.iter =</span> <span class="dv">4000</span>, <span class="at">n.burnin=</span><span class="dv">2000</span>,</span>
<span id="cb5-45"><a href="Mortality.html#cb5-45" tabindex="-1"></a>                model.file)</span>
<span id="cb5-46"><a href="Mortality.html#cb5-46" tabindex="-1"></a><span class="fu">print</span>(jagsfit)</span>
<span id="cb5-47"><a href="Mortality.html#cb5-47" tabindex="-1"></a><span class="fu">plot</span>(jagsfit)</span>
<span id="cb5-48"><a href="Mortality.html#cb5-48" tabindex="-1"></a></span>
<span id="cb5-49"><a href="Mortality.html#cb5-49" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co"># Default plot settings</span></span>
<span id="cb5-50"><a href="Mortality.html#cb5-50" tabindex="-1"></a>mar <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>)</span>
<span id="cb5-51"><a href="Mortality.html#cb5-51" tabindex="-1"></a><span class="co"># Look at posterior distribution versus true value</span></span>
<span id="cb5-52"><a href="Mortality.html#cb5-52" tabindex="-1"></a><span class="fu">hist</span>(jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.list<span class="sc">$</span>M.est, </span>
<span id="cb5-53"><a href="Mortality.html#cb5-53" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Estimated natural mortality rate&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb5-54"><a href="Mortality.html#cb5-54" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>M.true,  <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span></code></pre></div>
<p>This approach works because there are only two fates for tagged fish: caught and reported or natural death. Using a completed tagging study means that (when all assumptions hold) the number of natural deaths is known exactly (number of tag releases - total returns). The model adjusts the estimate of M in order to account for all the natural deaths by the end of the completed study. The length of the completed tagging study depends on the assumed values for F and M. The estimated natural mortality rate will be higher when the study length is short and when many tagged fish are not seen again.</p>
<p>There are elements of randomness in the length of the completed tagging study. One example is when tagged fish at risk survive for one or more periods beyond the last tag return but are ultimately natural deaths. This can occasionally be seen by comparing the TagsAtRisk and TagFates vectors. There can also be embedded zeros in the vector of tag returns when the number of tags at risk is low. Simulation runs suggest that this approach to determining study length works reasonably well but should be evaluated for the likely range of fishing and natural mortality rates.</p>
<p>For the default settings, estimates of M tend to be reliable (Figure <a href="Mortality.html#fig:HearnPlot">7.2</a>), which is unsurprising given that it is modeled as a constant rate and estimated from multiple years of data. Run the full code (simulation and analysis) multiple times, using different assumed values for the natural mortality rate, to build intuition about the reliability of this method. (Periods here are assumed to be years, but a larger number of periods might be needed for monthly intervals or if a very low natural mortality rate is used.) How would uncertainty change with a different number of tags released?</p>
<div class="figure"><span style="display:block;" id="fig:HearnPlot"></span>
<img src="bookdown_files/figure-html/HearnPlot-1.png" alt="Example of estimated posterior distribution and true natural mortality rate (dotted vertical line) using the completed tagging study (Hearn et al. 1987) approach." width="90%" />
<p class="caption">
FIGURE 7.2: Example of estimated posterior distribution and true natural mortality rate (dotted vertical line) using the completed tagging study (Hearn et al. 1987) approach.
</p>
</div>
<p>Estimated fishing mortality rates for the first few periods are moderately accurate, especially for larger tag releases. Estimates near the end of the completed study are typically high with wide credible intervals. There would likely be some improvement from simplifying the model to estimate only an average annual fishing mortality rate rather than period-specific estimates.</p>
</div>
<div id="BrownieFandM" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Multi-year tagging study<a href="Mortality.html#BrownieFandM" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We return to the multi-year tagging study (Section <a href="Survival.html#BrownieSurvival">6.3</a>) but now assume that we have information about the tag-reporting rate. This information allows us to partition mortality into fishing and natural sources. Tag-reporting rate is fixed at 1.0 in the following code, as might be appropriate when using high-reward tags. In a later section of code, we estimate it internally, using planted tags <span class="citation">(<a href="#ref-hearn.etal_2003">Hearn et al. 2003</a>)</span> and an additional likelihood component. Information about the tag-reporting rate is very powerful. For example, a 100% tag-reporting rate means that (assuming no assumptions are violated) you ultimately know the number of natural deaths because all other tags will be reported (as in Section <a href="Mortality.html#Hearn">7.2</a>). There is uncertainty in the short term because tags not returned could belong to fish still alive and at risk, so information about natural deaths is clear only after sufficient time has passed.</p>
<p>Our simulation code is similar to that of Section <a href="Survival.html#BrownieSurvival">6.3</a> except that we now specify the probabilities of harvest (u.true) and natural death (v.true). We use vectors so that the rates can vary by period. We have arbitrarily set the probabilities for harvest higher than for natural death, to investigate whether we can reliably detect the predominant threat in our simulated study design.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="Mortality.html#cb6-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb6-2"><a href="Mortality.html#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="Mortality.html#cb6-3" tabindex="-1"></a><span class="co"># Parameter values for three-yr experiment</span></span>
<span id="cb6-4"><a href="Mortality.html#cb6-4" tabindex="-1"></a>Periods <span class="ot">&lt;-</span> <span class="dv">3</span>  <span class="co"># Equal number of release and return periods assumed</span></span>
<span id="cb6-5"><a href="Mortality.html#cb6-5" tabindex="-1"></a>NTags <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># Number released each period</span></span>
<span id="cb6-6"><a href="Mortality.html#cb6-6" tabindex="-1"></a>NumTagged <span class="ot">&lt;-</span> <span class="fu">rep</span>(NTags, Periods) <span class="co"># Release NTags fish each period</span></span>
<span id="cb6-7"><a href="Mortality.html#cb6-7" tabindex="-1"></a></span>
<span id="cb6-8"><a href="Mortality.html#cb6-8" tabindex="-1"></a>u.true <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.25</span>, <span class="fl">0.3</span>) <span class="co"># Probability of fishing death</span></span>
<span id="cb6-9"><a href="Mortality.html#cb6-9" tabindex="-1"></a>v.true <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.2</span>) <span class="co"># Probability of natural death</span></span>
<span id="cb6-10"><a href="Mortality.html#cb6-10" tabindex="-1"></a>lam.true <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># Reporting rate</span></span>
<span id="cb6-11"><a href="Mortality.html#cb6-11" tabindex="-1"></a></span>
<span id="cb6-12"><a href="Mortality.html#cb6-12" tabindex="-1"></a><span class="co"># Calculated value(s), array creation</span></span>
<span id="cb6-13"><a href="Mortality.html#cb6-13" tabindex="-1"></a>S.true <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> u.true <span class="sc">-</span> v.true</span>
<span id="cb6-14"><a href="Mortality.html#cb6-14" tabindex="-1"></a>TagsAtRisk <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(Periods, Periods))</span>
<span id="cb6-15"><a href="Mortality.html#cb6-15" tabindex="-1"></a>TagFate <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(Periods, Periods<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb6-16"><a href="Mortality.html#cb6-16" tabindex="-1"></a>  <span class="co"># Extra column for tags not seen again</span></span>
<span id="cb6-17"><a href="Mortality.html#cb6-17" tabindex="-1"></a></span>
<span id="cb6-18"><a href="Mortality.html#cb6-18" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>Periods){ </span>
<span id="cb6-19"><a href="Mortality.html#cb6-19" tabindex="-1"></a><span class="co"># Expected values for tags-at-risk, returned/not-seen-again</span></span>
<span id="cb6-20"><a href="Mortality.html#cb6-20" tabindex="-1"></a>  TagsAtRisk[i,i] <span class="ot">&lt;-</span> NumTagged[i]</span>
<span id="cb6-21"><a href="Mortality.html#cb6-21" tabindex="-1"></a>  TagFate[i,i] <span class="ot">&lt;-</span>  TagsAtRisk[i,i] <span class="sc">*</span> lam.true <span class="sc">*</span> u.true[i] </span>
<span id="cb6-22"><a href="Mortality.html#cb6-22" tabindex="-1"></a>   <span class="co"># Returns in release period</span></span>
<span id="cb6-23"><a href="Mortality.html#cb6-23" tabindex="-1"></a>  j <span class="ot">&lt;-</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb6-24"><a href="Mortality.html#cb6-24" tabindex="-1"></a>  <span class="cf">while</span>(j <span class="sc">&lt;=</span> Periods) {</span>
<span id="cb6-25"><a href="Mortality.html#cb6-25" tabindex="-1"></a>    TagsAtRisk[i,j] <span class="ot">&lt;-</span> TagsAtRisk[i,(j<span class="dv">-1</span>)]<span class="sc">*</span>S.true[j<span class="dv">-1</span>]</span>
<span id="cb6-26"><a href="Mortality.html#cb6-26" tabindex="-1"></a>    TagFate[i,j] <span class="ot">&lt;-</span> TagsAtRisk[i,j] <span class="sc">*</span> lam.true <span class="sc">*</span> u.true[j]</span>
<span id="cb6-27"><a href="Mortality.html#cb6-27" tabindex="-1"></a>    j <span class="ot">&lt;-</span> j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb6-28"><a href="Mortality.html#cb6-28" tabindex="-1"></a>   } <span class="co">#while</span></span>
<span id="cb6-29"><a href="Mortality.html#cb6-29" tabindex="-1"></a>  TagFate[i, Periods<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> NTags<span class="sc">-</span><span class="fu">sum</span>(TagFate[i,i<span class="sc">:</span>Periods]) </span>
<span id="cb6-30"><a href="Mortality.html#cb6-30" tabindex="-1"></a>    <span class="co"># Tags not seen again</span></span>
<span id="cb6-31"><a href="Mortality.html#cb6-31" tabindex="-1"></a>  } <span class="co">#i</span></span>
<span id="cb6-32"><a href="Mortality.html#cb6-32" tabindex="-1"></a></span>
<span id="cb6-33"><a href="Mortality.html#cb6-33" tabindex="-1"></a>RandRet <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(Periods, Periods<span class="sc">+</span><span class="dv">1</span>))  </span>
<span id="cb6-34"><a href="Mortality.html#cb6-34" tabindex="-1"></a>  <span class="co"># Extra column for fish not seen again</span></span>
<span id="cb6-35"><a href="Mortality.html#cb6-35" tabindex="-1"></a><span class="co">#Random trial</span></span>
<span id="cb6-36"><a href="Mortality.html#cb6-36" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>Periods) <span class="co"># Upper diagonal matrix of random tag returns</span></span>
<span id="cb6-37"><a href="Mortality.html#cb6-37" tabindex="-1"></a>  {</span>
<span id="cb6-38"><a href="Mortality.html#cb6-38" tabindex="-1"></a>    RandRet[i,i<span class="sc">:</span>(Periods<span class="sc">+</span><span class="dv">1</span>)] <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">rmultinom</span>(<span class="dv">1</span>, NumTagged[i], </span>
<span id="cb6-39"><a href="Mortality.html#cb6-39" tabindex="-1"></a>                                        TagFate[i,i<span class="sc">:</span>(Periods<span class="sc">+</span><span class="dv">1</span>)]))</span>
<span id="cb6-40"><a href="Mortality.html#cb6-40" tabindex="-1"></a>  } <span class="co">#i</span></span></code></pre></div>
<p>The analysis is again similar to Section <a href="Survival.html#BrownieSurvival">6.3</a> except that now we now have a multinomial distribution (Section <a href="Distributions.html#Multinomial">3.1.3</a>) with three possible fates (survival, harvest, natural death). Following Section 9.6 of <span class="citation">Kéry and Schaub (<a href="#ref-kéry.schaub_2012">2012</a>)</span>, we use three gamma-distributed (Section <a href="Distributions.html#GammaDist">3.2.5</a>) parameters that are scaled by their sum, thus ensuring that the rescaled values sum to 1. The parameters of interest (u, v, S) are calculated functions of the “a” parameters, which are used internally but not themselves of interest.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="Mortality.html#cb7-1" tabindex="-1"></a><span class="co"># Load necessary library packages</span></span>
<span id="cb7-2"><a href="Mortality.html#cb7-2" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb7-3"><a href="Mortality.html#cb7-3" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb7-4"><a href="Mortality.html#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="Mortality.html#cb7-5" tabindex="-1"></a>  <span class="co"># JAGS code</span></span>
<span id="cb7-6"><a href="Mortality.html#cb7-6" tabindex="-1"></a>  <span class="fu">sink</span>(<span class="st">&quot;TagReturn.txt&quot;</span>)</span>
<span id="cb7-7"><a href="Mortality.html#cb7-7" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb7-8"><a href="Mortality.html#cb7-8" tabindex="-1"></a><span class="st">  model {</span></span>
<span id="cb7-9"><a href="Mortality.html#cb7-9" tabindex="-1"></a><span class="st">  # Priors</span></span>
<span id="cb7-10"><a href="Mortality.html#cb7-10" tabindex="-1"></a><span class="st">  lam.est &lt;- 1 #  100% reporting of tags</span></span>
<span id="cb7-11"><a href="Mortality.html#cb7-11" tabindex="-1"></a><span class="st">  for (i in 1:Periods) {</span></span>
<span id="cb7-12"><a href="Mortality.html#cb7-12" tabindex="-1"></a><span class="st">     for (j in 1:3) # Rows are return periods, columns are fates</span></span>
<span id="cb7-13"><a href="Mortality.html#cb7-13" tabindex="-1"></a><span class="st">       {</span></span>
<span id="cb7-14"><a href="Mortality.html#cb7-14" tabindex="-1"></a><span class="st">         a[i,j] ~ dgamma(1,1)</span></span>
<span id="cb7-15"><a href="Mortality.html#cb7-15" tabindex="-1"></a><span class="st">       } #j</span></span>
<span id="cb7-16"><a href="Mortality.html#cb7-16" tabindex="-1"></a><span class="st">     S.est[i] &lt;- a[i,1]/sum(a[i,]) # Probability of survival</span></span>
<span id="cb7-17"><a href="Mortality.html#cb7-17" tabindex="-1"></a><span class="st">     u.est[i] &lt;- a[i,2]/sum(a[i,]) # Probability of harvest</span></span>
<span id="cb7-18"><a href="Mortality.html#cb7-18" tabindex="-1"></a><span class="st">     v.est[i] &lt;- a[i,3]/sum(a[i,]) # Probability of natural death</span></span>
<span id="cb7-19"><a href="Mortality.html#cb7-19" tabindex="-1"></a><span class="st">     # v.est[i] could also be obtained as 1-S.est[i]-u.est[i]</span></span>
<span id="cb7-20"><a href="Mortality.html#cb7-20" tabindex="-1"></a><span class="st">  } #i</span></span>
<span id="cb7-21"><a href="Mortality.html#cb7-21" tabindex="-1"></a></span>
<span id="cb7-22"><a href="Mortality.html#cb7-22" tabindex="-1"></a><span class="st"># Cell probabilities</span></span>
<span id="cb7-23"><a href="Mortality.html#cb7-23" tabindex="-1"></a><span class="st">  for (i in 1:Periods) {</span></span>
<span id="cb7-24"><a href="Mortality.html#cb7-24" tabindex="-1"></a><span class="st">    p.est[i,i] &lt;- lam.est * u.est[i]</span></span>
<span id="cb7-25"><a href="Mortality.html#cb7-25" tabindex="-1"></a><span class="st">    for (j in (i+1):Periods) {</span></span>
<span id="cb7-26"><a href="Mortality.html#cb7-26" tabindex="-1"></a><span class="st">      p.est[i,j] &lt;- prod(S.est[i:(j-1)])*lam.est*u.est[j]</span></span>
<span id="cb7-27"><a href="Mortality.html#cb7-27" tabindex="-1"></a><span class="st">      } #j</span></span>
<span id="cb7-28"><a href="Mortality.html#cb7-28" tabindex="-1"></a><span class="st">    p.est[i,Periods+1] &lt;- 1 - sum(p.est[i, i:Periods])</span></span>
<span id="cb7-29"><a href="Mortality.html#cb7-29" tabindex="-1"></a><span class="st">    # Probability of not being seen again</span></span>
<span id="cb7-30"><a href="Mortality.html#cb7-30" tabindex="-1"></a><span class="st">    } #i</span></span>
<span id="cb7-31"><a href="Mortality.html#cb7-31" tabindex="-1"></a><span class="st">  for (i in 1:Periods) {</span></span>
<span id="cb7-32"><a href="Mortality.html#cb7-32" tabindex="-1"></a><span class="st">  RandRet[i,i:(Periods+1)] ~ dmulti(p.est[i,i:(Periods+1)], </span></span>
<span id="cb7-33"><a href="Mortality.html#cb7-33" tabindex="-1"></a><span class="st">                                    NumTagged[i])</span></span>
<span id="cb7-34"><a href="Mortality.html#cb7-34" tabindex="-1"></a><span class="st">  }#i</span></span>
<span id="cb7-35"><a href="Mortality.html#cb7-35" tabindex="-1"></a><span class="st"> }</span></span>
<span id="cb7-36"><a href="Mortality.html#cb7-36" tabindex="-1"></a><span class="st">  &quot;</span>,<span class="at">fill=</span><span class="cn">TRUE</span>)</span>
<span id="cb7-37"><a href="Mortality.html#cb7-37" tabindex="-1"></a>  <span class="fu">sink</span>()</span>
<span id="cb7-38"><a href="Mortality.html#cb7-38" tabindex="-1"></a></span>
<span id="cb7-39"><a href="Mortality.html#cb7-39" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb7-40"><a href="Mortality.html#cb7-40" tabindex="-1"></a>  jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;RandRet&quot;</span>, <span class="st">&quot;Periods&quot;</span>, <span class="st">&quot;NumTagged&quot;</span>)</span>
<span id="cb7-41"><a href="Mortality.html#cb7-41" tabindex="-1"></a></span>
<span id="cb7-42"><a href="Mortality.html#cb7-42" tabindex="-1"></a><span class="co"># Initial values</span></span>
<span id="cb7-43"><a href="Mortality.html#cb7-43" tabindex="-1"></a>  a.init <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(Periods, <span class="dv">3</span>))</span>
<span id="cb7-44"><a href="Mortality.html#cb7-44" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb7-45"><a href="Mortality.html#cb7-45" tabindex="-1"></a>    a.init[i,] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n=</span><span class="dv">3</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">1</span>)</span>
<span id="cb7-46"><a href="Mortality.html#cb7-46" tabindex="-1"></a>    a.init[i,] <span class="ot">&lt;-</span> a.init[i,]<span class="sc">/</span><span class="fu">sum</span>(a.init[i,]) <span class="co"># Rescale to sum to 1</span></span>
<span id="cb7-47"><a href="Mortality.html#cb7-47" tabindex="-1"></a>  }</span>
<span id="cb7-48"><a href="Mortality.html#cb7-48" tabindex="-1"></a>  jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){ <span class="fu">list</span>(<span class="at">a=</span>a.init)}</span>
<span id="cb7-49"><a href="Mortality.html#cb7-49" tabindex="-1"></a></span>
<span id="cb7-50"><a href="Mortality.html#cb7-50" tabindex="-1"></a>  model.file <span class="ot">&lt;-</span> <span class="st">&#39;TagReturn.txt&#39;</span></span>
<span id="cb7-51"><a href="Mortality.html#cb7-51" tabindex="-1"></a></span>
<span id="cb7-52"><a href="Mortality.html#cb7-52" tabindex="-1"></a>  <span class="co"># Parameters monitored</span></span>
<span id="cb7-53"><a href="Mortality.html#cb7-53" tabindex="-1"></a>  jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;u.est&quot;</span>, <span class="st">&quot;v.est&quot;</span>)</span>
<span id="cb7-54"><a href="Mortality.html#cb7-54" tabindex="-1"></a></span>
<span id="cb7-55"><a href="Mortality.html#cb7-55" tabindex="-1"></a>   <span class="co"># Call JAGS from R</span></span>
<span id="cb7-56"><a href="Mortality.html#cb7-56" tabindex="-1"></a>  jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb7-57"><a href="Mortality.html#cb7-57" tabindex="-1"></a>                  <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin =</span> <span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">4000</span>, </span>
<span id="cb7-58"><a href="Mortality.html#cb7-58" tabindex="-1"></a>                  <span class="at">n.burnin=</span><span class="dv">2000</span>, model.file)</span>
<span id="cb7-59"><a href="Mortality.html#cb7-59" tabindex="-1"></a>  <span class="fu">print</span>(jagsfit)</span>
<span id="cb7-60"><a href="Mortality.html#cb7-60" tabindex="-1"></a>  <span class="fu">plot</span>(jagsfit)</span></code></pre></div>
<p>We provide arbitrary starting values for the “a” parameters by rescaling uniform (0,1) random variates. Using a large release on each occasion (1000), our estimates are generally close to the true values except that v.est[3] is imprecise and typically overestimated. It is the most difficult time-dependent parameter to estimate. We get direct information (from returned tags) about the final exploitation rate but there is much uncertainty about whether fish not seen are still at risk or are natural deaths. This is especially true for the final release because most fish are still at large (examine the TagFate and RandRet matrices). Note that this differs from a completed tagging study (Section <a href="Mortality.html#Hearn">7.2</a>), where the study continues until no live fish remain.</p>
<p>The analysis can be extended to include estimation of the tag-reporting rate. We use the simplest approach of a binomial experiment using planted tags <span class="citation">(<a href="#ref-hearn.etal_2003">Hearn et al. 2003</a>)</span>. The fraction of planted tags that is returned is a direct estimate of the tag-reporting rate. The only change required in the simulation code is to replace the assignment lam.true &lt;- 1.0 with the following three lines:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="Mortality.html#cb8-1" tabindex="-1"></a>lam.true <span class="ot">&lt;-</span> <span class="fl">0.9</span>  <span class="co"># Reporting rate</span></span>
<span id="cb8-2"><a href="Mortality.html#cb8-2" tabindex="-1"></a>PlantedTags <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb8-3"><a href="Mortality.html#cb8-3" tabindex="-1"></a>PlantReturns <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">size=</span>PlantedTags, <span class="at">prob=</span>lam.true)</span></code></pre></div>
<p>The assumed tag-reporting rate and number of planted tags are arbitrary and can be varied to see the effect on parameter uncertainty.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="Mortality.html#cb9-1" tabindex="-1"></a><span class="co"># Load necessary library packages</span></span>
<span id="cb9-2"><a href="Mortality.html#cb9-2" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb9-3"><a href="Mortality.html#cb9-3" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb9-4"><a href="Mortality.html#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="Mortality.html#cb9-5" tabindex="-1"></a><span class="co"># JAGS code</span></span>
<span id="cb9-6"><a href="Mortality.html#cb9-6" tabindex="-1"></a>  <span class="fu">sink</span>(<span class="st">&quot;TagReturn.txt&quot;</span>)</span>
<span id="cb9-7"><a href="Mortality.html#cb9-7" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb9-8"><a href="Mortality.html#cb9-8" tabindex="-1"></a><span class="st">  model {</span></span>
<span id="cb9-9"><a href="Mortality.html#cb9-9" tabindex="-1"></a><span class="st">  # Priors</span></span>
<span id="cb9-10"><a href="Mortality.html#cb9-10" tabindex="-1"></a><span class="st">  lam.est ~ dunif(0,1) # Reporting rate</span></span>
<span id="cb9-11"><a href="Mortality.html#cb9-11" tabindex="-1"></a><span class="st">  for (i in 1:Periods) {</span></span>
<span id="cb9-12"><a href="Mortality.html#cb9-12" tabindex="-1"></a><span class="st">     for (j in 1:3) # Rows are return periods, columns are fates</span></span>
<span id="cb9-13"><a href="Mortality.html#cb9-13" tabindex="-1"></a><span class="st">       {</span></span>
<span id="cb9-14"><a href="Mortality.html#cb9-14" tabindex="-1"></a><span class="st">         a[i,j] ~ dgamma(1,1)</span></span>
<span id="cb9-15"><a href="Mortality.html#cb9-15" tabindex="-1"></a><span class="st">       } #j</span></span>
<span id="cb9-16"><a href="Mortality.html#cb9-16" tabindex="-1"></a><span class="st">     S.est[i] &lt;- a[i,1]/sum(a[i,]) # Probability of survival</span></span>
<span id="cb9-17"><a href="Mortality.html#cb9-17" tabindex="-1"></a><span class="st">     u.est[i] &lt;- a[i,2]/sum(a[i,]) # Probability of harvest</span></span>
<span id="cb9-18"><a href="Mortality.html#cb9-18" tabindex="-1"></a><span class="st">     v.est[i] &lt;- a[i,3]/sum(a[i,]) # Probability of natural death</span></span>
<span id="cb9-19"><a href="Mortality.html#cb9-19" tabindex="-1"></a><span class="st">     # v.est[i] could also be obtained as 1-S.est[i]-u.est[i]</span></span>
<span id="cb9-20"><a href="Mortality.html#cb9-20" tabindex="-1"></a><span class="st">  } #i</span></span>
<span id="cb9-21"><a href="Mortality.html#cb9-21" tabindex="-1"></a></span>
<span id="cb9-22"><a href="Mortality.html#cb9-22" tabindex="-1"></a><span class="st"># Cell probabilities</span></span>
<span id="cb9-23"><a href="Mortality.html#cb9-23" tabindex="-1"></a><span class="st">  for (i in 1:Periods) {</span></span>
<span id="cb9-24"><a href="Mortality.html#cb9-24" tabindex="-1"></a><span class="st">    p.est[i,i] &lt;- lam.est * u.est[i]</span></span>
<span id="cb9-25"><a href="Mortality.html#cb9-25" tabindex="-1"></a><span class="st">    for (j in (i+1):Periods) {</span></span>
<span id="cb9-26"><a href="Mortality.html#cb9-26" tabindex="-1"></a><span class="st">      p.est[i,j] &lt;- prod(S.est[i:(j-1)])*lam.est*u.est[j]</span></span>
<span id="cb9-27"><a href="Mortality.html#cb9-27" tabindex="-1"></a><span class="st">      } #j</span></span>
<span id="cb9-28"><a href="Mortality.html#cb9-28" tabindex="-1"></a><span class="st">    p.est[i,Periods+1] &lt;- 1 - sum(p.est[i, i:Periods])   </span></span>
<span id="cb9-29"><a href="Mortality.html#cb9-29" tabindex="-1"></a><span class="st">      # Prob of not being seen again</span></span>
<span id="cb9-30"><a href="Mortality.html#cb9-30" tabindex="-1"></a><span class="st">    } #i</span></span>
<span id="cb9-31"><a href="Mortality.html#cb9-31" tabindex="-1"></a><span class="st">  for (i in 1:Periods) {</span></span>
<span id="cb9-32"><a href="Mortality.html#cb9-32" tabindex="-1"></a><span class="st">  RandRet[i,i:(Periods+1)] ~ dmulti(p.est[i,i:(Periods+1)], </span></span>
<span id="cb9-33"><a href="Mortality.html#cb9-33" tabindex="-1"></a><span class="st">                                    NumTagged[i])</span></span>
<span id="cb9-34"><a href="Mortality.html#cb9-34" tabindex="-1"></a><span class="st">  }#i</span></span>
<span id="cb9-35"><a href="Mortality.html#cb9-35" tabindex="-1"></a><span class="st">  PlantReturns ~ dbin(lam.est, PlantedTags) </span></span>
<span id="cb9-36"><a href="Mortality.html#cb9-36" tabindex="-1"></a><span class="st">    # Additional likelihood component</span></span>
<span id="cb9-37"><a href="Mortality.html#cb9-37" tabindex="-1"></a><span class="st"> }</span></span>
<span id="cb9-38"><a href="Mortality.html#cb9-38" tabindex="-1"></a><span class="st">  &quot;</span>,<span class="at">fill=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-39"><a href="Mortality.html#cb9-39" tabindex="-1"></a>  <span class="fu">sink</span>()</span>
<span id="cb9-40"><a href="Mortality.html#cb9-40" tabindex="-1"></a></span>
<span id="cb9-41"><a href="Mortality.html#cb9-41" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb9-42"><a href="Mortality.html#cb9-42" tabindex="-1"></a>  jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;RandRet&quot;</span>, <span class="st">&quot;Periods&quot;</span>, <span class="st">&quot;NumTagged&quot;</span>, <span class="st">&quot;PlantedTags&quot;</span>,</span>
<span id="cb9-43"><a href="Mortality.html#cb9-43" tabindex="-1"></a>                    <span class="st">&quot;PlantReturns&quot;</span>)</span>
<span id="cb9-44"><a href="Mortality.html#cb9-44" tabindex="-1"></a></span>
<span id="cb9-45"><a href="Mortality.html#cb9-45" tabindex="-1"></a><span class="co"># Initial values</span></span>
<span id="cb9-46"><a href="Mortality.html#cb9-46" tabindex="-1"></a>  a.init <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(Periods, <span class="dv">3</span>))</span>
<span id="cb9-47"><a href="Mortality.html#cb9-47" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb9-48"><a href="Mortality.html#cb9-48" tabindex="-1"></a>    a.init[i,] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n=</span><span class="dv">3</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">1</span>)</span>
<span id="cb9-49"><a href="Mortality.html#cb9-49" tabindex="-1"></a>    a.init[i,] <span class="ot">&lt;-</span> a.init[i,]<span class="sc">/</span><span class="fu">sum</span>(a.init[i,])  <span class="co"># Rescale to sum to 1</span></span>
<span id="cb9-50"><a href="Mortality.html#cb9-50" tabindex="-1"></a>  }</span>
<span id="cb9-51"><a href="Mortality.html#cb9-51" tabindex="-1"></a>  jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){ <span class="fu">list</span>(<span class="at">a=</span>a.init)}</span>
<span id="cb9-52"><a href="Mortality.html#cb9-52" tabindex="-1"></a></span>
<span id="cb9-53"><a href="Mortality.html#cb9-53" tabindex="-1"></a>  model.file <span class="ot">&lt;-</span> <span class="st">&#39;TagReturn.txt&#39;</span></span>
<span id="cb9-54"><a href="Mortality.html#cb9-54" tabindex="-1"></a></span>
<span id="cb9-55"><a href="Mortality.html#cb9-55" tabindex="-1"></a>  <span class="co"># Parameters monitored</span></span>
<span id="cb9-56"><a href="Mortality.html#cb9-56" tabindex="-1"></a>  jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;lam.est&quot;</span>, <span class="st">&quot;u.est&quot;</span>, <span class="st">&quot;v.est&quot;</span>)</span>
<span id="cb9-57"><a href="Mortality.html#cb9-57" tabindex="-1"></a></span>
<span id="cb9-58"><a href="Mortality.html#cb9-58" tabindex="-1"></a>   <span class="co"># Call JAGS from R</span></span>
<span id="cb9-59"><a href="Mortality.html#cb9-59" tabindex="-1"></a>  jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb9-60"><a href="Mortality.html#cb9-60" tabindex="-1"></a>                  <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin =</span> <span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">10000</span>, </span>
<span id="cb9-61"><a href="Mortality.html#cb9-61" tabindex="-1"></a>                  <span class="at">n.burnin=</span><span class="dv">5000</span>, model.file)</span>
<span id="cb9-62"><a href="Mortality.html#cb9-62" tabindex="-1"></a>  <span class="fu">print</span>(jagsfit)</span>
<span id="cb9-63"><a href="Mortality.html#cb9-63" tabindex="-1"></a>  <span class="fu">plot</span>(jagsfit)</span></code></pre></div>
<p>The auxiliary planted tag experiment requires only a few changes in the JAGS code. We provide an uninformative prior distribution for the now estimated parameter lam.est, and pass in the number of planted tags and returns. We let JAGS generate an initial value for lam.est. The additional likelihood component describes the binomial experiment. Convergence may be slower for this version of the code, so the number of MCMC iterations was increased to 10,000.</p>
<div class="figure"><span style="display:block;" id="fig:BrowniePlot"></span>
<img src="bookdown_files/figure-html/BrowniePlot-1.png" alt="Estimated posterior distributions for exploitation rate in period 2 at tag reporting rates of 0.9 (top) and 0.5 (bottom), using a multi-year tagging study with planted tags. The true exploitation rate for period 2 is shown as a dotted vertical line." width="90%" /><img src="bookdown_files/figure-html/BrowniePlot-2.png" alt="Estimated posterior distributions for exploitation rate in period 2 at tag reporting rates of 0.9 (top) and 0.5 (bottom), using a multi-year tagging study with planted tags. The true exploitation rate for period 2 is shown as a dotted vertical line." width="90%" />
<p class="caption">
FIGURE 7.3: Estimated posterior distributions for exploitation rate in period 2 at tag reporting rates of 0.9 (top) and 0.5 (bottom), using a multi-year tagging study with planted tags. The true exploitation rate for period 2 is shown as a dotted vertical line.
</p>
</div>
<p>Estimates have similar precision to the original example if the reporting rate is high (Figure <a href="Mortality.html#fig:BrowniePlot">7.3</a>). Precision is reduced at lower reporting rates because of the reduced sample size of returned tags and uncertainty about lambda.</p>
</div>
<div id="TelemetryFandM" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Telemetry-based<a href="Mortality.html#TelemetryFandM" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In Section <a href="Survival.html#TelemetryBased">6.2</a>, we used fixed receiving stations and telemetry tags to estimate the survival rate. Here we extend that approach to partition total mortality into fishing and natural components by giving telemetered fish an external high-reward tag <span class="citation">(Design C of <a href="#ref-hightower.harris_2017">Hightower and Harris 2017</a>)</span>. Live fish “detect themselves” and provide information on survival by passing within range of a receiver. Harvest information comes from the reported high-reward tags. Thus we have observations on two of the three possible states, with natural mortality being the only unobserved true state. An important practical advantage of this approach is that field surveys are not needed after tagging is done (other than maintaining the receiver array and downloading detection data).</p>
<p>We begin with a detour to introduce dcat, the JAGS categorical distribution, used to estimate probabilities for observations from different categories.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="Mortality.html#cb10-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb10-2"><a href="Mortality.html#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="Mortality.html#cb10-3" tabindex="-1"></a><span class="co"># Load necessary library packages</span></span>
<span id="cb10-4"><a href="Mortality.html#cb10-4" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb10-5"><a href="Mortality.html#cb10-5" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb10-6"><a href="Mortality.html#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="Mortality.html#cb10-7" tabindex="-1"></a><span class="co"># JAGS code</span></span>
<span id="cb10-8"><a href="Mortality.html#cb10-8" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;dcat_example.txt&quot;</span>)</span>
<span id="cb10-9"><a href="Mortality.html#cb10-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb10-10"><a href="Mortality.html#cb10-10" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb10-11"><a href="Mortality.html#cb10-11" tabindex="-1"></a></span>
<span id="cb10-12"><a href="Mortality.html#cb10-12" tabindex="-1"></a><span class="st"># Priors</span></span>
<span id="cb10-13"><a href="Mortality.html#cb10-13" tabindex="-1"></a><span class="st">    for (j in 1:3) {</span></span>
<span id="cb10-14"><a href="Mortality.html#cb10-14" tabindex="-1"></a><span class="st">         a[j] ~ dgamma(1,1)</span></span>
<span id="cb10-15"><a href="Mortality.html#cb10-15" tabindex="-1"></a><span class="st">         } #j</span></span>
<span id="cb10-16"><a href="Mortality.html#cb10-16" tabindex="-1"></a><span class="st">     p[1] &lt;- a[1]/sum(a[])</span></span>
<span id="cb10-17"><a href="Mortality.html#cb10-17" tabindex="-1"></a><span class="st">     p[2] &lt;- a[2]/sum(a[])</span></span>
<span id="cb10-18"><a href="Mortality.html#cb10-18" tabindex="-1"></a><span class="st">     p[3] &lt;- a[3]/sum(a[]) # Could also be obtained as 1-p[1]-p[2]</span></span>
<span id="cb10-19"><a href="Mortality.html#cb10-19" tabindex="-1"></a></span>
<span id="cb10-20"><a href="Mortality.html#cb10-20" tabindex="-1"></a><span class="st"># Likelihood</span></span>
<span id="cb10-21"><a href="Mortality.html#cb10-21" tabindex="-1"></a><span class="st">  for (i in 1:N){</span></span>
<span id="cb10-22"><a href="Mortality.html#cb10-22" tabindex="-1"></a><span class="st">    y[i] ~ dcat(p[])</span></span>
<span id="cb10-23"><a href="Mortality.html#cb10-23" tabindex="-1"></a><span class="st">  } #i</span></span>
<span id="cb10-24"><a href="Mortality.html#cb10-24" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb10-25"><a href="Mortality.html#cb10-25" tabindex="-1"></a><span class="st">    &quot;</span>,<span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-26"><a href="Mortality.html#cb10-26" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb10-27"><a href="Mortality.html#cb10-27" tabindex="-1"></a></span>
<span id="cb10-28"><a href="Mortality.html#cb10-28" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb10-29"><a href="Mortality.html#cb10-29" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>) <span class="co"># Each observation drawn from category 1, 2, or 3</span></span>
<span id="cb10-30"><a href="Mortality.html#cb10-30" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb10-31"><a href="Mortality.html#cb10-31" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;N&quot;</span>, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb10-32"><a href="Mortality.html#cb10-32" tabindex="-1"></a></span>
<span id="cb10-33"><a href="Mortality.html#cb10-33" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;dcat_example.txt&#39;</span></span>
<span id="cb10-34"><a href="Mortality.html#cb10-34" tabindex="-1"></a></span>
<span id="cb10-35"><a href="Mortality.html#cb10-35" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb10-36"><a href="Mortality.html#cb10-36" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;p&quot;</span>)</span>
<span id="cb10-37"><a href="Mortality.html#cb10-37" tabindex="-1"></a></span>
<span id="cb10-38"><a href="Mortality.html#cb10-38" tabindex="-1"></a><span class="co"># Call JAGS from R</span></span>
<span id="cb10-39"><a href="Mortality.html#cb10-39" tabindex="-1"></a>jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span><span class="cn">NULL</span>,</span>
<span id="cb10-40"><a href="Mortality.html#cb10-40" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">2000</span>,</span>
<span id="cb10-41"><a href="Mortality.html#cb10-41" tabindex="-1"></a>                model.file)</span>
<span id="cb10-42"><a href="Mortality.html#cb10-42" tabindex="-1"></a><span class="fu">print</span>(jagsfit)</span>
<span id="cb10-43"><a href="Mortality.html#cb10-43" tabindex="-1"></a><span class="fu">plot</span>(jagsfit)</span></code></pre></div>
<p>Our dcat example has a y vector with five observations in the range of 1 to 3. The categories can be of any sort; for example, age or species code for individual fish. The model parameters of interest are calculated variables representing the probabilities of the three categories. The probabilities sum to 1, so as in Section <a href="Mortality.html#BrownieFandM">7.3</a>, we calculate them using an “a” vector with an uninformative gamma prior distribution. (A Dirichlet distribution can also be used as an uninformative prior distribution for probabilities that must sum to 1 <span class="citation">(<a href="#ref-mccarthy_2007">McCarthy 2007</a>)</span>.) For the purposes of this section, the p vector could represent probabilities of survival, harvest, or natural death. The MCMC process adjusts the p estimates to achieve the best possible match between model predictions and the observations (y vector). For simplicity, we let JAGS provide the initial values for the “a” vector. The estimates have wide credible intervals because of the small sample size.</p>
<p>Returning to the telemetry example, we begin with simulation code, using arbitrary values for the number of occasions and sample size. Varying the patterns for rates of exploitation and natural death is helpful in judging the model’s ability to detect moderate time variation. This is a multistate model <span class="citation">(<a href="#ref-kéry.schaub_2012">Kéry and Schaub 2012</a>)</span>, with a matrix (PSI.STATE) describing the various true states and the probabilities for transitioning between states over time. The three rows represent true states alive, harvest, and natural death. A fish that is alive (row 1) can remain alive (probability S.true), be harvested (probability u.true), or become a natural mortality (probability v.true). A harvested fish (row 2) remains in that state with probability 1, as does a natural death (row 3). Note that the third matrix dimension for PSI.STATE is time, as the rates are time-dependent.</p>
<p>The observation matrix (PSI.OBS) has a similar structure. Rows are true states, columns are observed states, and the third dimension is time. There are three possible observed states: detected alive, harvested, and not detected. A live fish (row 1) can either be detected or not, with probabilities p[t] and 1-p[t]. A harvested fish (row 2) is assumed to be always detected (100% tag-reporting rate), and a natural death (row 3) is never detected.</p>
<p>The function for generating the simulated capture-history matrix (simul.ms) is complex, but key features are as follows. All fish are assumed to be tagged (transmitters and external tags) at time 1. Next we loop over occasions and use a multinomial trial to determine the true state transition between time t-1 and t (i.e., a live fish at time t-1 can remain alive, be harvested, or transition to natural death). To better understand the multinomial trial, try a simpler example in the Console. For example, <code>rmultinom(n=1, size=1, prob=c(0.7, 0.25, 0.05))</code> is a single trial (n=1) for one individual (size=1), with three states at the specified probabilities. The function returns a matrix with a 1 in a randomly determined row. The <code>which()</code> function locates the “1” and returns the row index (= fish’s state). This example could represent probabilities that a live fish at time t-1 survives (0.7), is harvested (0.25), or is a natural death (0.05). Returning to the code, a second multinomial trial based on the fish’s true state draws a random observed outcome (e.g., a live fish is either detected or missed).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="Mortality.html#cb11-1" tabindex="-1"></a><span class="co"># Code modified from Kéry and Schaub 2012, Section 9.5</span></span>
<span id="cb11-2"><a href="Mortality.html#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="Mortality.html#cb11-3" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb11-4"><a href="Mortality.html#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="Mortality.html#cb11-5" tabindex="-1"></a><span class="co"># Generation of simulated data</span></span>
<span id="cb11-6"><a href="Mortality.html#cb11-6" tabindex="-1"></a><span class="co"># Define probabilities as well as number of occasions, </span></span>
<span id="cb11-7"><a href="Mortality.html#cb11-7" tabindex="-1"></a><span class="co"># states, observations and released individuals</span></span>
<span id="cb11-8"><a href="Mortality.html#cb11-8" tabindex="-1"></a>n.occasions <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb11-9"><a href="Mortality.html#cb11-9" tabindex="-1"></a>n.tagged <span class="ot">&lt;-</span> <span class="dv">100</span>  <span class="co"># Simplify from Kéry&#39;s version, </span></span>
<span id="cb11-10"><a href="Mortality.html#cb11-10" tabindex="-1"></a>                 <span class="co"># only an initial release, and no spatial states</span></span>
<span id="cb11-11"><a href="Mortality.html#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="Mortality.html#cb11-12" tabindex="-1"></a>u.true <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span>)</span>
<span id="cb11-13"><a href="Mortality.html#cb11-13" tabindex="-1"></a>v.true <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.15</span>, <span class="fl">0.1</span>)</span>
<span id="cb11-14"><a href="Mortality.html#cb11-14" tabindex="-1"></a>S.true <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>u.true<span class="sc">-</span>v.true</span>
<span id="cb11-15"><a href="Mortality.html#cb11-15" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span>)</span>
<span id="cb11-16"><a href="Mortality.html#cb11-16" tabindex="-1"></a><span class="co">#  Detection probability fixed at 1 for first period, </span></span>
<span id="cb11-17"><a href="Mortality.html#cb11-17" tabindex="-1"></a><span class="co"># n.occasions-1 searches (e.g start of period 2, 3, ..)</span></span>
<span id="cb11-18"><a href="Mortality.html#cb11-18" tabindex="-1"></a></span>
<span id="cb11-19"><a href="Mortality.html#cb11-19" tabindex="-1"></a>n.states <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb11-20"><a href="Mortality.html#cb11-20" tabindex="-1"></a>n.obs <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb11-21"><a href="Mortality.html#cb11-21" tabindex="-1"></a></span>
<span id="cb11-22"><a href="Mortality.html#cb11-22" tabindex="-1"></a><span class="co"># Define matrices with survival, transition and detection probabilities</span></span>
<span id="cb11-23"><a href="Mortality.html#cb11-23" tabindex="-1"></a></span>
<span id="cb11-24"><a href="Mortality.html#cb11-24" tabindex="-1"></a><span class="co"># 1. State process matrix, dimensions 1=state[t], 2=state[t+1], 3=time</span></span>
<span id="cb11-25"><a href="Mortality.html#cb11-25" tabindex="-1"></a>PSI.STATE <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(n.states, n.states, n.occasions<span class="dv">-1</span>))</span>
<span id="cb11-26"><a href="Mortality.html#cb11-26" tabindex="-1"></a>   <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n.occasions<span class="dv">-1</span>)){</span>
<span id="cb11-27"><a href="Mortality.html#cb11-27" tabindex="-1"></a>      PSI.STATE[,,t] <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb11-28"><a href="Mortality.html#cb11-28" tabindex="-1"></a>      S.true[t], u.true[t], v.true[t],</span>
<span id="cb11-29"><a href="Mortality.html#cb11-29" tabindex="-1"></a>      <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb11-30"><a href="Mortality.html#cb11-30" tabindex="-1"></a>      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">nrow =</span> n.states, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-31"><a href="Mortality.html#cb11-31" tabindex="-1"></a>      } <span class="co">#t</span></span>
<span id="cb11-32"><a href="Mortality.html#cb11-32" tabindex="-1"></a></span>
<span id="cb11-33"><a href="Mortality.html#cb11-33" tabindex="-1"></a><span class="co"># 2.Observation process matrix.  1=true state, 2=observed state, 3=time</span></span>
<span id="cb11-34"><a href="Mortality.html#cb11-34" tabindex="-1"></a>PSI.OBS <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(n.states, n.obs, n.occasions))</span>
<span id="cb11-35"><a href="Mortality.html#cb11-35" tabindex="-1"></a>   <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.occasions){</span>
<span id="cb11-36"><a href="Mortality.html#cb11-36" tabindex="-1"></a>      PSI.OBS[,,t] <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb11-37"><a href="Mortality.html#cb11-37" tabindex="-1"></a>      p[t], <span class="dv">0</span>, <span class="dv">1</span><span class="sc">-</span>p[t],</span>
<span id="cb11-38"><a href="Mortality.html#cb11-38" tabindex="-1"></a>      <span class="dv">0</span>,  <span class="dv">1</span>, <span class="dv">0</span>,  <span class="co"># Caught w/ high-reward tag, assume 100% reporting</span></span>
<span id="cb11-39"><a href="Mortality.html#cb11-39" tabindex="-1"></a>      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">nrow =</span> n.states, <span class="at">byrow =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb11-40"><a href="Mortality.html#cb11-40" tabindex="-1"></a>        <span class="co"># Natural deaths never detected</span></span>
<span id="cb11-41"><a href="Mortality.html#cb11-41" tabindex="-1"></a>      } <span class="co">#t</span></span>
<span id="cb11-42"><a href="Mortality.html#cb11-42" tabindex="-1"></a></span>
<span id="cb11-43"><a href="Mortality.html#cb11-43" tabindex="-1"></a><span class="co"># Define function to simulate multistate capture-recapture data</span></span>
<span id="cb11-44"><a href="Mortality.html#cb11-44" tabindex="-1"></a>simul.ms <span class="ot">&lt;-</span> <span class="cf">function</span>(PSI.STATE, PSI.OBS, n.tagged, n.occasions){</span>
<span id="cb11-45"><a href="Mortality.html#cb11-45" tabindex="-1"></a>   CH <span class="ot">&lt;-</span> CH.TRUE <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> n.occasions, <span class="at">nrow =</span> n.tagged)</span>
<span id="cb11-46"><a href="Mortality.html#cb11-46" tabindex="-1"></a>   CH[,<span class="dv">1</span>] <span class="ot">&lt;-</span> CH.TRUE[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># All releases at t=1</span></span>
<span id="cb11-47"><a href="Mortality.html#cb11-47" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.tagged){</span>
<span id="cb11-48"><a href="Mortality.html#cb11-48" tabindex="-1"></a>     <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n.occasions){</span>
<span id="cb11-49"><a href="Mortality.html#cb11-49" tabindex="-1"></a>         <span class="co"># Multinomial trials for state transitions</span></span>
<span id="cb11-50"><a href="Mortality.html#cb11-50" tabindex="-1"></a>         CH.TRUE[i,t] <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">rmultinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">size=</span><span class="dv">1</span>,</span>
<span id="cb11-51"><a href="Mortality.html#cb11-51" tabindex="-1"></a>                            <span class="at">prob=</span>PSI.STATE[CH.TRUE[i,t<span class="dv">-1</span>],,t<span class="dv">-1</span>])<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb11-52"><a href="Mortality.html#cb11-52" tabindex="-1"></a>         <span class="co"># which vector element=1; i.e., which state gets random draw</span></span>
<span id="cb11-53"><a href="Mortality.html#cb11-53" tabindex="-1"></a>         <span class="co"># at time t given true state at t-1. True state determines</span></span>
<span id="cb11-54"><a href="Mortality.html#cb11-54" tabindex="-1"></a>         <span class="co"># which row of PSI.STATE provides probabilities</span></span>
<span id="cb11-55"><a href="Mortality.html#cb11-55" tabindex="-1"></a></span>
<span id="cb11-56"><a href="Mortality.html#cb11-56" tabindex="-1"></a>         <span class="co"># Multinomial trials for observation process</span></span>
<span id="cb11-57"><a href="Mortality.html#cb11-57" tabindex="-1"></a>         CH[i,t] <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">rmultinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, PSI.OBS[CH.TRUE[i,t],,t])<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb11-58"><a href="Mortality.html#cb11-58" tabindex="-1"></a>         <span class="co"># which observation gets the 1 random draw, given </span></span>
<span id="cb11-59"><a href="Mortality.html#cb11-59" tabindex="-1"></a>         <span class="co"># true time t state.</span></span>
<span id="cb11-60"><a href="Mortality.html#cb11-60" tabindex="-1"></a>         } <span class="co">#t</span></span>
<span id="cb11-61"><a href="Mortality.html#cb11-61" tabindex="-1"></a>      } <span class="co">#i</span></span>
<span id="cb11-62"><a href="Mortality.html#cb11-62" tabindex="-1"></a></span>
<span id="cb11-63"><a href="Mortality.html#cb11-63" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">CH=</span>CH, <span class="at">CH.TRUE=</span>CH.TRUE)) </span>
<span id="cb11-64"><a href="Mortality.html#cb11-64" tabindex="-1"></a>      <span class="co"># True (CH.TRUE) and observed (CH)</span></span>
<span id="cb11-65"><a href="Mortality.html#cb11-65" tabindex="-1"></a>   } <span class="co"># simul.ms</span></span></code></pre></div>
<p>The JAGS code is also complex but does generally mirror the simulation code.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="Mortality.html#cb12-1" tabindex="-1"></a><span class="co"># Load necessary library packages</span></span>
<span id="cb12-2"><a href="Mortality.html#cb12-2" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb12-3"><a href="Mortality.html#cb12-3" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb12-4"><a href="Mortality.html#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="Mortality.html#cb12-5" tabindex="-1"></a><span class="co"># JAGS code for estimating model parameters</span></span>
<span id="cb12-6"><a href="Mortality.html#cb12-6" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;Mort_Tel_HRTag.txt&quot;</span>)</span>
<span id="cb12-7"><a href="Mortality.html#cb12-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb12-8"><a href="Mortality.html#cb12-8" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb12-9"><a href="Mortality.html#cb12-9" tabindex="-1"></a></span>
<span id="cb12-10"><a href="Mortality.html#cb12-10" tabindex="-1"></a><span class="st"># Priors</span></span>
<span id="cb12-11"><a href="Mortality.html#cb12-11" tabindex="-1"></a><span class="st">for (t in 1:(n.occasions-1)) {</span></span>
<span id="cb12-12"><a href="Mortality.html#cb12-12" tabindex="-1"></a><span class="st">     for (j in 1:3) { # Rows are return periods, columns are fates</span></span>
<span id="cb12-13"><a href="Mortality.html#cb12-13" tabindex="-1"></a><span class="st">         a[t,j] ~ dgamma(1,1)</span></span>
<span id="cb12-14"><a href="Mortality.html#cb12-14" tabindex="-1"></a><span class="st">         } #j</span></span>
<span id="cb12-15"><a href="Mortality.html#cb12-15" tabindex="-1"></a><span class="st">     S.est[t] &lt;- a[t,1]/sum(a[t,]) # Probability of survival</span></span>
<span id="cb12-16"><a href="Mortality.html#cb12-16" tabindex="-1"></a><span class="st">     u.est[t] &lt;- a[t,2]/sum(a[t,]) # Probability of harvest</span></span>
<span id="cb12-17"><a href="Mortality.html#cb12-17" tabindex="-1"></a><span class="st">     v.est[t] &lt;- a[t,3]/sum(a[t,]) # Probability of natural death</span></span>
<span id="cb12-18"><a href="Mortality.html#cb12-18" tabindex="-1"></a><span class="st">     # v.est[t] could also be obtained as 1-S.est[t]-u.est[t]</span></span>
<span id="cb12-19"><a href="Mortality.html#cb12-19" tabindex="-1"></a><span class="st">    } #t</span></span>
<span id="cb12-20"><a href="Mortality.html#cb12-20" tabindex="-1"></a></span>
<span id="cb12-21"><a href="Mortality.html#cb12-21" tabindex="-1"></a><span class="st">  p[1] ~ dbern(1)</span></span>
<span id="cb12-22"><a href="Mortality.html#cb12-22" tabindex="-1"></a><span class="st">  for (t in 2:n.occasions){</span></span>
<span id="cb12-23"><a href="Mortality.html#cb12-23" tabindex="-1"></a><span class="st">    p[t] ~ dunif(0,1)</span></span>
<span id="cb12-24"><a href="Mortality.html#cb12-24" tabindex="-1"></a><span class="st">    }#t</span></span>
<span id="cb12-25"><a href="Mortality.html#cb12-25" tabindex="-1"></a></span>
<span id="cb12-26"><a href="Mortality.html#cb12-26" tabindex="-1"></a><span class="st"># Define state-transition and observation matrices</span></span>
<span id="cb12-27"><a href="Mortality.html#cb12-27" tabindex="-1"></a><span class="st"># Probabilities of true state at t+1 given state at time t</span></span>
<span id="cb12-28"><a href="Mortality.html#cb12-28" tabindex="-1"></a><span class="st">    for (t in 1:(n.occasions-1)){</span></span>
<span id="cb12-29"><a href="Mortality.html#cb12-29" tabindex="-1"></a><span class="st">    ps[1,t,1] &lt;- S.est[t]</span></span>
<span id="cb12-30"><a href="Mortality.html#cb12-30" tabindex="-1"></a><span class="st">    ps[1,t,2] &lt;- u.est[t]</span></span>
<span id="cb12-31"><a href="Mortality.html#cb12-31" tabindex="-1"></a><span class="st">    ps[1,t,3] &lt;- v.est[t]</span></span>
<span id="cb12-32"><a href="Mortality.html#cb12-32" tabindex="-1"></a><span class="st">    ps[2,t,1] &lt;- 0</span></span>
<span id="cb12-33"><a href="Mortality.html#cb12-33" tabindex="-1"></a><span class="st">    ps[2,t,2] &lt;- 1</span></span>
<span id="cb12-34"><a href="Mortality.html#cb12-34" tabindex="-1"></a><span class="st">    ps[2,t,3] &lt;- 0</span></span>
<span id="cb12-35"><a href="Mortality.html#cb12-35" tabindex="-1"></a><span class="st">    ps[3,t,1] &lt;- 0</span></span>
<span id="cb12-36"><a href="Mortality.html#cb12-36" tabindex="-1"></a><span class="st">    ps[3,t,2] &lt;- 0</span></span>
<span id="cb12-37"><a href="Mortality.html#cb12-37" tabindex="-1"></a><span class="st">    ps[3,t,3] &lt;- 1</span></span>
<span id="cb12-38"><a href="Mortality.html#cb12-38" tabindex="-1"></a><span class="st">    } #t</span></span>
<span id="cb12-39"><a href="Mortality.html#cb12-39" tabindex="-1"></a></span>
<span id="cb12-40"><a href="Mortality.html#cb12-40" tabindex="-1"></a><span class="st"># Probabilities of observed states given true state</span></span>
<span id="cb12-41"><a href="Mortality.html#cb12-41" tabindex="-1"></a><span class="st">    for (t in 2:n.occasions){</span></span>
<span id="cb12-42"><a href="Mortality.html#cb12-42" tabindex="-1"></a><span class="st">    po[1,t,1] &lt;- p[t]  # Row 1 true state = alive</span></span>
<span id="cb12-43"><a href="Mortality.html#cb12-43" tabindex="-1"></a><span class="st">    po[1,t,2] &lt;- 0</span></span>
<span id="cb12-44"><a href="Mortality.html#cb12-44" tabindex="-1"></a><span class="st">    po[1,t,3] &lt;- 1-p[t]</span></span>
<span id="cb12-45"><a href="Mortality.html#cb12-45" tabindex="-1"></a><span class="st">    po[2,t,1] &lt;- 0     # Row 2 true state = harvested</span></span>
<span id="cb12-46"><a href="Mortality.html#cb12-46" tabindex="-1"></a><span class="st">    po[2,t,2] &lt;- 1</span></span>
<span id="cb12-47"><a href="Mortality.html#cb12-47" tabindex="-1"></a><span class="st">    po[2,t,3] &lt;- 0</span></span>
<span id="cb12-48"><a href="Mortality.html#cb12-48" tabindex="-1"></a><span class="st">    po[3,t,1] &lt;- 0     # Row 3 true state= natural death</span></span>
<span id="cb12-49"><a href="Mortality.html#cb12-49" tabindex="-1"></a><span class="st">    po[3,t,2] &lt;- 0</span></span>
<span id="cb12-50"><a href="Mortality.html#cb12-50" tabindex="-1"></a><span class="st">    po[3,t,3] &lt;- 1</span></span>
<span id="cb12-51"><a href="Mortality.html#cb12-51" tabindex="-1"></a><span class="st">    } #t</span></span>
<span id="cb12-52"><a href="Mortality.html#cb12-52" tabindex="-1"></a></span>
<span id="cb12-53"><a href="Mortality.html#cb12-53" tabindex="-1"></a><span class="st">    # Likelihood</span></span>
<span id="cb12-54"><a href="Mortality.html#cb12-54" tabindex="-1"></a><span class="st">    for (i in 1:n.tagged){</span></span>
<span id="cb12-55"><a href="Mortality.html#cb12-55" tabindex="-1"></a><span class="st">    z[i,1] &lt;- y[i,1] # Latent state known at time of tagging (t=1)</span></span>
<span id="cb12-56"><a href="Mortality.html#cb12-56" tabindex="-1"></a><span class="st">    for (t in 2:n.occasions){</span></span>
<span id="cb12-57"><a href="Mortality.html#cb12-57" tabindex="-1"></a><span class="st">    # State process: draw state at time t given state at time t-1</span></span>
<span id="cb12-58"><a href="Mortality.html#cb12-58" tabindex="-1"></a><span class="st">    z[i,t] ~ dcat(ps[z[i,(t-1)], (t-1),])</span></span>
<span id="cb12-59"><a href="Mortality.html#cb12-59" tabindex="-1"></a><span class="st">    # Observation process: obs state given true state at time t</span></span>
<span id="cb12-60"><a href="Mortality.html#cb12-60" tabindex="-1"></a><span class="st">    y[i,t] ~ dcat(po[z[i,t], t,])</span></span>
<span id="cb12-61"><a href="Mortality.html#cb12-61" tabindex="-1"></a><span class="st">    } #t</span></span>
<span id="cb12-62"><a href="Mortality.html#cb12-62" tabindex="-1"></a><span class="st">    } #i</span></span>
<span id="cb12-63"><a href="Mortality.html#cb12-63" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb12-64"><a href="Mortality.html#cb12-64" tabindex="-1"></a><span class="st">    &quot;</span>,<span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-65"><a href="Mortality.html#cb12-65" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb12-66"><a href="Mortality.html#cb12-66" tabindex="-1"></a></span>
<span id="cb12-67"><a href="Mortality.html#cb12-67" tabindex="-1"></a><span class="co"># Generate initial values for z. Modified from Kéry code for</span></span>
<span id="cb12-68"><a href="Mortality.html#cb12-68" tabindex="-1"></a><span class="co"># JAGS inits, age-specific example 9.5.3</span></span>
<span id="cb12-69"><a href="Mortality.html#cb12-69" tabindex="-1"></a>z.init <span class="ot">&lt;-</span> <span class="cf">function</span>(ch) {</span>
<span id="cb12-70"><a href="Mortality.html#cb12-70" tabindex="-1"></a>  <span class="co"># State 1=Obs 1 (alive) State 2=Obs 2 (fishing death). </span></span>
<span id="cb12-71"><a href="Mortality.html#cb12-71" tabindex="-1"></a>  <span class="co"># Start w/ known states from obs capture-history,</span></span>
<span id="cb12-72"><a href="Mortality.html#cb12-72" tabindex="-1"></a>  <span class="co"># replace &quot;3&quot; with possible state(s)</span></span>
<span id="cb12-73"><a href="Mortality.html#cb12-73" tabindex="-1"></a>  ch[ch<span class="sc">==</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span>  <span class="co"># Not observed so temporarily replace w/ neg value</span></span>
<span id="cb12-74"><a href="Mortality.html#cb12-74" tabindex="-1"></a>  ch[,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span>  <span class="co"># Initial value not needed for release period</span></span>
<span id="cb12-75"><a href="Mortality.html#cb12-75" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(ch)){</span>
<span id="cb12-76"><a href="Mortality.html#cb12-76" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">max</span>(ch[i,], <span class="at">na.rm=</span><span class="cn">TRUE</span>)<span class="sc">&lt;</span><span class="dv">2</span>){</span>
<span id="cb12-77"><a href="Mortality.html#cb12-77" tabindex="-1"></a>      ch[i, <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(ch)] <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb12-78"><a href="Mortality.html#cb12-78" tabindex="-1"></a>      <span class="co"># Not detected dead so initialize as alive (after release period)</span></span>
<span id="cb12-79"><a href="Mortality.html#cb12-79" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb12-80"><a href="Mortality.html#cb12-80" tabindex="-1"></a>      m <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">which</span>(ch[i,]<span class="sc">==</span><span class="dv">2</span>))  </span>
<span id="cb12-81"><a href="Mortality.html#cb12-81" tabindex="-1"></a>        <span class="co"># Period when fishing death first detected</span></span>
<span id="cb12-82"><a href="Mortality.html#cb12-82" tabindex="-1"></a>      <span class="cf">if</span>(m<span class="sc">&gt;</span><span class="dv">2</span>) ch[i, <span class="dv">2</span><span class="sc">:</span>(m<span class="dv">-1</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span>  </span>
<span id="cb12-83"><a href="Mortality.html#cb12-83" tabindex="-1"></a>      <span class="co"># Initialize as alive up to period prior to harvest</span></span>
<span id="cb12-84"><a href="Mortality.html#cb12-84" tabindex="-1"></a>      ch[i, m<span class="sc">:</span><span class="fu">ncol</span>(ch)] <span class="ot">&lt;-</span> <span class="dv">2</span>  </span>
<span id="cb12-85"><a href="Mortality.html#cb12-85" tabindex="-1"></a>        <span class="co"># Initialize as dead after detected fishing death</span></span>
<span id="cb12-86"><a href="Mortality.html#cb12-86" tabindex="-1"></a>      } <span class="co"># if/else</span></span>
<span id="cb12-87"><a href="Mortality.html#cb12-87" tabindex="-1"></a>} <span class="co"># i</span></span>
<span id="cb12-88"><a href="Mortality.html#cb12-88" tabindex="-1"></a>  <span class="fu">return</span>(ch)</span>
<span id="cb12-89"><a href="Mortality.html#cb12-89" tabindex="-1"></a>} <span class="co"># z.init</span></span>
<span id="cb12-90"><a href="Mortality.html#cb12-90" tabindex="-1"></a></span>
<span id="cb12-91"><a href="Mortality.html#cb12-91" tabindex="-1"></a><span class="co"># Call function to get simulated true (CH.TRUE) and obs (CH) states</span></span>
<span id="cb12-92"><a href="Mortality.html#cb12-92" tabindex="-1"></a>sim <span class="ot">&lt;-</span> <span class="fu">simul.ms</span>(PSI.STATE, PSI.OBS, n.tagged, n.occasions)</span>
<span id="cb12-93"><a href="Mortality.html#cb12-93" tabindex="-1"></a>y <span class="ot">&lt;-</span> sim<span class="sc">$</span>CH</span>
<span id="cb12-94"><a href="Mortality.html#cb12-94" tabindex="-1"></a></span>
<span id="cb12-95"><a href="Mortality.html#cb12-95" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb12-96"><a href="Mortality.html#cb12-96" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;n.occasions&quot;</span>, <span class="st">&quot;n.tagged&quot;</span>, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb12-97"><a href="Mortality.html#cb12-97" tabindex="-1"></a></span>
<span id="cb12-98"><a href="Mortality.html#cb12-98" tabindex="-1"></a><span class="co"># Initial values.</span></span>
<span id="cb12-99"><a href="Mortality.html#cb12-99" tabindex="-1"></a>jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){ <span class="fu">list</span>(<span class="at">z =</span> <span class="fu">z.init</span>(y))}</span>
<span id="cb12-100"><a href="Mortality.html#cb12-100" tabindex="-1"></a></span>
<span id="cb12-101"><a href="Mortality.html#cb12-101" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;Mort_Tel_HRTag.txt&#39;</span></span>
<span id="cb12-102"><a href="Mortality.html#cb12-102" tabindex="-1"></a></span>
<span id="cb12-103"><a href="Mortality.html#cb12-103" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb12-104"><a href="Mortality.html#cb12-104" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;u.est&quot;</span>, <span class="st">&quot;v.est&quot;</span>, <span class="st">&quot;p&quot;</span>)</span>
<span id="cb12-105"><a href="Mortality.html#cb12-105" tabindex="-1"></a></span>
<span id="cb12-106"><a href="Mortality.html#cb12-106" tabindex="-1"></a><span class="co"># Call JAGS from R</span></span>
<span id="cb12-107"><a href="Mortality.html#cb12-107" tabindex="-1"></a>jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb12-108"><a href="Mortality.html#cb12-108" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">5000</span>,</span>
<span id="cb12-109"><a href="Mortality.html#cb12-109" tabindex="-1"></a>                model.file)</span>
<span id="cb12-110"><a href="Mortality.html#cb12-110" tabindex="-1"></a><span class="fu">print</span>(jagsfit)</span>
<span id="cb12-111"><a href="Mortality.html#cb12-111" tabindex="-1"></a><span class="fu">plot</span>(jagsfit)</span></code></pre></div>
<p>The parameters for rates of survival, exploitation and natural death use the same approach as in the above dcat example. The “a” matrix is estimated internally using a vague gamma prior distribution, then the three fractions estimate the probabilities of the three possible true states (survival, harvest, natural death), which sum to 1. The latent true states (z matrix) are estimated in the likelihood section of the code. The dcat (categorical distribution) is used to draw the true state at time t given state at time t-1, as well as the observation at each time given the inferred true state.</p>
<p>One difficult part of fitting this model is obtaining initial values for the latent true states. JAGS will refuse to update model parameters if initial values are inconsistent with the <a href="https://www.vogelwarte.ch/de/projekte/publikationen/bpa/code-for-running-bpa-using-jags">observations</a>. The function used here <code>z.init()</code> initializes all unknown true states to be “alive” unless a harvest occurs. This works because fish not detected could either be alive or a natural death, so “alive” is a valid initial value. Individuals that are ultimately harvested are known to be alive up to the period prior to harvest. It can be instructive to compare the matrices containing true and observed states with the initial values. For example, initial values can be saved by entering z.test &lt;- z.init(y) in the Console. Entering sim$CH.TRUE[1:5,] and CH[1:5,] in the Console will display true and observed states for the first five individuals for comparison to z.test.</p>
<p>Results for the chosen simulation settings are moderately reliable. There are many parameters, as the model estimates true latent states as well as the probabilities for survival, harvest and natural death. It seems to consistently detect the increase in harvest rate in period 3. Uncertainty increases toward the end of the study, especially for probabilities of detection and natural death. This makes sense because fish not detected on the final occasion could either be alive or a natural death.</p>
<p>Perhaps the most obvious simulation settings to vary are the fairly robust sample size of tagged fish (100) and the detection probabilities (0.6 and above). Uncertainty increases markedly as detection probabilities decrease, so these simulations can be very helpful in planning the field study (e.g., number of receiver stations). The number of occasions can also be varied but it requires commensurate changes in the vectors for u, v, and p.</p>
</div>
<div id="exercises-4" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Exercises<a href="Mortality.html#exercises-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>For the exploitation rate study design (Section <a href="Mortality.html#ExpRate">7.1</a>), modify the JAGS code to plot the posterior distribution for the exploitation rate. Include a vertical line showing the underlying true exploitation rate.</p></li>
<li><p>For the completed tagging study design (Section <a href="Mortality.html#Hearn">7.2</a>), modify the code to use a single F parameter (representing an average over periods).</p></li>
<li><p>For the multi-year tagging study (Section <a href="Mortality.html#BrownieFandM">7.3</a>), run three replicate simulations of the version using planted tags, with tag releases of 1000 (current code), 100, and 30. How does uncertainty (e.g. credible interval width) vary? What sample size would you recommend if planning this study? Also, save credible intervals for natural death rate for period 3 (v3) for the 1000 fish releases (for exercise 4 below).</p></li>
<li><p>Compare results for the natural death rate in period 3 (v3) (from exercise 3) with a modified design using five release and return periods. Extend the exploitation (u) and natural death (v) vectors by using the values from periods 1-2 for the final two periods. How do credible intervals for v3 change when the study is extended?</p></li>
<li><p>For the telemetry study (Section <a href="Mortality.html#TelemetryFandM">7.4</a>), compare results (particularly uncertainty) for the natural death rate for period 4 (v4) when the detection probability in period 5 (p5) takes on the following values: 0.2, 0.4, 0.7, 0.9. How might this affect planning for conducting the field work?</p></li>
</ol>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-banner.etal_2020" class="csl-entry">
Banner, Katharine M., Kathryn M. Irvine, and Thomas J. Rodhouse. 2020. <span>“The Use of <span>Bayesian</span> Priors in <span>Ecology</span>: <span>The</span> Good, the Bad and the Not Great.”</span> <em>Methods in Ecology and Evolution</em> 11 (8): 882–89. <a href="https://doi.org/10.1111/2041-210X.13407">https://doi.org/10.1111/2041-210X.13407</a>.
</div>
<div id="ref-bolker2008" class="csl-entry">
Bolker, Benjamin M. 2008. <em>Ecological <span>Models</span> and <span>Data</span> in <span>R</span></em>. 1st ed. Princeton, New Jersey: Princeton University Press.
</div>
<div id="ref-hearn.etal_2003" class="csl-entry">
Hearn, William S., John M. Hoenig, Kenneth H. Pollock, and Daniel A. Hepworth. 2003. <span>“Tag Reporting Rate Estimation: 3. <span>Use</span> of Planted Tags in One Component of a Multiple-Component Fishery.”</span> <em>North American Journal of Fisheries Management</em> 23 (1): 66–77. <a href="https://doi.org/10.1577/1548-8675(2003)023&lt;0066:TRREUO&gt;2.0.CO;2">https://doi.org/10.1577/1548-8675(2003)023&lt;0066:TRREUO&gt;2.0.CO;2</a>.
</div>
<div id="ref-hearn.etal1987" class="csl-entry">
Hearn, William S., Ronald L. Sandland, and John Hampton. 1987. <span>“Robust Estimation of the Natural Mortality Rate in a Completed Tagging Experiment with Variable Fishing Intensity.”</span> <em>ICES Journal of Marine Science</em> 43 (2): 107–17. <a href="https://doi.org/10.1093/icesjms/43.2.107">https://doi.org/10.1093/icesjms/43.2.107</a>.
</div>
<div id="ref-hightower.harris_2017" class="csl-entry">
Hightower, Joseph E., and Julianne E. Harris. 2017. <span>“Estimating Fish Mortality Rates Using Telemetry and Multistate Models.”</span> <em>Fisheries</em> 42 (4): 210–19. <a href="https://doi.org/10.1080/03632415.2017.1276347">https://doi.org/10.1080/03632415.2017.1276347</a>.
</div>
<div id="ref-kéry.schaub_2012" class="csl-entry">
Kéry, Marc, and Michael Schaub. 2012. <em>Bayesian <span>Population Analysis</span> Using <span>WinBUGS</span>: <span>A Hierarchical Perspective</span></em>. 1st ed. Amsterdam: Academic Press.
</div>
<div id="ref-lemoine_2019" class="csl-entry">
Lemoine, Nathan P. 2019. <span>“Moving Beyond Noninformative Priors: Why and How to Choose Weakly Informative Priors in <span>Bayesian</span> Analyses.”</span> <em>Oikos</em> 128 (7): 912–28. <a href="https://doi.org/10.1111/oik.05985">https://doi.org/10.1111/oik.05985</a>.
</div>
<div id="ref-mccarthy_2007" class="csl-entry">
McCarthy, Michael A. 2007. <em>Bayesian <span>Methods</span> for <span>Ecology</span></em>. 1st ed. Cambridge, UK: Cambridge University Press.
</div>
<div id="ref-mccarthy.masters_2005" class="csl-entry">
McCarthy, Michael A., and Pip Masters. 2005. <span>“Profiting from Prior Information in <span>Bayesian</span> Analyses of Ecological Data.”</span> <em>Journal of Applied Ecology</em> 42 (6): 1012–19. <a href="https://doi.org/10.1111/j.1365-2664.2005.01101.x">https://doi.org/10.1111/j.1365-2664.2005.01101.x</a>.
</div>
<div id="ref-pollock.etal_2001" class="csl-entry">
Pollock, Kenneth H., John M. Hoenig, William S. Hearn, and Brian Calingaert. 2001. <span>“Tag Reporting Rate Estimation: 1. <span>An</span> Evaluation of the High-Reward Tagging Method.”</span> <em>North American Journal of Fisheries Management</em> 21 (3): 521–32. <a href="https://doi.org/10.1577/1548-8675(2001)021&lt;0521:TRREAE&gt;2.0.CO;2">https://doi.org/10.1577/1548-8675(2001)021&lt;0521:TRREAE&gt;2.0.CO;2</a>.
</div>
<div id="ref-pollock.pine2007" class="csl-entry">
Pollock, Kenneth, and William Pine. 2007. <span>“The Design and Analysis of Field Studies to Estimate Catch-and-Release Mortality.”</span> <em>Fisheries Management and Ecology</em> 14 (April): 123–30. <a href="https://doi.org/10.1111/j.1365-2400.2007.00532.x">https://doi.org/10.1111/j.1365-2400.2007.00532.x</a>.
</div>
<div id="ref-quinn.deriso_1999" class="csl-entry">
Quinn, Terrance J., and Richard B. Deriso. 1999. <em>Quantitative <span>Fish Dynamics</span></em>. Oxford: Oxford University Press.
</div>
<div id="ref-regehr.etal_2018" class="csl-entry">
Regehr, Eric V., Nathan J. Hostetter, Ryan R. Wilson, Karyn D. Rode, Michelle St Martin, and Sarah J. Converse. 2018. <span>“Integrated Population Modeling Provides the First Empirical Estimates of Vital Rates and Abundance for Polar Bears in the <span>Chukchi Sea</span>.”</span> <em>Scientific Reports</em> 8 (November): 16780. <a href="https://doi.org/10.1038/s41598-018-34824-7">https://doi.org/10.1038/s41598-018-34824-7</a>.
</div>
<div id="ref-ricker1975" class="csl-entry">
Ricker, William Edwin. 1975. <em>Computation and Interpretation of Biological Statistics of Fish Populations</em>. 191. Ottawa: <span>Dept. of Fisheries and Oceans : Minister of Supply and Services Canada</span>.
</div>
<div id="ref-vetter_1988" class="csl-entry">
Vetter, Ef. 1988. <span>“Estimation of Natural Mortality in Fish Stocks - a Review.”</span> <em>Fishery Bulletin</em> 86 (1): 25–43.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Survival.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Growth.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-crc/edit/master/07-MortalityComponents.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown.pdf", "bookdown.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
