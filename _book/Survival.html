<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Survival | A Bayesian Introduction to Fish Population Analysis</title>
  <meta name="description" content="This book is intended to be a bridge between traditional fisheries analytical methods and Bayesian statistics. It is a hands-on introduction to models for estimating abundance, survival, growth, recruitment, and population trends." />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Survival | A Bayesian Introduction to Fish Population Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book is intended to be a bridge between traditional fisheries analytical methods and Bayesian statistics. It is a hands-on introduction to models for estimating abundance, survival, growth, recruitment, and population trends." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Survival | A Bayesian Introduction to Fish Population Analysis" />
  
  <meta name="twitter:description" content="This book is intended to be a bridge between traditional fisheries analytical methods and Bayesian statistics. It is a hands-on introduction to models for estimating abundance, survival, growth, recruitment, and population trends." />
  

<meta name="author" content="Joseph E. Hightower" />


<meta name="date" content="2024-05-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Abundance.html"/>
<link rel="next" href="Mortality.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Joe Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-information-and-conventions"><i class="fa fa-check"></i>Software information and conventions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="R-intro.html"><a href="R-intro.html"><i class="fa fa-check"></i><b>2</b> A Brief Introduction to R and RStudio</a></li>
<li class="chapter" data-level="3" data-path="Distributions.html"><a href="Distributions.html"><i class="fa fa-check"></i><b>3</b> Probability Distributions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Distributions.html"><a href="Distributions.html#Discrete"><i class="fa fa-check"></i><b>3.1</b> Discrete</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="Distributions.html"><a href="Distributions.html#bernoulli"><i class="fa fa-check"></i><b>3.1.1</b> Bernoulli</a></li>
<li class="chapter" data-level="3.1.2" data-path="Distributions.html"><a href="Distributions.html#BinomialDist"><i class="fa fa-check"></i><b>3.1.2</b> Binomial</a></li>
<li class="chapter" data-level="3.1.3" data-path="Distributions.html"><a href="Distributions.html#Multinomial"><i class="fa fa-check"></i><b>3.1.3</b> Multinomial</a></li>
<li class="chapter" data-level="3.1.4" data-path="Distributions.html"><a href="Distributions.html#poisson"><i class="fa fa-check"></i><b>3.1.4</b> Poisson</a></li>
<li class="chapter" data-level="3.1.5" data-path="Distributions.html"><a href="Distributions.html#NegBinom"><i class="fa fa-check"></i><b>3.1.5</b> Negative binomial</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="Distributions.html"><a href="Distributions.html#Continuous"><i class="fa fa-check"></i><b>3.2</b> Continuous</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="Distributions.html"><a href="Distributions.html#Uniform"><i class="fa fa-check"></i><b>3.2.1</b> Uniform</a></li>
<li class="chapter" data-level="3.2.2" data-path="Distributions.html"><a href="Distributions.html#beta"><i class="fa fa-check"></i><b>3.2.2</b> Beta</a></li>
<li class="chapter" data-level="3.2.3" data-path="Distributions.html"><a href="Distributions.html#normal"><i class="fa fa-check"></i><b>3.2.3</b> Normal</a></li>
<li class="chapter" data-level="3.2.4" data-path="Distributions.html"><a href="Distributions.html#lognormal"><i class="fa fa-check"></i><b>3.2.4</b> Lognormal</a></li>
<li class="chapter" data-level="3.2.5" data-path="Distributions.html"><a href="Distributions.html#gamma"><i class="fa fa-check"></i><b>3.2.5</b> Gamma</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="Distributions.html"><a href="Distributions.html#exercises"><i class="fa fa-check"></i><b>3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Model-fit.html"><a href="Model-fit.html"><i class="fa fa-check"></i><b>4</b> Model Fitting</a>
<ul>
<li class="chapter" data-level="4.1" data-path="Model-fit.html"><a href="Model-fit.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="Model-fit.html"><a href="Model-fit.html#Model-fit-sim"><i class="fa fa-check"></i><b>4.2</b> Using simulation</a></li>
<li class="chapter" data-level="4.3" data-path="Model-fit.html"><a href="Model-fit.html#JAGS-model-fit"><i class="fa fa-check"></i><b>4.3</b> Using Bayesian methods</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="Model-fit.html"><a href="Model-fit.html#Debug"><i class="fa fa-check"></i><b>4.3.1</b> Debugging code</a></li>
<li class="chapter" data-level="4.3.2" data-path="Model-fit.html"><a href="Model-fit.html#Convergence"><i class="fa fa-check"></i><b>4.3.2</b> Judging convergence</a></li>
<li class="chapter" data-level="4.3.3" data-path="Model-fit.html"><a href="Model-fit.html#Likelihood"><i class="fa fa-check"></i><b>4.3.3</b> What is a likelihood?</a></li>
<li class="chapter" data-level="4.3.4" data-path="Model-fit.html"><a href="Model-fit.html#Deviance"><i class="fa fa-check"></i><b>4.3.4</b> Deviance as a measure of model fit</a></li>
<li class="chapter" data-level="4.3.5" data-path="Model-fit.html"><a href="Model-fit.html#Model-checking"><i class="fa fa-check"></i><b>4.3.5</b> Model checking</a></li>
<li class="chapter" data-level="4.3.6" data-path="Model-fit.html"><a href="Model-fit.html#Model-selection"><i class="fa fa-check"></i><b>4.3.6</b> Model selection</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="Model-fit.html"><a href="Model-fit.html#exercises-1"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Abundance.html"><a href="Abundance.html"><i class="fa fa-check"></i><b>5</b> Abundance</a>
<ul>
<li class="chapter" data-level="5.1" data-path="Abundance.html"><a href="Abundance.html#removal"><i class="fa fa-check"></i><b>5.1</b> Removal</a></li>
<li class="chapter" data-level="5.2" data-path="Abundance.html"><a href="Abundance.html#mark-recapture"><i class="fa fa-check"></i><b>5.2</b> Mark-recapture</a></li>
<li class="chapter" data-level="5.3" data-path="Abundance.html"><a href="Abundance.html#binomial-mixture"><i class="fa fa-check"></i><b>5.3</b> Binomial-mixture</a></li>
<li class="chapter" data-level="5.4" data-path="Abundance.html"><a href="Abundance.html#exercises-2"><i class="fa fa-check"></i><b>5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Survival.html"><a href="Survival.html"><i class="fa fa-check"></i><b>6</b> Survival</a>
<ul>
<li class="chapter" data-level="6.1" data-path="Survival.html"><a href="Survival.html#AgeComp"><i class="fa fa-check"></i><b>6.1</b> Age-composition</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="Survival.html"><a href="Survival.html#CC_Selectivity"><i class="fa fa-check"></i><b>6.1.1</b> Accounting For Gear Selectivity</a></li>
<li class="chapter" data-level="6.1.2" data-path="Survival.html"><a href="Survival.html#Cohort"><i class="fa fa-check"></i><b>6.1.2</b> Cohort model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="Survival.html"><a href="Survival.html#TelemetryBased"><i class="fa fa-check"></i><b>6.2</b> Telemetry-based</a></li>
<li class="chapter" data-level="6.3" data-path="Survival.html"><a href="Survival.html#BrownieSurvival"><i class="fa fa-check"></i><b>6.3</b> Tag-based</a></li>
<li class="chapter" data-level="6.4" data-path="Survival.html"><a href="Survival.html#exercises-3"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Mortality.html"><a href="Mortality.html"><i class="fa fa-check"></i><b>7</b> Mortality Components</a>
<ul>
<li class="chapter" data-level="7.1" data-path="Mortality.html"><a href="Mortality.html#ExpRate"><i class="fa fa-check"></i><b>7.1</b> Exploitation rate</a></li>
<li class="chapter" data-level="7.2" data-path="Mortality.html"><a href="Mortality.html#Hearn"><i class="fa fa-check"></i><b>7.2</b> Completed tagging study</a></li>
<li class="chapter" data-level="7.3" data-path="Mortality.html"><a href="Mortality.html#BrownieFandM"><i class="fa fa-check"></i><b>7.3</b> Multi-year tagging study</a></li>
<li class="chapter" data-level="7.4" data-path="Mortality.html"><a href="Mortality.html#TelemetryFandM"><i class="fa fa-check"></i><b>7.4</b> Telemetry estimates of F and M</a></li>
<li class="chapter" data-level="7.5" data-path="Mortality.html"><a href="Mortality.html#exercises-4"><i class="fa fa-check"></i><b>7.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Growth.html"><a href="Growth.html"><i class="fa fa-check"></i><b>8</b> Growth</a>
<ul>
<li class="chapter" data-level="8.1" data-path="Growth.html"><a href="Growth.html#vonBert"><i class="fa fa-check"></i><b>8.1</b> Growth in length</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="Growth.html"><a href="Growth.html#Otolith"><i class="fa fa-check"></i><b>8.1.1</b> Age-length</a></li>
<li class="chapter" data-level="8.1.2" data-path="Growth.html"><a href="Growth.html#GrowthInc"><i class="fa fa-check"></i><b>8.1.2</b> Using tagging data</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="Growth.html"><a href="Growth.html#LnWgt"><i class="fa fa-check"></i><b>8.2</b> Growth in weight</a></li>
<li class="chapter" data-level="8.3" data-path="Growth.html"><a href="Growth.html#exercises-5"><i class="fa fa-check"></i><b>8.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Trend.html"><a href="Trend.html"><i class="fa fa-check"></i><b>9</b> Abundance trends</a>
<ul>
<li class="chapter" data-level="9.1" data-path="Trend.html"><a href="Trend.html#Linear"><i class="fa fa-check"></i><b>9.1</b> Linear model</a></li>
<li class="chapter" data-level="9.2" data-path="Trend.html"><a href="Trend.html#ExpGr"><i class="fa fa-check"></i><b>9.2</b> Exponential growth model</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="Trend.html"><a href="Trend.html#Forecast"><i class="fa fa-check"></i><b>9.2.1</b> Forecasting</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="Trend.html"><a href="Trend.html#exercises-6"><i class="fa fa-check"></i><b>9.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Recruit.html"><a href="Recruit.html"><i class="fa fa-check"></i><b>10</b> Recruitment</a>
<ul>
<li class="chapter" data-level="10.1" data-path="Recruit.html"><a href="Recruit.html#Recruit-Fit"><i class="fa fa-check"></i><b>10.1</b> Fitting a stock-recruitment curve</a></li>
<li class="chapter" data-level="10.2" data-path="Recruit.html"><a href="Recruit.html#Recruit-DIC"><i class="fa fa-check"></i><b>10.2</b> Does spawning stock size affect recruitment?</a></li>
<li class="chapter" data-level="10.3" data-path="Recruit.html"><a href="Recruit.html#exercises-7"><i class="fa fa-check"></i><b>10.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="PopModels.html"><a href="PopModels.html"><i class="fa fa-check"></i><b>11</b> Integrated Population Models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="PopModels.html"><a href="PopModels.html#exercises-8"><i class="fa fa-check"></i><b>11.1</b> Exercises</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="title-placeholder.html"><a href="title-placeholder.html"><i class="fa fa-check"></i><b>A</b> Title Placeholder</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Bayesian Introduction to Fish Population Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Survival" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Survival<a href="Survival.html#Survival" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Information about survival rate is valuable for managing exploited stocks and working to rebuild rare or declining populations. Survival is affected by two broad categories of threats: fishing and natural mortality. Fishing obviously refers to harvest, from commercial or recreational sectors, but could include mortality associated with fish that are caught and released. Catch-and-release fishing primarily occurs in the recreational sector, but can occur in the commercial sector due to regulations or lack of markets (sometimes referred to as discard). Natural mortality is a generic term for mortality sources other than fishing. There is typically a strong negative correlation between natural mortality rate and body size, indicating the predominant role of predation <span class="citation">(<a href="#ref-lorenzen1996">Lorenzen 1996</a>)</span>. Other sources of natural mortality include starvation, disease and senescence. It is important as a first step to estimate overall survival reliably, but management can be improved by partitioning total mortality into fishing and natural component rates. We begin with approaches for estimating overall survival, then in Chapter <a href="Mortality.html#Mortality">7</a> consider tagging and telemetry methods that provide insights about sources of mortality.</p>
<div id="AgeComp" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Age-composition<a href="Survival.html#AgeComp" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The simplest approach for estimating survival is to examine the age composition of a sample of fish. Age would typically be determined through laboratory work using otoliths or other hard parts that show annual patterns <span class="citation">(<a href="#ref-campana2001">Campana 2001</a>)</span>. This approach is usually applied to adult fish that would be expected to have similar survival rates. We begin with simulation code for generating the age distribution:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="Survival.html#cb1-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb1-2"><a href="Survival.html#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="Survival.html#cb1-3" tabindex="-1"></a><span class="co"># Simulate age composition sampling</span></span>
<span id="cb1-4"><a href="Survival.html#cb1-4" tabindex="-1"></a>MaxAge <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb1-5"><a href="Survival.html#cb1-5" tabindex="-1"></a>S.true <span class="ot">&lt;-</span> <span class="fl">0.7</span> <span class="co"># Annual survival probability</span></span>
<span id="cb1-6"><a href="Survival.html#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="Survival.html#cb1-7" tabindex="-1"></a><span class="co"># Simulated age vector at equilibrium (expected values)</span></span>
<span id="cb1-8"><a href="Survival.html#cb1-8" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span>MaxAge)</span>
<span id="cb1-9"><a href="Survival.html#cb1-9" tabindex="-1"></a>N[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1-10"><a href="Survival.html#cb1-10" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(MaxAge)){</span>
<span id="cb1-11"><a href="Survival.html#cb1-11" tabindex="-1"></a>  N[j] <span class="ot">&lt;-</span> N[j<span class="dv">-1</span>] <span class="sc">*</span> S.true</span>
<span id="cb1-12"><a href="Survival.html#cb1-12" tabindex="-1"></a>} <span class="co">#j</span></span>
<span id="cb1-13"><a href="Survival.html#cb1-13" tabindex="-1"></a>age.vec <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,MaxAge, <span class="at">by=</span><span class="dv">1</span>)  <span class="co"># Sequence function: x axis values for plot</span></span>
<span id="cb1-14"><a href="Survival.html#cb1-14" tabindex="-1"></a><span class="fu">barplot</span>(N, <span class="at">names.arg=</span>age.vec, <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Number&quot;</span>)</span>
<span id="cb1-15"><a href="Survival.html#cb1-15" tabindex="-1"></a></span>
<span id="cb1-16"><a href="Survival.html#cb1-16" tabindex="-1"></a>SampleSize <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb1-17"><a href="Survival.html#cb1-17" tabindex="-1"></a>AgeMatrix <span class="ot">&lt;-</span> <span class="fu">rmultinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">size=</span>SampleSize, <span class="at">prob=</span>N)</span>
<span id="cb1-18"><a href="Survival.html#cb1-18" tabindex="-1"></a><span class="co"># Note: prob vector rescaled internally</span></span>
<span id="cb1-19"><a href="Survival.html#cb1-19" tabindex="-1"></a>AgeSample <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">t</span>(AgeMatrix)) <span class="co"># Transpose matrix then convert to vector</span></span>
<span id="cb1-20"><a href="Survival.html#cb1-20" tabindex="-1"></a><span class="fu">barplot</span>(AgeSample, <span class="at">names.arg=</span>age.vec, <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Frequency&quot;</span>)</span></code></pre></div>
<p>The simulation tracks fish up to age 10 (maximum age tracked, not lifespan) with an arbitrary annual survival rate of 0.7. The looping code for age composition starts with 1000 fish at age 1 and reduces that number at each successive age by the annual survival rate. This creates an equilibrium age vector, based on assumptions of constant recruitment (1000 each year) and survival. For example, the 700 age-2 fish would have been the survivors from the previous year’s 1000 age-1 recruits. The initial number is arbitrary; the shape of the distribution and age proportions would be the same if we began with 1 or 1000 fish. The next section of code uses the equilibrium age vector as proportions and draws a sample of size 30 using a multinomial distribution (Section <a href="Distributions.html#Multinomial">3.1.3</a>). To build some intuition about age sampling, try running the simulation code multiple times with different values for sample size, maximum age, and survival rate. As usual, keep in mind that this is a very optimistic scenario, with constant recruitment and survival and unbiased survey sampling. The only variation reflected in these samples is due to sampling from the multinomial distribution (as is evident if a large age sample is drawn).</p>
<p>The JAGS code for analysis is straightforward and mirrors the simulation code. Note that the equilibrium age vector used as proportions in the <code>dmulti()</code> function must be rescaled manually to sum to 1. Convergence is fast and the estimate of survival rate is moderately precise, despite the small (but perfectly unbiased) sample. For example, the 95% credible interval for one run was 0.57-0.80. The final two lines of R code show the posterior distribution for survival rate, compared to the true value.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="Survival.html#cb2-1" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb2-2"><a href="Survival.html#cb2-2" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb2-3"><a href="Survival.html#cb2-3" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb2-4"><a href="Survival.html#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="Survival.html#cb2-5" tabindex="-1"></a><span class="co"># JAGS code</span></span>
<span id="cb2-6"><a href="Survival.html#cb2-6" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;AgeComp.txt&quot;</span>)</span>
<span id="cb2-7"><a href="Survival.html#cb2-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb2-8"><a href="Survival.html#cb2-8" tabindex="-1"></a><span class="st">model{</span></span>
<span id="cb2-9"><a href="Survival.html#cb2-9" tabindex="-1"></a><span class="st">    # Priors</span></span>
<span id="cb2-10"><a href="Survival.html#cb2-10" tabindex="-1"></a><span class="st">    S.est ~ dunif(0,1)  # Constant survival over sampled age range</span></span>
<span id="cb2-11"><a href="Survival.html#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="Survival.html#cb2-12" tabindex="-1"></a><span class="st">    N[1] &lt;- 1000</span></span>
<span id="cb2-13"><a href="Survival.html#cb2-13" tabindex="-1"></a><span class="st">    # Generate equilibrium age proportions</span></span>
<span id="cb2-14"><a href="Survival.html#cb2-14" tabindex="-1"></a><span class="st">    for (j in 2:MaxAge){</span></span>
<span id="cb2-15"><a href="Survival.html#cb2-15" tabindex="-1"></a><span class="st">      N[j] &lt;- N[j-1]*S.est</span></span>
<span id="cb2-16"><a href="Survival.html#cb2-16" tabindex="-1"></a><span class="st">    } # j</span></span>
<span id="cb2-17"><a href="Survival.html#cb2-17" tabindex="-1"></a><span class="st">    N.sum &lt;- sum(N[]) # Rescale so that proportions sum to 1</span></span>
<span id="cb2-18"><a href="Survival.html#cb2-18" tabindex="-1"></a><span class="st">    for (j in 1:MaxAge){</span></span>
<span id="cb2-19"><a href="Survival.html#cb2-19" tabindex="-1"></a><span class="st">    p[j] &lt;- N[j]/N.sum</span></span>
<span id="cb2-20"><a href="Survival.html#cb2-20" tabindex="-1"></a><span class="st">    } #j</span></span>
<span id="cb2-21"><a href="Survival.html#cb2-21" tabindex="-1"></a><span class="st">    # Likelihood</span></span>
<span id="cb2-22"><a href="Survival.html#cb2-22" tabindex="-1"></a><span class="st">    AgeSample[] ~ dmulti(p[], SampleSize)</span></span>
<span id="cb2-23"><a href="Survival.html#cb2-23" tabindex="-1"></a><span class="st">    # Fit multinomial distribution based on constant survival</span></span>
<span id="cb2-24"><a href="Survival.html#cb2-24" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb2-25"><a href="Survival.html#cb2-25" tabindex="-1"></a><span class="st">    &quot;</span>,<span class="at">fill=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-26"><a href="Survival.html#cb2-26" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb2-27"><a href="Survival.html#cb2-27" tabindex="-1"></a></span>
<span id="cb2-28"><a href="Survival.html#cb2-28" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb2-29"><a href="Survival.html#cb2-29" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;AgeSample&quot;</span>, <span class="st">&quot;SampleSize&quot;</span>, <span class="st">&quot;MaxAge&quot;</span>)</span>
<span id="cb2-30"><a href="Survival.html#cb2-30" tabindex="-1"></a></span>
<span id="cb2-31"><a href="Survival.html#cb2-31" tabindex="-1"></a><span class="co"># Initial values</span></span>
<span id="cb2-32"><a href="Survival.html#cb2-32" tabindex="-1"></a>jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){ <span class="fu">list</span>(<span class="at">S.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">1</span>))}</span>
<span id="cb2-33"><a href="Survival.html#cb2-33" tabindex="-1"></a></span>
<span id="cb2-34"><a href="Survival.html#cb2-34" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;AgeComp.txt&#39;</span></span>
<span id="cb2-35"><a href="Survival.html#cb2-35" tabindex="-1"></a></span>
<span id="cb2-36"><a href="Survival.html#cb2-36" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb2-37"><a href="Survival.html#cb2-37" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;S.est&quot;</span>)</span>
<span id="cb2-38"><a href="Survival.html#cb2-38" tabindex="-1"></a></span>
<span id="cb2-39"><a href="Survival.html#cb2-39" tabindex="-1"></a><span class="co"># Call JAGS from R</span></span>
<span id="cb2-40"><a href="Survival.html#cb2-40" tabindex="-1"></a>jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb2-41"><a href="Survival.html#cb2-41" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">4000</span>, <span class="at">n.burnin=</span><span class="dv">2000</span>,</span>
<span id="cb2-42"><a href="Survival.html#cb2-42" tabindex="-1"></a>                model.file)</span>
<span id="cb2-43"><a href="Survival.html#cb2-43" tabindex="-1"></a><span class="fu">print</span>(jagsfit)</span>
<span id="cb2-44"><a href="Survival.html#cb2-44" tabindex="-1"></a><span class="fu">plot</span>(jagsfit)</span>
<span id="cb2-45"><a href="Survival.html#cb2-45" tabindex="-1"></a></span>
<span id="cb2-46"><a href="Survival.html#cb2-46" tabindex="-1"></a><span class="co"># Look at posterior distribution versus true value</span></span>
<span id="cb2-47"><a href="Survival.html#cb2-47" tabindex="-1"></a><span class="fu">hist</span>(jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.list<span class="sc">$</span>S.est, </span>
<span id="cb2-48"><a href="Survival.html#cb2-48" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Estimated survival rate&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb2-49"><a href="Survival.html#cb2-49" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>S.true, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p>Note that we are not estimating the age proportions as parameters but rather the single parameter for survival rate (which is used to predict the equilibrium age proportions). Thus the number of effective parameters (pD) should be close to one. A few lines of code can be added to compare the predicted and observed age distributions:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="Survival.html#cb3-1" tabindex="-1"></a><span class="co"># Add code to compare observed and predicted age comp</span></span>
<span id="cb3-2"><a href="Survival.html#cb3-2" tabindex="-1"></a>N.hat <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span>MaxAge)</span>
<span id="cb3-3"><a href="Survival.html#cb3-3" tabindex="-1"></a>N.hat[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb3-4"><a href="Survival.html#cb3-4" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(MaxAge)){</span>
<span id="cb3-5"><a href="Survival.html#cb3-5" tabindex="-1"></a>  N.hat[j] <span class="ot">&lt;-</span> N.hat[j<span class="dv">-1</span>] <span class="sc">*</span> jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>median<span class="sc">$</span>S.est</span>
<span id="cb3-6"><a href="Survival.html#cb3-6" tabindex="-1"></a>} <span class="co">#j</span></span>
<span id="cb3-7"><a href="Survival.html#cb3-7" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb3-8"><a href="Survival.html#cb3-8" tabindex="-1"></a><span class="fu">barplot</span>(AgeSample, <span class="at">names.arg=</span>age.vec, <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, </span>
<span id="cb3-9"><a href="Survival.html#cb3-9" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Number&quot;</span>, <span class="at">main=</span><span class="st">&quot;Observed&quot;</span>)</span>
<span id="cb3-10"><a href="Survival.html#cb3-10" tabindex="-1"></a><span class="fu">barplot</span>(N.hat, <span class="at">names.arg=</span>age.vec, <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, </span>
<span id="cb3-11"><a href="Survival.html#cb3-11" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Number&quot;</span>, <span class="at">main=</span><span class="st">&quot;Predicted&quot;</span>)</span>
<span id="cb3-12"><a href="Survival.html#cb3-12" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co"># Reset plot window</span></span></code></pre></div>
<p>The predicted age distribution looks like a smoothed version of the observed, which makes sense given that we are estimating average survival over the sampled range of ages. When a poor estimate of the survival rate occurs, you will likely notice an odd pattern in the simulated age composition sample. Try running the code several times, starting from where the random age sample is drawn. Increasing the sample size will bring the observed pattern closer to the equilibrium age composition.</p>
<p>Thus far, we have used small sample sizes for these simulated studies. They are sufficient here because the simulation only includes variation due to sampling from the multinomial distribution. It is also convenient to work with a small sample size when studying the code and simulation data. Sample sizes are sometimes small in field studies, and it is important to establish that a study design will provide reliable results when using an achievable sample size. But it can also be informative to test the analytical approach with a very large sample size. This provides a best-case scenario for study results, and ensures that estimates approach the true values (are essentially unbiased). For example, three replicate median estimates of the survival rate were 0.71, 0.69, and 0.70 for a sample size of 2000 fish.</p>
<div id="CC_Selectivity" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Accounting For Gear Selectivity<a href="Survival.html#CC_Selectivity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The traditional approach for estimating survival from age composition data was known as catch curve analysis. It could be done using linear regression (thus doable by hand in the pre-computer era) by log-transforming the age sample <span class="citation">(<a href="#ref-ricker1975">Ricker 1975</a>)</span>. Gear selectivity was addressed subjectively, by viewing a plot of the log-transformed catches. <span class="citation">Ricker (<a href="#ref-ricker1975">1975</a>)</span> described the catch curve pattern as having ascending and descending limbs, with the ascending limb assumed to reflect selectivity and survival. The descending limb was assumed to reflect only survival (age range of “fully selected” fish). The recommended approach was to begin the catch curve analysis at the age of peak catch or the next oldest age, in order to limit the analysis to fully selected fish. For catch curve analysis or the approach given here, declining selectivity for older fish would cause the survival estimator to be biased.</p>
<p>Given sufficient data, it is possible to use age composition data to estimate jointly the survival rate and gear selectivity. A practical example might be a trawl survey where small (younger) fish are not retained by the net. Fish larger than the net mesh size might be assumed to be fully selected, so a logistic function could be used to model gear selectivity that increases up an asymptote: <span class="math inline">\(S_{a} = \frac{1}{1+e^{k*(a-a_{0})}}\)</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="Survival.html#cb4-1" tabindex="-1"></a><span class="co"># Add in selectivity</span></span>
<span id="cb4-2"><a href="Survival.html#cb4-2" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Slope for logistic function</span></span>
<span id="cb4-3"><a href="Survival.html#cb4-3" tabindex="-1"></a>a_50 <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># Age at 0.5 selectivity</span></span>
<span id="cb4-4"><a href="Survival.html#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="Survival.html#cb4-5" tabindex="-1"></a><span class="co"># Age selectivity</span></span>
<span id="cb4-6"><a href="Survival.html#cb4-6" tabindex="-1"></a>Sel <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span>MaxAge)</span>
<span id="cb4-7"><a href="Survival.html#cb4-7" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(MaxAge)){</span>
<span id="cb4-8"><a href="Survival.html#cb4-8" tabindex="-1"></a>  Sel[j] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>k<span class="sc">*</span>(j<span class="sc">-</span>a_50)))</span>
<span id="cb4-9"><a href="Survival.html#cb4-9" tabindex="-1"></a>} <span class="co">#j</span></span>
<span id="cb4-10"><a href="Survival.html#cb4-10" tabindex="-1"></a>age.vec <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,MaxAge, <span class="at">by=</span><span class="dv">1</span>)  <span class="co"># Sequence function: x axis values for plot</span></span>
<span id="cb4-11"><a href="Survival.html#cb4-11" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb4-12"><a href="Survival.html#cb4-12" tabindex="-1"></a><span class="fu">plot</span>(age.vec, Sel, <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Gear selectivity&quot;</span>)</span></code></pre></div>
<p>Values for the slope (k) and age at 50% selectivity (a<sub>0.50</sub>) are arbitrary, but chosen to increase to a well-defined asymptote before age 10. Try different values for the slope and a<sub>0.50</sub> to understand how the two parameters affect the shape of the curve. Note that any analysis of gear selectivity will only be successful if all ages share the survival rate and there is a sufficient age range to fully characterize the asymptote. For example, imagine the outcome of an analysis using data only for ages 1-5.</p>
<p>Now let’s extend the age composition simulation to include less than fully selected fish:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="Survival.html#cb5-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb5-2"><a href="Survival.html#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="Survival.html#cb5-3" tabindex="-1"></a><span class="co"># Simulate age composition sampling with age-specific selectivity</span></span>
<span id="cb5-4"><a href="Survival.html#cb5-4" tabindex="-1"></a>MaxAge <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb5-5"><a href="Survival.html#cb5-5" tabindex="-1"></a>S.true <span class="ot">&lt;-</span> <span class="fl">0.7</span> <span class="co"># Annual survival probability</span></span>
<span id="cb5-6"><a href="Survival.html#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="Survival.html#cb5-7" tabindex="-1"></a><span class="co"># Parameters for selectivity curve</span></span>
<span id="cb5-8"><a href="Survival.html#cb5-8" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Slope for logistic function</span></span>
<span id="cb5-9"><a href="Survival.html#cb5-9" tabindex="-1"></a>a_50 <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># Age at 0.5 selectivity</span></span>
<span id="cb5-10"><a href="Survival.html#cb5-10" tabindex="-1"></a></span>
<span id="cb5-11"><a href="Survival.html#cb5-11" tabindex="-1"></a><span class="co"># Age selectivity</span></span>
<span id="cb5-12"><a href="Survival.html#cb5-12" tabindex="-1"></a>Sel <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span>MaxAge)</span>
<span id="cb5-13"><a href="Survival.html#cb5-13" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(MaxAge)){</span>
<span id="cb5-14"><a href="Survival.html#cb5-14" tabindex="-1"></a>  Sel[j] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>k<span class="sc">*</span>(j<span class="sc">-</span>a_50)))</span>
<span id="cb5-15"><a href="Survival.html#cb5-15" tabindex="-1"></a>} <span class="co">#j</span></span>
<span id="cb5-16"><a href="Survival.html#cb5-16" tabindex="-1"></a>age.vec <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,MaxAge, <span class="at">by=</span><span class="dv">1</span>)  <span class="co"># Sequence function: x axis values for plot</span></span>
<span id="cb5-17"><a href="Survival.html#cb5-17" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb5-18"><a href="Survival.html#cb5-18" tabindex="-1"></a><span class="fu">plot</span>(age.vec, Sel, <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Gear selectivity&quot;</span>)</span>
<span id="cb5-19"><a href="Survival.html#cb5-19" tabindex="-1"></a></span>
<span id="cb5-20"><a href="Survival.html#cb5-20" tabindex="-1"></a><span class="co"># Simulated age vector, including gear selectivity</span></span>
<span id="cb5-21"><a href="Survival.html#cb5-21" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span>MaxAge)</span>
<span id="cb5-22"><a href="Survival.html#cb5-22" tabindex="-1"></a>N[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb5-23"><a href="Survival.html#cb5-23" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(MaxAge)){</span>
<span id="cb5-24"><a href="Survival.html#cb5-24" tabindex="-1"></a>  N[j] <span class="ot">&lt;-</span> N[j<span class="dv">-1</span>] <span class="sc">*</span> S.true</span>
<span id="cb5-25"><a href="Survival.html#cb5-25" tabindex="-1"></a>} <span class="co">#j</span></span>
<span id="cb5-26"><a href="Survival.html#cb5-26" tabindex="-1"></a>N_Sel <span class="ot">&lt;-</span> N <span class="sc">*</span> Sel</span>
<span id="cb5-27"><a href="Survival.html#cb5-27" tabindex="-1"></a>age.vec <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,MaxAge, <span class="at">by=</span><span class="dv">1</span>)  <span class="co"># Sequence function: x axis values for plot</span></span>
<span id="cb5-28"><a href="Survival.html#cb5-28" tabindex="-1"></a><span class="fu">barplot</span>(N_Sel, <span class="at">names.arg=</span>age.vec, <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Number&quot;</span>, </span>
<span id="cb5-29"><a href="Survival.html#cb5-29" tabindex="-1"></a>        <span class="at">main=</span><span class="st">&quot;Expected age distribution&quot;</span>)</span>
<span id="cb5-30"><a href="Survival.html#cb5-30" tabindex="-1"></a></span>
<span id="cb5-31"><a href="Survival.html#cb5-31" tabindex="-1"></a>SampleSize <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb5-32"><a href="Survival.html#cb5-32" tabindex="-1"></a>AgeMatrix <span class="ot">&lt;-</span> <span class="fu">rmultinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">size=</span>SampleSize, <span class="at">prob=</span>N_Sel)</span>
<span id="cb5-33"><a href="Survival.html#cb5-33" tabindex="-1"></a>  <span class="co"># Note: prob vector rescaled internally</span></span>
<span id="cb5-34"><a href="Survival.html#cb5-34" tabindex="-1"></a>AgeSample <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">t</span>(AgeMatrix)) <span class="co"># Transpose matrix then convert to vector</span></span>
<span id="cb5-35"><a href="Survival.html#cb5-35" tabindex="-1"></a><span class="fu">barplot</span>(AgeSample, <span class="at">names.arg=</span>age.vec, <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, </span>
<span id="cb5-36"><a href="Survival.html#cb5-36" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">&quot;Frequency&quot;</span>, <span class="at">main=</span><span class="st">&quot;Sample age distribution&quot;</span>)</span></code></pre></div>
<p>The sample age distribution now reflects both gear selectivity and survival. We use a relatively large sample size and test whether it is possible to estimate all three parameters (survival rate and two parameters for selectivity):</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="Survival.html#cb6-1" tabindex="-1"></a><span class="co"># JAGS analysis</span></span>
<span id="cb6-2"><a href="Survival.html#cb6-2" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb6-3"><a href="Survival.html#cb6-3" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb6-4"><a href="Survival.html#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="Survival.html#cb6-5" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;AgeComp.txt&quot;</span>)</span>
<span id="cb6-6"><a href="Survival.html#cb6-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb6-7"><a href="Survival.html#cb6-7" tabindex="-1"></a><span class="st">model{</span></span>
<span id="cb6-8"><a href="Survival.html#cb6-8" tabindex="-1"></a><span class="st">    # Priors</span></span>
<span id="cb6-9"><a href="Survival.html#cb6-9" tabindex="-1"></a><span class="st">    S.est ~ dunif(0,1)  # Constant survival over sampled age range</span></span>
<span id="cb6-10"><a href="Survival.html#cb6-10" tabindex="-1"></a><span class="st">    a50.est ~ dunif(0, MaxAge)</span></span>
<span id="cb6-11"><a href="Survival.html#cb6-11" tabindex="-1"></a><span class="st">    k.est ~ dlnorm(0, 1E-6) # Slope &gt; 0 for increasing selectivity</span></span>
<span id="cb6-12"><a href="Survival.html#cb6-12" tabindex="-1"></a></span>
<span id="cb6-13"><a href="Survival.html#cb6-13" tabindex="-1"></a><span class="st">    N[1] &lt;- 1000</span></span>
<span id="cb6-14"><a href="Survival.html#cb6-14" tabindex="-1"></a><span class="st">    # Generate equilibrium age proportions</span></span>
<span id="cb6-15"><a href="Survival.html#cb6-15" tabindex="-1"></a><span class="st">    for (j in 2:MaxAge){</span></span>
<span id="cb6-16"><a href="Survival.html#cb6-16" tabindex="-1"></a><span class="st">      N[j] &lt;- N[j-1]*S.est</span></span>
<span id="cb6-17"><a href="Survival.html#cb6-17" tabindex="-1"></a><span class="st">    } # j</span></span>
<span id="cb6-18"><a href="Survival.html#cb6-18" tabindex="-1"></a><span class="st">    for (j in 1:MaxAge){</span></span>
<span id="cb6-19"><a href="Survival.html#cb6-19" tabindex="-1"></a><span class="st">    Sel[j] &lt;- 1/(1+exp(-k.est*(j-a50.est)))</span></span>
<span id="cb6-20"><a href="Survival.html#cb6-20" tabindex="-1"></a><span class="st">     N.Sel[j] &lt;- N[j] * Sel[j]</span></span>
<span id="cb6-21"><a href="Survival.html#cb6-21" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb6-22"><a href="Survival.html#cb6-22" tabindex="-1"></a><span class="st">    N.sum &lt;- sum(N.Sel[]) # Rescale so that proportions sum to 1</span></span>
<span id="cb6-23"><a href="Survival.html#cb6-23" tabindex="-1"></a><span class="st">    for (j in 1:MaxAge){</span></span>
<span id="cb6-24"><a href="Survival.html#cb6-24" tabindex="-1"></a><span class="st">    p[j] &lt;- N.Sel[j]/N.sum</span></span>
<span id="cb6-25"><a href="Survival.html#cb6-25" tabindex="-1"></a><span class="st">    } #j</span></span>
<span id="cb6-26"><a href="Survival.html#cb6-26" tabindex="-1"></a><span class="st">    # Likelihood</span></span>
<span id="cb6-27"><a href="Survival.html#cb6-27" tabindex="-1"></a><span class="st">    AgeSample[] ~ dmulti(p[], SampleSize)  </span></span>
<span id="cb6-28"><a href="Survival.html#cb6-28" tabindex="-1"></a><span class="st">    # Fit multinomial distribution based on constant survival</span></span>
<span id="cb6-29"><a href="Survival.html#cb6-29" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb6-30"><a href="Survival.html#cb6-30" tabindex="-1"></a><span class="st">    &quot;</span>,<span class="at">fill=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-31"><a href="Survival.html#cb6-31" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb6-32"><a href="Survival.html#cb6-32" tabindex="-1"></a></span>
<span id="cb6-33"><a href="Survival.html#cb6-33" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb6-34"><a href="Survival.html#cb6-34" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;AgeSample&quot;</span>, <span class="st">&quot;SampleSize&quot;</span>, <span class="st">&quot;MaxAge&quot;</span>)</span>
<span id="cb6-35"><a href="Survival.html#cb6-35" tabindex="-1"></a></span>
<span id="cb6-36"><a href="Survival.html#cb6-36" tabindex="-1"></a><span class="co"># Initial values</span></span>
<span id="cb6-37"><a href="Survival.html#cb6-37" tabindex="-1"></a>jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){ <span class="fu">list</span>(<span class="at">S.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">1</span>),</span>
<span id="cb6-38"><a href="Survival.html#cb6-38" tabindex="-1"></a>                               <span class="at">a50.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span>MaxAge),</span>
<span id="cb6-39"><a href="Survival.html#cb6-39" tabindex="-1"></a>                               <span class="at">k.est=</span><span class="fu">rlnorm</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">meanlog=</span><span class="dv">0</span>, <span class="at">sdlog=</span><span class="dv">1</span>))}</span>
<span id="cb6-40"><a href="Survival.html#cb6-40" tabindex="-1"></a>                               <span class="co"># Arbitrary low initial values for k.est</span></span>
<span id="cb6-41"><a href="Survival.html#cb6-41" tabindex="-1"></a></span>
<span id="cb6-42"><a href="Survival.html#cb6-42" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;AgeComp.txt&#39;</span></span>
<span id="cb6-43"><a href="Survival.html#cb6-43" tabindex="-1"></a></span>
<span id="cb6-44"><a href="Survival.html#cb6-44" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb6-45"><a href="Survival.html#cb6-45" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;S.est&quot;</span>, <span class="st">&quot;a50.est&quot;</span>, <span class="st">&quot;k.est&quot;</span>)</span>
<span id="cb6-46"><a href="Survival.html#cb6-46" tabindex="-1"></a></span>
<span id="cb6-47"><a href="Survival.html#cb6-47" tabindex="-1"></a><span class="co"># Call JAGS from R</span></span>
<span id="cb6-48"><a href="Survival.html#cb6-48" tabindex="-1"></a>jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb6-49"><a href="Survival.html#cb6-49" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">20000</span>,</span>
<span id="cb6-50"><a href="Survival.html#cb6-50" tabindex="-1"></a>                model.file)</span>
<span id="cb6-51"><a href="Survival.html#cb6-51" tabindex="-1"></a><span class="fu">print</span>(jagsfit)</span>
<span id="cb6-52"><a href="Survival.html#cb6-52" tabindex="-1"></a><span class="fu">plot</span>(jagsfit)</span></code></pre></div>
<p>The age at 50% selectivity should be less than the maximum age so a uniform prior is appropriate. The slope of the selectivity curve does not have an obvious upper bound, so following <span class="citation">McCarthy (<a href="#ref-mccarthy2007">2007</a>)</span>, we use an uninformative lognormal prior. Restricting the slope to positive values is consistent with a survey gear that underrepresents smaller fish. Convergence can be slow when using a lognormal prior so check Rhat values and increase the number of updates (n.iter) if needed.</p>
<p>There are several reasons why this analysis works (at least for these assumed parameter values). We have an unbiased sample of size 100 from the expected age distribution (which reflects both survival and selectivity). The most important reason is that survival is constant over the entire age range. Selectivity and survival are confounded for young fish but not for older fish that are fully vulnerable to the survey. Thus the shape of the selectivity function matters, as does the age range included in the analysis. It would not be possible to jointly estimate selectivity and survival if selectivity increased across the surveyed age range. And as before, the analysis is a best-case scenario in that the only variation is due to sampling from the multinomial distribution. Selectivity varies by age but all ages share the same selectivity parameters.</p>
<p>One way to improve on this analysis would be to include auxiliary data on selectivity. We could accomplish this by conducting a short-term tagging study with (for simplicity) equal numbers tagged by age. Having a tagged subpopulation with a known age structure provides direct information on selectivity, unlike the age composition data where selectivity and mortality are partially confounded. The logistical challenge in adding this auxiliary study is in obtaining sufficient tag returns through survey sampling.</p>
<p>The following version of the code includes auxiliary tag-return data:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="Survival.html#cb7-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb7-2"><a href="Survival.html#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="Survival.html#cb7-3" tabindex="-1"></a><span class="co"># Simulate age composition sampling with age-specific selectivity</span></span>
<span id="cb7-4"><a href="Survival.html#cb7-4" tabindex="-1"></a>MaxAge <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb7-5"><a href="Survival.html#cb7-5" tabindex="-1"></a>S.true <span class="ot">&lt;-</span> <span class="fl">0.7</span> <span class="co"># Annual survival probability</span></span>
<span id="cb7-6"><a href="Survival.html#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="Survival.html#cb7-7" tabindex="-1"></a><span class="co"># Parameters for selectivity curve</span></span>
<span id="cb7-8"><a href="Survival.html#cb7-8" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Slope for logistic function</span></span>
<span id="cb7-9"><a href="Survival.html#cb7-9" tabindex="-1"></a>a_50 <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># Age at 0.5 selectivity</span></span>
<span id="cb7-10"><a href="Survival.html#cb7-10" tabindex="-1"></a></span>
<span id="cb7-11"><a href="Survival.html#cb7-11" tabindex="-1"></a><span class="co"># Age selectivity</span></span>
<span id="cb7-12"><a href="Survival.html#cb7-12" tabindex="-1"></a>Sel <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span>MaxAge)</span>
<span id="cb7-13"><a href="Survival.html#cb7-13" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(MaxAge)){</span>
<span id="cb7-14"><a href="Survival.html#cb7-14" tabindex="-1"></a>  Sel[j] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>k<span class="sc">*</span>(j<span class="sc">-</span>a_50)))</span>
<span id="cb7-15"><a href="Survival.html#cb7-15" tabindex="-1"></a>} <span class="co">#j</span></span>
<span id="cb7-16"><a href="Survival.html#cb7-16" tabindex="-1"></a>age.vec <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,MaxAge, <span class="at">by=</span><span class="dv">1</span>)  <span class="co"># Sequence function to provide x axis values for plotting</span></span>
<span id="cb7-17"><a href="Survival.html#cb7-17" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb7-18"><a href="Survival.html#cb7-18" tabindex="-1"></a><span class="fu">plot</span>(age.vec, Sel, <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Gear selectivity&quot;</span>)</span>
<span id="cb7-19"><a href="Survival.html#cb7-19" tabindex="-1"></a></span>
<span id="cb7-20"><a href="Survival.html#cb7-20" tabindex="-1"></a><span class="co"># Simulated age vector, including gear selectivity</span></span>
<span id="cb7-21"><a href="Survival.html#cb7-21" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span>MaxAge)</span>
<span id="cb7-22"><a href="Survival.html#cb7-22" tabindex="-1"></a>N[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb7-23"><a href="Survival.html#cb7-23" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(MaxAge)){</span>
<span id="cb7-24"><a href="Survival.html#cb7-24" tabindex="-1"></a>  N[j] <span class="ot">&lt;-</span> N[j<span class="dv">-1</span>] <span class="sc">*</span> S.true</span>
<span id="cb7-25"><a href="Survival.html#cb7-25" tabindex="-1"></a>} <span class="co">#j</span></span>
<span id="cb7-26"><a href="Survival.html#cb7-26" tabindex="-1"></a>N_Sel <span class="ot">&lt;-</span> N <span class="sc">*</span> Sel</span>
<span id="cb7-27"><a href="Survival.html#cb7-27" tabindex="-1"></a>age.vec <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,MaxAge, <span class="at">by=</span><span class="dv">1</span>)  <span class="co"># Sequence function to provide x axis values for plotting</span></span>
<span id="cb7-28"><a href="Survival.html#cb7-28" tabindex="-1"></a><span class="fu">barplot</span>(N_Sel, <span class="at">names.arg=</span>age.vec, <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Number&quot;</span>, <span class="at">main=</span><span class="st">&quot;Expected age distribution&quot;</span>)</span>
<span id="cb7-29"><a href="Survival.html#cb7-29" tabindex="-1"></a></span>
<span id="cb7-30"><a href="Survival.html#cb7-30" tabindex="-1"></a>SampleSize <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb7-31"><a href="Survival.html#cb7-31" tabindex="-1"></a>AgeMatrix <span class="ot">&lt;-</span> <span class="fu">rmultinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">size=</span>SampleSize, <span class="at">prob=</span>N_Sel) <span class="co"># prob vector is rescaled internally</span></span>
<span id="cb7-32"><a href="Survival.html#cb7-32" tabindex="-1"></a>AgeSample <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">t</span>(AgeMatrix)) <span class="co"># Transpose matrix then convert to vector</span></span>
<span id="cb7-33"><a href="Survival.html#cb7-33" tabindex="-1"></a><span class="fu">barplot</span>(AgeSample, <span class="at">names.arg=</span>age.vec, <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Frequency&quot;</span>, <span class="at">main=</span><span class="st">&quot;Sample age distribution&quot;</span>)</span>
<span id="cb7-34"><a href="Survival.html#cb7-34" tabindex="-1"></a></span>
<span id="cb7-35"><a href="Survival.html#cb7-35" tabindex="-1"></a><span class="co"># Auxiliary tag-return data</span></span>
<span id="cb7-36"><a href="Survival.html#cb7-36" tabindex="-1"></a>TagReturns <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb7-37"><a href="Survival.html#cb7-37" tabindex="-1"></a>RetMatrix <span class="ot">&lt;-</span> <span class="fu">rmultinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">size=</span>TagReturns, <span class="at">prob=</span>Sel) <span class="co"># prob vector is rescaled internally</span></span>
<span id="cb7-38"><a href="Survival.html#cb7-38" tabindex="-1"></a>RetVector <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">t</span>(RetMatrix)) <span class="co"># Transpose matrix then convert to vector</span></span>
<span id="cb7-39"><a href="Survival.html#cb7-39" tabindex="-1"></a><span class="fu">barplot</span>(RetVector, <span class="at">names.arg=</span>age.vec, <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Frequency&quot;</span>, <span class="at">main=</span><span class="st">&quot;Tag returns&quot;</span>)</span>
<span id="cb7-40"><a href="Survival.html#cb7-40" tabindex="-1"></a></span>
<span id="cb7-41"><a href="Survival.html#cb7-41" tabindex="-1"></a><span class="co"># JAGS analysis</span></span>
<span id="cb7-42"><a href="Survival.html#cb7-42" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb7-43"><a href="Survival.html#cb7-43" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb7-44"><a href="Survival.html#cb7-44" tabindex="-1"></a></span>
<span id="cb7-45"><a href="Survival.html#cb7-45" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;AgeComp.txt&quot;</span>)</span>
<span id="cb7-46"><a href="Survival.html#cb7-46" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb7-47"><a href="Survival.html#cb7-47" tabindex="-1"></a><span class="st">model{</span></span>
<span id="cb7-48"><a href="Survival.html#cb7-48" tabindex="-1"></a><span class="st">    # Priors</span></span>
<span id="cb7-49"><a href="Survival.html#cb7-49" tabindex="-1"></a><span class="st">    S.est ~ dunif(0,1)  # Constant survival over sampled age range</span></span>
<span id="cb7-50"><a href="Survival.html#cb7-50" tabindex="-1"></a><span class="st">    a50.est ~ dunif(0, MaxAge)</span></span>
<span id="cb7-51"><a href="Survival.html#cb7-51" tabindex="-1"></a><span class="st">    k.est ~ dlnorm(0, 1E-6) # Slope &gt; 0 for increasing selectivity</span></span>
<span id="cb7-52"><a href="Survival.html#cb7-52" tabindex="-1"></a></span>
<span id="cb7-53"><a href="Survival.html#cb7-53" tabindex="-1"></a><span class="st">    N[1] &lt;- 1000</span></span>
<span id="cb7-54"><a href="Survival.html#cb7-54" tabindex="-1"></a><span class="st">    # Generate equilibrium age proportions</span></span>
<span id="cb7-55"><a href="Survival.html#cb7-55" tabindex="-1"></a><span class="st">    for (j in 2:MaxAge){</span></span>
<span id="cb7-56"><a href="Survival.html#cb7-56" tabindex="-1"></a><span class="st">      N[j] &lt;- N[j-1]*S.est</span></span>
<span id="cb7-57"><a href="Survival.html#cb7-57" tabindex="-1"></a><span class="st">    } # j</span></span>
<span id="cb7-58"><a href="Survival.html#cb7-58" tabindex="-1"></a><span class="st">    for (j in 1:MaxAge){</span></span>
<span id="cb7-59"><a href="Survival.html#cb7-59" tabindex="-1"></a><span class="st">    Sel[j] &lt;- 1/(1+exp(-k.est*(j-a50.est)))</span></span>
<span id="cb7-60"><a href="Survival.html#cb7-60" tabindex="-1"></a><span class="st">     N.Sel[j] &lt;- N[j] * Sel[j]</span></span>
<span id="cb7-61"><a href="Survival.html#cb7-61" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb7-62"><a href="Survival.html#cb7-62" tabindex="-1"></a><span class="st">    N.sum &lt;- sum(N.Sel[]) # Rescale so that proportions sum to 1</span></span>
<span id="cb7-63"><a href="Survival.html#cb7-63" tabindex="-1"></a><span class="st">    for (j in 1:MaxAge){</span></span>
<span id="cb7-64"><a href="Survival.html#cb7-64" tabindex="-1"></a><span class="st">    p[j] &lt;- N.Sel[j]/N.sum</span></span>
<span id="cb7-65"><a href="Survival.html#cb7-65" tabindex="-1"></a><span class="st">    } #j</span></span>
<span id="cb7-66"><a href="Survival.html#cb7-66" tabindex="-1"></a><span class="st">    # Likelihood</span></span>
<span id="cb7-67"><a href="Survival.html#cb7-67" tabindex="-1"></a><span class="st">    AgeSample[] ~ dmulti(p[], SampleSize)  # Fit multinomial distribution based on constant survival</span></span>
<span id="cb7-68"><a href="Survival.html#cb7-68" tabindex="-1"></a></span>
<span id="cb7-69"><a href="Survival.html#cb7-69" tabindex="-1"></a><span class="st">    # Additional likelihood for tag-return data</span></span>
<span id="cb7-70"><a href="Survival.html#cb7-70" tabindex="-1"></a><span class="st">    Sel.sum &lt;- sum(Sel[])</span></span>
<span id="cb7-71"><a href="Survival.html#cb7-71" tabindex="-1"></a><span class="st">    for (j in 1:MaxAge){</span></span>
<span id="cb7-72"><a href="Survival.html#cb7-72" tabindex="-1"></a><span class="st">    Sel.p[j] &lt;- Sel[j]/Sel.sum</span></span>
<span id="cb7-73"><a href="Survival.html#cb7-73" tabindex="-1"></a><span class="st">    } #j</span></span>
<span id="cb7-74"><a href="Survival.html#cb7-74" tabindex="-1"></a><span class="st">    RetVector[] ~ dmulti(Sel.p[], TagReturns)    </span></span>
<span id="cb7-75"><a href="Survival.html#cb7-75" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb7-76"><a href="Survival.html#cb7-76" tabindex="-1"></a><span class="st">    &quot;</span>,<span class="at">fill=</span><span class="cn">TRUE</span>)</span>
<span id="cb7-77"><a href="Survival.html#cb7-77" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb7-78"><a href="Survival.html#cb7-78" tabindex="-1"></a></span>
<span id="cb7-79"><a href="Survival.html#cb7-79" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb7-80"><a href="Survival.html#cb7-80" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;AgeSample&quot;</span>, <span class="st">&quot;SampleSize&quot;</span>, <span class="st">&quot;MaxAge&quot;</span>, <span class="st">&quot;TagReturns&quot;</span>, <span class="st">&quot;RetVector&quot;</span>)</span>
<span id="cb7-81"><a href="Survival.html#cb7-81" tabindex="-1"></a></span>
<span id="cb7-82"><a href="Survival.html#cb7-82" tabindex="-1"></a><span class="co"># Initial values</span></span>
<span id="cb7-83"><a href="Survival.html#cb7-83" tabindex="-1"></a>jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){ <span class="fu">list</span>(<span class="at">S.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">1</span>),</span>
<span id="cb7-84"><a href="Survival.html#cb7-84" tabindex="-1"></a>                               <span class="at">a50.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span>MaxAge),</span>
<span id="cb7-85"><a href="Survival.html#cb7-85" tabindex="-1"></a>                               <span class="at">k.est=</span><span class="fu">rlnorm</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">meanlog=</span><span class="dv">0</span>, <span class="at">sdlog=</span><span class="dv">1</span>))} <span class="co"># Arbitrary low initial values</span></span>
<span id="cb7-86"><a href="Survival.html#cb7-86" tabindex="-1"></a></span>
<span id="cb7-87"><a href="Survival.html#cb7-87" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;AgeComp.txt&#39;</span></span>
<span id="cb7-88"><a href="Survival.html#cb7-88" tabindex="-1"></a></span>
<span id="cb7-89"><a href="Survival.html#cb7-89" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb7-90"><a href="Survival.html#cb7-90" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;S.est&quot;</span>, <span class="st">&quot;a50.est&quot;</span>, <span class="st">&quot;k.est&quot;</span>)</span>
<span id="cb7-91"><a href="Survival.html#cb7-91" tabindex="-1"></a></span>
<span id="cb7-92"><a href="Survival.html#cb7-92" tabindex="-1"></a><span class="co"># Call JAGS from R</span></span>
<span id="cb7-93"><a href="Survival.html#cb7-93" tabindex="-1"></a>jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb7-94"><a href="Survival.html#cb7-94" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">20000</span>,</span>
<span id="cb7-95"><a href="Survival.html#cb7-95" tabindex="-1"></a>                model.file)</span>
<span id="cb7-96"><a href="Survival.html#cb7-96" tabindex="-1"></a><span class="fu">print</span>(jagsfit)</span>
<span id="cb7-97"><a href="Survival.html#cb7-97" tabindex="-1"></a><span class="fu">plot</span>(jagsfit)</span></code></pre></div>
<p>There are three changes to the code in this version. First, the vector of random tag returns is generated just below the random survey catch vector. We assume a sample size of 30 returned tags, allocated randomly among ages using a multinomial distribution and the survey selectivity pattern. You can examine the barplot for the tag returns to get a sense of what the auxiliary study contributes to the overall analysis. The next code change is adding a second likelihood component to make use of the tag-return data. The third change is to pass these additional data (tag return total and by age) to JAGS.</p>
<p>Having direct information on survey gear selectivity can improves estimates of survival and selectivity, especially if the age composition sample size is small. And more importantly, this modification illustrates how auxiliary data can be added in JAGS to refine an analysis. Writing code to fit the specifics of a field study is valuable for planning and analysis, and is a major advantage over using canned software. The remaining chapters will include other examples where multiple data sources can be combined to improve estimates.</p>
</div>
<div id="Cohort" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Cohort model<a href="Survival.html#Cohort" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One limitation of the above analysis (Section <a href="Survival.html#AgeComp">6.1</a>) or a traditional catch curve is that recruitment is assumed to be constant (or can be averaged over). Catch curve analyses are generally robust to this assumption <span class="citation">(<a href="#ref-allen_1997">Allen 1997</a>)</span>, but year-class variation can sometimes be quite extreme. The following approach addresses that concern by modeling each year-class (or cohort) separately. The approach is similar to a virtual population analysis (VPA) or cohort analysis <span class="citation">(<a href="#ref-ricker1975">Ricker 1975</a>)</span> in that a catch matrix provides age- and year-specific information that is used to track cohorts across years. A VPA is traditionally done using harvest data, but here, we assume the catch-at-age matrix contains survey data. Survey information allows for modeling relative abundance across time, whereas a traditional VPA is used to estimate absolute abundance.</p>
<p>The following simulation code provides the survey catch-at-age matrix. The number of ages and years is arbitrary, but we are estimating survival rate for each year so there should be enough ages to provide a decent sample size. The annual survival rate is drawn from a uniform distribution between arbitrary lower and upper bounds. Having a fair degree of annual variation in survival makes for a better test of our ability to estimate those values.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="Survival.html#cb8-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb8-2"><a href="Survival.html#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="Survival.html#cb8-3" tabindex="-1"></a><span class="co"># Simulation to create survey catch-at-age matrix</span></span>
<span id="cb8-4"><a href="Survival.html#cb8-4" tabindex="-1"></a><span class="co"># Assume ages included in matrix are fully selected</span></span>
<span id="cb8-5"><a href="Survival.html#cb8-5" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># Arbitrary number of ages in survey catch matrix</span></span>
<span id="cb8-6"><a href="Survival.html#cb8-6" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb8-7"><a href="Survival.html#cb8-7" tabindex="-1"></a>LowS <span class="ot">&lt;-</span> <span class="fl">0.2</span> <span class="co"># Arbitrary lower bound</span></span>
<span id="cb8-8"><a href="Survival.html#cb8-8" tabindex="-1"></a>HighS <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="co"># Arbitrary upper bound</span></span>
<span id="cb8-9"><a href="Survival.html#cb8-9" tabindex="-1"></a>MeanS <span class="ot">&lt;-</span> (LowS<span class="sc">+</span>HighS)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb8-10"><a href="Survival.html#cb8-10" tabindex="-1"></a>AnnualS <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span>(Y<span class="dv">-1</span>))</span>
<span id="cb8-11"><a href="Survival.html#cb8-11" tabindex="-1"></a>AnnualS <span class="ot">&lt;-</span> <span class="fu">runif</span>((Y<span class="dv">-1</span>), <span class="at">min=</span>LowS, <span class="at">max=</span>HighS)</span>
<span id="cb8-12"><a href="Survival.html#cb8-12" tabindex="-1"></a></span>
<span id="cb8-13"><a href="Survival.html#cb8-13" tabindex="-1"></a>MeanR <span class="ot">&lt;-</span> <span class="dv">400</span> <span class="co"># Arbitrary mean initial cohort size (relative)</span></span>
<span id="cb8-14"><a href="Survival.html#cb8-14" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(A, Y))</span>
<span id="cb8-15"><a href="Survival.html#cb8-15" tabindex="-1"></a>N[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">rpois</span>(Y, MeanR) <span class="co"># Starting size of each cohort at first age</span></span>
<span id="cb8-16"><a href="Survival.html#cb8-16" tabindex="-1"></a><span class="cf">for</span> (a <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>A){</span>
<span id="cb8-17"><a href="Survival.html#cb8-17" tabindex="-1"></a>  N[a,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>,MeanS<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>MeanR) <span class="co"># Starting sizes - ages 2+, year 1</span></span>
<span id="cb8-18"><a href="Survival.html#cb8-18" tabindex="-1"></a>  <span class="cf">for</span> (y <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>Y){</span>
<span id="cb8-19"><a href="Survival.html#cb8-19" tabindex="-1"></a>    N[a,y] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, N[a<span class="dv">-1</span>, y<span class="dv">-1</span>], AnnualS[y<span class="dv">-1</span>]) <span class="co"># Fill in older ages</span></span>
<span id="cb8-20"><a href="Survival.html#cb8-20" tabindex="-1"></a>    } <span class="co">#y</span></span>
<span id="cb8-21"><a href="Survival.html#cb8-21" tabindex="-1"></a>  } <span class="co">#a</span></span>
<span id="cb8-22"><a href="Survival.html#cb8-22" tabindex="-1"></a></span>
<span id="cb8-23"><a href="Survival.html#cb8-23" tabindex="-1"></a>SurveyCapProb <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="co"># Capture probability</span></span>
<span id="cb8-24"><a href="Survival.html#cb8-24" tabindex="-1"></a>SurveyC <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(A, Y))</span>
<span id="cb8-25"><a href="Survival.html#cb8-25" tabindex="-1"></a><span class="co"># Generate survey catches (account for survey catchability)</span></span>
<span id="cb8-26"><a href="Survival.html#cb8-26" tabindex="-1"></a><span class="cf">for</span> (a <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>A){</span>
<span id="cb8-27"><a href="Survival.html#cb8-27" tabindex="-1"></a>  <span class="cf">for</span> (y <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>Y){</span>
<span id="cb8-28"><a href="Survival.html#cb8-28" tabindex="-1"></a>    SurveyC[a,y] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, N[a, y], SurveyCapProb)</span>
<span id="cb8-29"><a href="Survival.html#cb8-29" tabindex="-1"></a>  } <span class="co">#y</span></span>
<span id="cb8-30"><a href="Survival.html#cb8-30" tabindex="-1"></a>} <span class="co">#a</span></span></code></pre></div>
<p>The model tracks coded ages 1:A, which could represent a range of older ages with comparable survival rates. True abundance at age 1 (N[1,]) is drawn from a Poisson distribution, based on an arbitrary mean initial cohort size. Initial numbers for ages 2:A in the first year are also obtained from a Poisson distribution, where the expected number at age a is obtained by a product of survival rates multiplied by mean recruitment. For example, the expected number is MeanR * S at age 2 (adjusting for survival over one year), MeanR * S^2 for age 3, etc. The code then loops over years (columns) and ages (rows) to fill in the rest of the matrix, using a binomial distribution to simulate the survival process (and using the year-specific survival rate). The survey catch-at-age matrix includes variation due to sampling (binomally-distributed using an assumed capture probability of 0.05), as well as year-class strength and survival. Click on N and SurveyC in the Environment window to compare the two matrices in Source windows.</p>
<p>The JAGS code for estimating cohort size and annual survival is generally similar to the simulation code. Prior distributions and initial values for predicted survey catches use lognormal distributions. The log-scale mean for the initial values was set at a high value to reduce the risk of a runtime JAGS error due to an inconsistent parent node (e.g., estimated survey “abundance” at time y-1 less than observed survey catch at time y). The likelihood for the survey catch matrix uses a Poisson distribution.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="Survival.html#cb9-1" tabindex="-1"></a><span class="co"># Load necessary library packages</span></span>
<span id="cb9-2"><a href="Survival.html#cb9-2" tabindex="-1"></a><span class="fu">library</span>(rjags)   <span class="co"># Package for fitting JAGS models from within R</span></span>
<span id="cb9-3"><a href="Survival.html#cb9-3" tabindex="-1"></a><span class="fu">library</span>(R2jags)  <span class="co"># Package for fitting JAGS models. Requires rjags</span></span>
<span id="cb9-4"><a href="Survival.html#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="Survival.html#cb9-5" tabindex="-1"></a><span class="co"># JAGS code</span></span>
<span id="cb9-6"><a href="Survival.html#cb9-6" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;CatchAge.txt&quot;</span>)</span>
<span id="cb9-7"><a href="Survival.html#cb9-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb9-8"><a href="Survival.html#cb9-8" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb9-9"><a href="Survival.html#cb9-9" tabindex="-1"></a><span class="st">    # Priors</span></span>
<span id="cb9-10"><a href="Survival.html#cb9-10" tabindex="-1"></a><span class="st">    for(y in 1:Y) {</span></span>
<span id="cb9-11"><a href="Survival.html#cb9-11" tabindex="-1"></a><span class="st">      Recruits[y] ~ dlnorm(0, 1E-6) # Non-negative values</span></span>
<span id="cb9-12"><a href="Survival.html#cb9-12" tabindex="-1"></a><span class="st">    SurveyC.est[1,y]&lt;-Recruits[y] }</span></span>
<span id="cb9-13"><a href="Survival.html#cb9-13" tabindex="-1"></a></span>
<span id="cb9-14"><a href="Survival.html#cb9-14" tabindex="-1"></a><span class="st">    for(a in 2:A){</span></span>
<span id="cb9-15"><a href="Survival.html#cb9-15" tabindex="-1"></a><span class="st">      Initials[a-1] ~ dlnorm(0, 1E-6) # Non-negative; offset index to run vector from 1 to A-1</span></span>
<span id="cb9-16"><a href="Survival.html#cb9-16" tabindex="-1"></a><span class="st">    SurveyC.est[a,1]&lt;-Initials[a-1] }</span></span>
<span id="cb9-17"><a href="Survival.html#cb9-17" tabindex="-1"></a></span>
<span id="cb9-18"><a href="Survival.html#cb9-18" tabindex="-1"></a><span class="st">  meanS &lt;- prod(S.est)^(1/(Y-1))</span></span>
<span id="cb9-19"><a href="Survival.html#cb9-19" tabindex="-1"></a><span class="st">  for (y in 1:(Y-1)) {</span></span>
<span id="cb9-20"><a href="Survival.html#cb9-20" tabindex="-1"></a><span class="st">    S.est[y] ~ dunif(0,1)</span></span>
<span id="cb9-21"><a href="Survival.html#cb9-21" tabindex="-1"></a><span class="st">    } #y</span></span>
<span id="cb9-22"><a href="Survival.html#cb9-22" tabindex="-1"></a></span>
<span id="cb9-23"><a href="Survival.html#cb9-23" tabindex="-1"></a><span class="st">    # Population projection</span></span>
<span id="cb9-24"><a href="Survival.html#cb9-24" tabindex="-1"></a><span class="st">    for(a in 2:A) {</span></span>
<span id="cb9-25"><a href="Survival.html#cb9-25" tabindex="-1"></a><span class="st">   for(y in 2:Y) {</span></span>
<span id="cb9-26"><a href="Survival.html#cb9-26" tabindex="-1"></a><span class="st">     SurveyC.est[a,y] ~ dbin(S.est[y-1], trunc(SurveyC.est[a-1,y-1])) } }</span></span>
<span id="cb9-27"><a href="Survival.html#cb9-27" tabindex="-1"></a></span>
<span id="cb9-28"><a href="Survival.html#cb9-28" tabindex="-1"></a><span class="st">    #Likelihood</span></span>
<span id="cb9-29"><a href="Survival.html#cb9-29" tabindex="-1"></a><span class="st">    for (a in 1:A) {</span></span>
<span id="cb9-30"><a href="Survival.html#cb9-30" tabindex="-1"></a><span class="st">   for (y in 1:Y) {</span></span>
<span id="cb9-31"><a href="Survival.html#cb9-31" tabindex="-1"></a><span class="st">      SurveyC[a,y]~dpois(SurveyC.est[a,y])</span></span>
<span id="cb9-32"><a href="Survival.html#cb9-32" tabindex="-1"></a><span class="st">     }#a }#y</span></span>
<span id="cb9-33"><a href="Survival.html#cb9-33" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb9-34"><a href="Survival.html#cb9-34" tabindex="-1"></a><span class="st">    &quot;</span>,<span class="at">fill=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-35"><a href="Survival.html#cb9-35" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb9-36"><a href="Survival.html#cb9-36" tabindex="-1"></a></span>
<span id="cb9-37"><a href="Survival.html#cb9-37" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb9-38"><a href="Survival.html#cb9-38" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;Y&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;SurveyC&quot;</span>)</span>
<span id="cb9-39"><a href="Survival.html#cb9-39" tabindex="-1"></a></span>
<span id="cb9-40"><a href="Survival.html#cb9-40" tabindex="-1"></a><span class="co"># Initial values</span></span>
<span id="cb9-41"><a href="Survival.html#cb9-41" tabindex="-1"></a>jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){ <span class="fu">list</span>(<span class="at">Recruits=</span><span class="fu">rlnorm</span>(<span class="at">n=</span>Y, <span class="at">meanlog=</span><span class="dv">10</span>, <span class="at">sdlog=</span><span class="dv">1</span>),</span>
<span id="cb9-42"><a href="Survival.html#cb9-42" tabindex="-1"></a>                               <span class="at">Initials=</span><span class="fu">rlnorm</span>(<span class="at">n=</span>(A<span class="dv">-1</span>), <span class="at">meanlog=</span><span class="dv">10</span>, <span class="at">sdlog=</span><span class="dv">1</span>))}</span>
<span id="cb9-43"><a href="Survival.html#cb9-43" tabindex="-1"></a></span>
<span id="cb9-44"><a href="Survival.html#cb9-44" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;CatchAge.txt&#39;</span></span>
<span id="cb9-45"><a href="Survival.html#cb9-45" tabindex="-1"></a></span>
<span id="cb9-46"><a href="Survival.html#cb9-46" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb9-47"><a href="Survival.html#cb9-47" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;S.est&quot;</span>, <span class="st">&quot;meanS&quot;</span>)</span>
<span id="cb9-48"><a href="Survival.html#cb9-48" tabindex="-1"></a></span>
<span id="cb9-49"><a href="Survival.html#cb9-49" tabindex="-1"></a><span class="co"># Call JAGS from R</span></span>
<span id="cb9-50"><a href="Survival.html#cb9-50" tabindex="-1"></a>jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb9-51"><a href="Survival.html#cb9-51" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">10000</span>,</span>
<span id="cb9-52"><a href="Survival.html#cb9-52" tabindex="-1"></a>                model.file)</span>
<span id="cb9-53"><a href="Survival.html#cb9-53" tabindex="-1"></a><span class="fu">print</span>(jagsfit)</span>
<span id="cb9-54"><a href="Survival.html#cb9-54" tabindex="-1"></a><span class="fu">plot</span>(jagsfit)</span>
<span id="cb9-55"><a href="Survival.html#cb9-55" tabindex="-1"></a></span>
<span id="cb9-56"><a href="Survival.html#cb9-56" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span>(Y<span class="dv">-1</span>)), jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>mean<span class="sc">$</span>S.est, <span class="at">ylab=</span><span class="st">&quot;Survival&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>,</span>
<span id="cb9-57"><a href="Survival.html#cb9-57" tabindex="-1"></a>     <span class="at">type=</span><span class="st">&quot;b&quot;</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb9-58"><a href="Survival.html#cb9-58" tabindex="-1"></a><span class="fu">points</span>(AnnualS, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">type=</span><span class="st">&quot;b&quot;</span>)</span></code></pre></div>
<p>The final three lines of code compare the annual survival estimates and true values (Figure <a href="Survival.html#fig:CohortPlot">6.1</a>). The plot option “type=b” produces a line of connected dots (i.e., <em>both</em> points and line segments), and the “pch=19” option selects for a filled dot. An online search for “r plot options pch” will provide the various choices for plotting symbols. The range for the y axis is fixed at 0-1 to ensure that the plot will contain the full range of both the estimates and the true values. The <code>points()</code> function adds to the plot the true values. The model provides reliable estimates of annual (and mean) survival and initial cohort size for the simulated data. Run the simulation and model fitting code multiple times to observe model performance. It would be worthwhile to test the approach using more variability in initial cohort sizes; for example, by using a negative binomial distribution rather than a Poisson.</p>
<div class="figure"><span style="display:block;" id="fig:CohortPlot"></span>
<img src="bookdown_files/figure-html/CohortPlot-1.png" alt="Example run showing true (blue) and estimated (black) annual survival rate from a cohort-based analysis of survey catch-at-age data." width="90%" />
<p class="caption">
FIGURE 6.1: Example run showing true (blue) and estimated (black) annual survival rate from a cohort-based analysis of survey catch-at-age data.
</p>
</div>
<p>It is important to keep in mind that the predicted survey catches are not estimates of true abundance but simply scaled to the survey catches. <span class="citation">Millar and Meyer (<a href="#ref-millar.meyer2000">2000</a>)</span> illustrate a Bayesian approach for estimating true abundance from survey <em>and</em> harvest catch-at-age matrices.</p>
</div>
</div>
<div id="TelemetryBased" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Telemetry-based<a href="Survival.html#TelemetryBased" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The focus for this section will be on estimating survival using fixed receiver stations and telemetry tags such as transmitters or PIT tags. Letting fish “detect themselves” eliminates the need for costly field surveys that often result in low detection probabilities. For example, <span class="citation">Hewitt et al. (<a href="#ref-hewitt.etal2010">2010</a>)</span> showed that survival estimates using fixed stations and automated detections were much better than those obtained using only survey recaptures. Similarly, <span class="citation">Hightower et al. (<a href="#ref-hightower.etal2015">2015</a>)</span> estimated survival of sonic-tagged Atlantic sturgeon which were detected as they migrated past receivers located in estuaries and rivers. The key in studies of this type is either to have many monitoring sites or to position sites in areas where tagged fish are likely to pass.</p>
<p>These studies produces detections that can be organized as a capture history matrix. Each row of the matrix is a tagged fish, and each column is a time period. The period can be chosen based on whatever time scale is relevant and practical; for example, monthly or quarterly detections would provide insights about seasonal survival. Each matrix cell indicates whether a fish was detected (1) or not (0). A fish not detected could be dead or simply did not move within range of a receiver during that period. Interpreting the capture history for an individual depends on the pattern. There is no ambiguity about an individual with a capture history of 11011. It was alive to the end of the study but was not detected on the third occasion. A sequence such as 11000 is not as straightforward because its fate is uncertain for the final three occasions. A model is essential for making inferences in such cases.</p>
<p>The capture history data can be analyzed using a Cormack-Jolly-Seber (CJS) model <span class="citation">(<a href="#ref-kéry.schaub_2011">Kéry and Schaub 2011</a>)</span>. The model is based only on captures or detections of tagged fish, which are assumed to be representative of the population as a whole. Technically, the model provides an estimate of apparent survival because we are not able to distinguish between mortality and permanent emigration. If the study area is closed to migration, then the estimate can be interpreted as a true survival rate.</p>
<p>Our simulation is for the most basic case, with survival and detection probabilities that are constant over time. Extended models that allow for time variation are presented by <span class="citation">Kéry and Schaub (<a href="#ref-kéry.schaub_2011">2011</a>)</span>. The number of occasions and sample size are arbitrary but they serve as useful replicates here because the underlying parameters are constant over time and individuals. We assume a moderate survival rate (0.5) and a high detection probability (0.8). Detection probabilities of that magnitude are difficult to achieve by survey sampling but are reasonable when using an automated monitoring system <span class="citation">(<a href="#ref-hewitt.etal2010">Hewitt et al. 2010</a>)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="Survival.html#cb10-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb10-2"><a href="Survival.html#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="Survival.html#cb10-3" tabindex="-1"></a><span class="co"># Modified from Kery and Schaub 2011, Section 7.3</span></span>
<span id="cb10-4"><a href="Survival.html#cb10-4" tabindex="-1"></a><span class="co"># Define parameter values</span></span>
<span id="cb10-5"><a href="Survival.html#cb10-5" tabindex="-1"></a>n.occasions <span class="ot">&lt;-</span> <span class="dv">5</span>            <span class="co"># Number of capture occasions</span></span>
<span id="cb10-6"><a href="Survival.html#cb10-6" tabindex="-1"></a>marked <span class="ot">&lt;-</span> <span class="dv">50</span>                <span class="co"># Number marked (all at time 1)</span></span>
<span id="cb10-7"><a href="Survival.html#cb10-7" tabindex="-1"></a>S.true <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb10-8"><a href="Survival.html#cb10-8" tabindex="-1"></a>p.true <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb10-9"><a href="Survival.html#cb10-9" tabindex="-1"></a></span>
<span id="cb10-10"><a href="Survival.html#cb10-10" tabindex="-1"></a><span class="co"># Define function to simulate a capture-history (CH) matrix</span></span>
<span id="cb10-11"><a href="Survival.html#cb10-11" tabindex="-1"></a>simul.cjs <span class="ot">&lt;-</span> <span class="cf">function</span>(S.true, p.true, marked, n.occasions){</span>
<span id="cb10-12"><a href="Survival.html#cb10-12" tabindex="-1"></a>  Latent <span class="ot">&lt;-</span> CH <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">ncol =</span> n.occasions, <span class="at">nrow =</span> marked)</span>
<span id="cb10-13"><a href="Survival.html#cb10-13" tabindex="-1"></a>  <span class="co"># Fill the CH matrix</span></span>
<span id="cb10-14"><a href="Survival.html#cb10-14" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>marked){</span>
<span id="cb10-15"><a href="Survival.html#cb10-15" tabindex="-1"></a>    Latent[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> CH[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span>    <span class="co"># Known alive state at release occasion</span></span>
<span id="cb10-16"><a href="Survival.html#cb10-16" tabindex="-1"></a>    <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n.occasions){</span>
<span id="cb10-17"><a href="Survival.html#cb10-17" tabindex="-1"></a>      <span class="co"># Bernoulli trial: does individual survive occasion?</span></span>
<span id="cb10-18"><a href="Survival.html#cb10-18" tabindex="-1"></a>      Latent[i,t] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, (Latent[i,(t<span class="dv">-1</span>)]<span class="sc">*</span>S.true))</span>
<span id="cb10-19"><a href="Survival.html#cb10-19" tabindex="-1"></a>      <span class="co"># Bernoulli trial: is individual recaptured?</span></span>
<span id="cb10-20"><a href="Survival.html#cb10-20" tabindex="-1"></a>      CH[i,t] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, (Latent[i,t]<span class="sc">*</span>p.true))</span>
<span id="cb10-21"><a href="Survival.html#cb10-21" tabindex="-1"></a>    } <span class="co">#t</span></span>
<span id="cb10-22"><a href="Survival.html#cb10-22" tabindex="-1"></a>  } <span class="co">#i</span></span>
<span id="cb10-23"><a href="Survival.html#cb10-23" tabindex="-1"></a>  <span class="fu">return</span>(CH)</span>
<span id="cb10-24"><a href="Survival.html#cb10-24" tabindex="-1"></a>}</span>
<span id="cb10-25"><a href="Survival.html#cb10-25" tabindex="-1"></a></span>
<span id="cb10-26"><a href="Survival.html#cb10-26" tabindex="-1"></a><span class="co"># Execute function</span></span>
<span id="cb10-27"><a href="Survival.html#cb10-27" tabindex="-1"></a>CH <span class="ot">&lt;-</span> <span class="fu">simul.cjs</span>(S.true, p.true, marked, n.occasions)</span></code></pre></div>
<p>Our code, modified from <span class="citation">Kéry and Schaub (<a href="#ref-kéry.schaub_2011">2011</a>)</span>, introduces the creation of a user-defined function, which is a way of setting off a discrete block of code that has a specific purpose. We pass to the function the necessary arguments (S.true, p.true, marked, n.occasions) and the function returns the desired result (capture history matrix CH). The latent (true) state and the capture history observation are modeled using Bernoulli trials. The latent state at time t is based on the survival rate between times t-1 and t, but multiplied by the true state at time t-1. That results in live fish having a survival probability of 1 * S.true, whereas the probability for dead fish is 0 * S.true (ensuring that dead fish remain dead). A similar trick is used to generate the observations, given the known true states. Detection probability is 1 * p.true for live fish and 0 * p.true for dead fish. The matrix for latent state is internal to the function, but (for instructional purposes) can be compared to the observed matrix by selecting and running all lines between the second and next-to-last lines of the function. You should see the connection between the true latent state and observations (e.g., a true sequence of 11100 versus an observed sequence of 10100).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="Survival.html#cb11-1" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb11-2"><a href="Survival.html#cb11-2" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb11-3"><a href="Survival.html#cb11-3" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb11-4"><a href="Survival.html#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="Survival.html#cb11-5" tabindex="-1"></a><span class="co"># Specify model in JAGS</span></span>
<span id="cb11-6"><a href="Survival.html#cb11-6" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;CJS_StateSpace.txt&quot;</span>)</span>
<span id="cb11-7"><a href="Survival.html#cb11-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb11-8"><a href="Survival.html#cb11-8" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb11-9"><a href="Survival.html#cb11-9" tabindex="-1"></a></span>
<span id="cb11-10"><a href="Survival.html#cb11-10" tabindex="-1"></a><span class="st"># Priors and constraints</span></span>
<span id="cb11-11"><a href="Survival.html#cb11-11" tabindex="-1"></a><span class="st">S.est ~ dunif(0, 1)</span></span>
<span id="cb11-12"><a href="Survival.html#cb11-12" tabindex="-1"></a><span class="st">p.est ~ dunif(0, 1)</span></span>
<span id="cb11-13"><a href="Survival.html#cb11-13" tabindex="-1"></a></span>
<span id="cb11-14"><a href="Survival.html#cb11-14" tabindex="-1"></a><span class="st"># Likelihood</span></span>
<span id="cb11-15"><a href="Survival.html#cb11-15" tabindex="-1"></a><span class="st">for (i in 1:marked){</span></span>
<span id="cb11-16"><a href="Survival.html#cb11-16" tabindex="-1"></a><span class="st">   z[i,1] &lt;- 1 # Latent state 1 (alive) at time of release (time 1 here)</span></span>
<span id="cb11-17"><a href="Survival.html#cb11-17" tabindex="-1"></a><span class="st">   for (t in 2:n.occasions){</span></span>
<span id="cb11-18"><a href="Survival.html#cb11-18" tabindex="-1"></a><span class="st">      # State process. If z[t-1]=1, prob=S. If z=0, prob=0</span></span>
<span id="cb11-19"><a href="Survival.html#cb11-19" tabindex="-1"></a><span class="st">      z[i,t] ~ dbern(z[i,t-1]*S.est)</span></span>
<span id="cb11-20"><a href="Survival.html#cb11-20" tabindex="-1"></a></span>
<span id="cb11-21"><a href="Survival.html#cb11-21" tabindex="-1"></a><span class="st">      # Observation process. If z[t]=1, prob=p. If z=0, prob=0</span></span>
<span id="cb11-22"><a href="Survival.html#cb11-22" tabindex="-1"></a><span class="st">      CH[i,t] ~ dbern(z[i,t]*p.est)</span></span>
<span id="cb11-23"><a href="Survival.html#cb11-23" tabindex="-1"></a><span class="st">      } #t</span></span>
<span id="cb11-24"><a href="Survival.html#cb11-24" tabindex="-1"></a><span class="st">   } #i</span></span>
<span id="cb11-25"><a href="Survival.html#cb11-25" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb11-26"><a href="Survival.html#cb11-26" tabindex="-1"></a><span class="st">&quot;</span>,<span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-27"><a href="Survival.html#cb11-27" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb11-28"><a href="Survival.html#cb11-28" tabindex="-1"></a></span>
<span id="cb11-29"><a href="Survival.html#cb11-29" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb11-30"><a href="Survival.html#cb11-30" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">CH =</span> CH, <span class="at">marked =</span> marked, <span class="at">n.occasions =</span> n.occasions)</span>
<span id="cb11-31"><a href="Survival.html#cb11-31" tabindex="-1"></a></span>
<span id="cb11-32"><a href="Survival.html#cb11-32" tabindex="-1"></a><span class="co"># Initial values for latent state z</span></span>
<span id="cb11-33"><a href="Survival.html#cb11-33" tabindex="-1"></a>init.z <span class="ot">&lt;-</span> <span class="cf">function</span>(ch){</span>
<span id="cb11-34"><a href="Survival.html#cb11-34" tabindex="-1"></a>  state <span class="ot">&lt;-</span> ch</span>
<span id="cb11-35"><a href="Survival.html#cb11-35" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(ch)[<span class="dv">1</span>]){</span>
<span id="cb11-36"><a href="Survival.html#cb11-36" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">which</span>(ch[i,]<span class="sc">==</span><span class="dv">1</span>)) <span class="co"># Column with first detection (col 1 here)</span></span>
<span id="cb11-37"><a href="Survival.html#cb11-37" tabindex="-1"></a>    n2 <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">which</span>(ch[i,]<span class="sc">==</span><span class="dv">1</span>)) <span class="co"># Column with last detection</span></span>
<span id="cb11-38"><a href="Survival.html#cb11-38" tabindex="-1"></a>    <span class="co"># Fish are known to be alive between n1 and n2</span></span>
<span id="cb11-39"><a href="Survival.html#cb11-39" tabindex="-1"></a>    state[i,n1<span class="sc">:</span>n2] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-40"><a href="Survival.html#cb11-40" tabindex="-1"></a>    state[i,n1] <span class="ot">&lt;-</span> <span class="cn">NA</span> <span class="co"># Initial value not needed for release period</span></span>
<span id="cb11-41"><a href="Survival.html#cb11-41" tabindex="-1"></a>  }</span>
<span id="cb11-42"><a href="Survival.html#cb11-42" tabindex="-1"></a>  state[state<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb11-43"><a href="Survival.html#cb11-43" tabindex="-1"></a>  <span class="fu">return</span>(state)</span>
<span id="cb11-44"><a href="Survival.html#cb11-44" tabindex="-1"></a>}</span>
<span id="cb11-45"><a href="Survival.html#cb11-45" tabindex="-1"></a></span>
<span id="cb11-46"><a href="Survival.html#cb11-46" tabindex="-1"></a>jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){<span class="fu">list</span>(<span class="at">S.est =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">p.est =</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb11-47"><a href="Survival.html#cb11-47" tabindex="-1"></a>                              <span class="at">z =</span> <span class="fu">init.z</span>(CH))}</span>
<span id="cb11-48"><a href="Survival.html#cb11-48" tabindex="-1"></a></span>
<span id="cb11-49"><a href="Survival.html#cb11-49" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb11-50"><a href="Survival.html#cb11-50" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;S.est&quot;</span>, <span class="st">&quot;p.est&quot;</span>)</span>
<span id="cb11-51"><a href="Survival.html#cb11-51" tabindex="-1"></a></span>
<span id="cb11-52"><a href="Survival.html#cb11-52" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;CJS_StateSpace.txt&#39;</span></span>
<span id="cb11-53"><a href="Survival.html#cb11-53" tabindex="-1"></a></span>
<span id="cb11-54"><a href="Survival.html#cb11-54" tabindex="-1"></a>jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb11-55"><a href="Survival.html#cb11-55" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">4000</span>, <span class="at">n.burnin=</span><span class="dv">2000</span>,</span>
<span id="cb11-56"><a href="Survival.html#cb11-56" tabindex="-1"></a>                model.file)</span>
<span id="cb11-57"><a href="Survival.html#cb11-57" tabindex="-1"></a><span class="fu">print</span>(jagsfit)</span>
<span id="cb11-58"><a href="Survival.html#cb11-58" tabindex="-1"></a><span class="fu">plot</span>(jagsfit)</span></code></pre></div>
<p>The JAGS code for fitting the model uses our standard uninformative priors for the two probabilities (survival, detection probability). The likelihood mirrors the simulation code. The matrix z contains the latent state, which is sometimes known but inferred in situations where the pattern is ambiguous. JAGS requires good initial values (or will terminate execution if it encounters an initial value that is inconsistent with the observations, such as detection of a fish that the model considers to be dead). To avoid that, we use the <span class="citation">Kéry and Schaub (<a href="#ref-kéry.schaub_2011">2011</a>)</span> approach where the latent state is set to 1 between the first and last detections of an individual (user-defined function <code>init.z()</code>).</p>
<p>Estimates appear to be very reliable for this scenario, where capture histories for 50 fish are used to estimate only two time-independent parameters. Would you obtain usefully precise results with a sample size of 25 or 30 fish? How does reliability change as you reduce the assumed capture probability?</p>
<p>One important advantage of this telemetry method is that estimates are essentially produced in real-time and on any time scale. For example, the method could be used to estimate average annual survival over the first few years after a regulation change. Even better would be to modify the code to generate annual survival estimates, so that monitoring could be done over a block of years with a management action taken midway.</p>
</div>
<div id="BrownieSurvival" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Tag-based<a href="Survival.html#BrownieSurvival" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Survival can be estimated by a multi-period study using tag returns. An important advantage of this approach is that field effort is limited to the tagging process because the fishery generates the tag returns. The design requires a release of tagged fish at the start of each period. The releases need not be the same but here we assume a constant number released for simplicity. Like the telemetry method (Section <a href="Survival.html#TelemetryBased">6.2</a>), estimates can be produced for whatever time interval is relevant (e.g., monthly, yearly).</p>
<p>This study design is similar to band-recovery models used in wildlife studies <span class="citation">(<a href="#ref-brownie.etal1985">Brownie et al. 1985</a>; <a href="#ref-kéry.schaub_2011">Kéry and Schaub 2011</a>)</span>. Those methods were pioneered for migratory birds, with bands returned from individuals that were harvested. In fisheries tagging studies, tags may be also reported from fish that are caught and released but here we assume that returned tags reflect only harvest. Catch-and-release complicates the analysis because the tag “dies” but the fish is not killed. <span class="citation">Jiang et al. (<a href="#ref-jiang.etal2007">2007</a>)</span> provide analytical methods for addressing the combination of harvest and catch-and-release.</p>
<p>We begin by setting up matrices for tags-at-risk (tagged fish still alive) and the outcomes from each release. The matrix of outcomes or fates is analyzed row-by-row using a multinomial distribution. For example, a fish tagged in period 1 could be caught in any period up to the end of the study. It could also end up in the final column for fish not seen again, which would account for fish that were still alive or died of natural causes or were harvested but the tag was not reported. We do not assume here any knowledge of the tag-reporting rate. If that information were available (e.g., through use of high-reward tags that provide an assumed reporting rate of 100%), then it would be possible to partition total mortality into fishing and natural component rates <span class="citation">(<a href="#ref-brownie.etal1985">Brownie et al. 1985</a>)</span>. Here we keep things simple and estimate only the tag-recovery rate, which is the product of the exploitation rate and tag-reporting rate. In planning a tag-return study, the best results will be obtained by ensuring a tag-reporting rate close to 100%. Non-reporting results in lost information (a reduced sample size) and poorer precision.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="Survival.html#cb12-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb12-2"><a href="Survival.html#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="Survival.html#cb12-3" tabindex="-1"></a><span class="co"># Parameter values for three-yr experiment</span></span>
<span id="cb12-4"><a href="Survival.html#cb12-4" tabindex="-1"></a>Periods <span class="ot">&lt;-</span> <span class="dv">3</span>  <span class="co"># Equal number of release and return periods assumed</span></span>
<span id="cb12-5"><a href="Survival.html#cb12-5" tabindex="-1"></a>NTags <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># Number released each period</span></span>
<span id="cb12-6"><a href="Survival.html#cb12-6" tabindex="-1"></a>S.true <span class="ot">&lt;-</span> <span class="fl">0.8</span> <span class="co"># Survival rate</span></span>
<span id="cb12-7"><a href="Survival.html#cb12-7" tabindex="-1"></a>r.true <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># Tag recovery rate (exploitation rate * tag-reporting rate)</span></span>
<span id="cb12-8"><a href="Survival.html#cb12-8" tabindex="-1"></a></span>
<span id="cb12-9"><a href="Survival.html#cb12-9" tabindex="-1"></a><span class="co"># Calculated value(s), array creation</span></span>
<span id="cb12-10"><a href="Survival.html#cb12-10" tabindex="-1"></a>TagsAtRisk <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(Periods, Periods))</span>
<span id="cb12-11"><a href="Survival.html#cb12-11" tabindex="-1"></a>TagFate <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(Periods, Periods<span class="sc">+</span><span class="dv">1</span>))   <span class="co"># Extra column for tags not seen again</span></span>
<span id="cb12-12"><a href="Survival.html#cb12-12" tabindex="-1"></a></span>
<span id="cb12-13"><a href="Survival.html#cb12-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>Periods){ <span class="co"># Expected values for tags-at-risk, returned/not-seen-again</span></span>
<span id="cb12-14"><a href="Survival.html#cb12-14" tabindex="-1"></a>    TagsAtRisk[i,i] <span class="ot">&lt;-</span> NTags</span>
<span id="cb12-15"><a href="Survival.html#cb12-15" tabindex="-1"></a>    TagFate[i,i] <span class="ot">&lt;-</span>  TagsAtRisk[i,i] <span class="sc">*</span> r.true <span class="co"># Returns in release period</span></span>
<span id="cb12-16"><a href="Survival.html#cb12-16" tabindex="-1"></a>  j <span class="ot">&lt;-</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb12-17"><a href="Survival.html#cb12-17" tabindex="-1"></a>  <span class="cf">while</span>(j <span class="sc">&lt;=</span> Periods) {</span>
<span id="cb12-18"><a href="Survival.html#cb12-18" tabindex="-1"></a>      TagsAtRisk[i,j] <span class="ot">&lt;-</span> TagsAtRisk[i,(j<span class="dv">-1</span>)]<span class="sc">*</span>S.true</span>
<span id="cb12-19"><a href="Survival.html#cb12-19" tabindex="-1"></a>      TagFate[i,j] <span class="ot">&lt;-</span> TagsAtRisk[i,j] <span class="sc">*</span> r.true</span>
<span id="cb12-20"><a href="Survival.html#cb12-20" tabindex="-1"></a>      j <span class="ot">&lt;-</span> j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb12-21"><a href="Survival.html#cb12-21" tabindex="-1"></a>     } <span class="co">#while</span></span>
<span id="cb12-22"><a href="Survival.html#cb12-22" tabindex="-1"></a>   TagFate[i, Periods<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> NTags<span class="sc">-</span><span class="fu">sum</span>(TagFate[i,i<span class="sc">:</span>Periods]) <span class="co"># Tags not seen again</span></span>
<span id="cb12-23"><a href="Survival.html#cb12-23" tabindex="-1"></a>  } <span class="co">#i</span></span>
<span id="cb12-24"><a href="Survival.html#cb12-24" tabindex="-1"></a></span>
<span id="cb12-25"><a href="Survival.html#cb12-25" tabindex="-1"></a><span class="co">#Random trial (tags returned by period or not seen again)</span></span>
<span id="cb12-26"><a href="Survival.html#cb12-26" tabindex="-1"></a>RandRet <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(Periods, Periods<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb12-27"><a href="Survival.html#cb12-27" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>Periods) <span class="co"># Create upper diagonal matrix of random outcomes</span></span>
<span id="cb12-28"><a href="Survival.html#cb12-28" tabindex="-1"></a>  {</span>
<span id="cb12-29"><a href="Survival.html#cb12-29" tabindex="-1"></a>    RandRet[i,i<span class="sc">:</span>(Periods<span class="sc">+</span><span class="dv">1</span>)] <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">rmultinom</span>(<span class="dv">1</span>, NTags, TagFate[i,i<span class="sc">:</span>(Periods<span class="sc">+</span><span class="dv">1</span>)]))</span>
<span id="cb12-30"><a href="Survival.html#cb12-30" tabindex="-1"></a>  } <span class="co">#i</span></span></code></pre></div>
<p>Tags at risk are contained in an upper triangular matrix, with the diagonal element being the number released (NTags) and subsequent elements obtained as the previous number at risk multiplied by the survival rate. We arbitrarily assume Periods=3, a true survival rate (S.true) of 0.8 and a tag-recovery rate of 0.1. You should inspect the matrix by clicking on the name in the Environment window. The above parameters result in a vector of 1000, 800, and 640 tags at risk from a release in period 1. Cells in the matrix of fates are obtained as the number at risk times the tag-recovery rate, plus a final column for fish not seen again. The number released (1000) is arbitrary (and ambitious), but using a large value is helpful for reviewing the calculations that produce the two matrices. The parameter values can be changed to mimic any planned study design.</p>
<p>This section of code introduces a <code>while</code> loop. This different looping construct is needed because all rows except the last one include periods after the release. We need to be able to skip the additional processing in the last row, which has only the diagonal element. The final column for each row is the not-seen-again calculation. That value is highest for the most recent release, because most of those fish will still be alive. That uncertainty about whether fish are still at risk or have died is reduced by extending the number of periods for tag returns. Our example has the same number of releases and return periods, but the code could be modified to allow for additional periods of tag returns.</p>
<p>Inspecting the matrix of fates is helpful for understanding how survival is estimated. The expected tag returns within any column form ratios that equal the survival rate. For example, we would expect 80 tags returned in the second period from the first release compared to 100 from the second release, because the first release has been at large for one additional period. Similarly the ratio from successive rows of returns in period 3 also equal the survival rate. Thus we have several cells (and ratios) that provide information about survival, which we assumed to be constant over the three periods.</p>
<p>The final lines of code in this section introduce the stochasticity associated with a multinomial distribution. The matrix of fates (expected values) provide the cell probabilities (once rescaled, internal to the <code>rmultinom()</code> function). It is instructive to compare the expected values (TagFate) and random realizations (RandRet) to see the level of variability associated with the multinomial distribution. Now the ratios of random values within a column no longer equal (but will vary around) the true survival rate.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="Survival.html#cb13-1" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb13-2"><a href="Survival.html#cb13-2" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb13-3"><a href="Survival.html#cb13-3" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb13-4"><a href="Survival.html#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="Survival.html#cb13-5" tabindex="-1"></a><span class="co"># Specify model in JAGS</span></span>
<span id="cb13-6"><a href="Survival.html#cb13-6" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;TagReturn.txt&quot;</span>)</span>
<span id="cb13-7"><a href="Survival.html#cb13-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb13-8"><a href="Survival.html#cb13-8" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb13-9"><a href="Survival.html#cb13-9" tabindex="-1"></a><span class="st">  # Priors</span></span>
<span id="cb13-10"><a href="Survival.html#cb13-10" tabindex="-1"></a><span class="st">  S.est ~ dunif(0,1) # Time-independent survival rate</span></span>
<span id="cb13-11"><a href="Survival.html#cb13-11" tabindex="-1"></a><span class="st">  r.est ~ dunif(0,1) # Time-independent tag-recovery rate</span></span>
<span id="cb13-12"><a href="Survival.html#cb13-12" tabindex="-1"></a></span>
<span id="cb13-13"><a href="Survival.html#cb13-13" tabindex="-1"></a><span class="st">  # Calculated value</span></span>
<span id="cb13-14"><a href="Survival.html#cb13-14" tabindex="-1"></a><span class="st">  A.est &lt;- 1-S.est # Rate of mortality</span></span>
<span id="cb13-15"><a href="Survival.html#cb13-15" tabindex="-1"></a></span>
<span id="cb13-16"><a href="Survival.html#cb13-16" tabindex="-1"></a><span class="st"># Cell probabilities</span></span>
<span id="cb13-17"><a href="Survival.html#cb13-17" tabindex="-1"></a><span class="st">for (i in 1:Periods) {</span></span>
<span id="cb13-18"><a href="Survival.html#cb13-18" tabindex="-1"></a><span class="st">   p.est[i,i] &lt;- r.est</span></span>
<span id="cb13-19"><a href="Survival.html#cb13-19" tabindex="-1"></a><span class="st">   for (j in (i+1):Periods) {</span></span>
<span id="cb13-20"><a href="Survival.html#cb13-20" tabindex="-1"></a><span class="st">      p.est[i,j] &lt;- p.est[i,(j-1)] * S.est</span></span>
<span id="cb13-21"><a href="Survival.html#cb13-21" tabindex="-1"></a><span class="st">      } #j</span></span>
<span id="cb13-22"><a href="Survival.html#cb13-22" tabindex="-1"></a><span class="st">    p.est[i,Periods+1] &lt;- 1 - sum(p.est[i, i:Periods])</span></span>
<span id="cb13-23"><a href="Survival.html#cb13-23" tabindex="-1"></a><span class="st">    # Last column is prob of not being seen again</span></span>
<span id="cb13-24"><a href="Survival.html#cb13-24" tabindex="-1"></a><span class="st">    } #i</span></span>
<span id="cb13-25"><a href="Survival.html#cb13-25" tabindex="-1"></a></span>
<span id="cb13-26"><a href="Survival.html#cb13-26" tabindex="-1"></a><span class="st"># Likelihood</span></span>
<span id="cb13-27"><a href="Survival.html#cb13-27" tabindex="-1"></a><span class="st">  for (i in 1:Periods) {</span></span>
<span id="cb13-28"><a href="Survival.html#cb13-28" tabindex="-1"></a><span class="st">    RandRet[i,i:(Periods+1)] ~ dmulti(p.est[i,i:(Periods+1)], NTags)</span></span>
<span id="cb13-29"><a href="Survival.html#cb13-29" tabindex="-1"></a><span class="st">    }#i</span></span>
<span id="cb13-30"><a href="Survival.html#cb13-30" tabindex="-1"></a><span class="st"> } # model</span></span>
<span id="cb13-31"><a href="Survival.html#cb13-31" tabindex="-1"></a></span>
<span id="cb13-32"><a href="Survival.html#cb13-32" tabindex="-1"></a><span class="st">&quot;</span>,<span class="at">fill=</span><span class="cn">TRUE</span>)</span>
<span id="cb13-33"><a href="Survival.html#cb13-33" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb13-34"><a href="Survival.html#cb13-34" tabindex="-1"></a></span>
<span id="cb13-35"><a href="Survival.html#cb13-35" tabindex="-1"></a>     <span class="co"># Bundle data</span></span>
<span id="cb13-36"><a href="Survival.html#cb13-36" tabindex="-1"></a>  jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;RandRet&quot;</span>, <span class="st">&quot;Periods&quot;</span>, <span class="st">&quot;NTags&quot;</span>)</span>
<span id="cb13-37"><a href="Survival.html#cb13-37" tabindex="-1"></a></span>
<span id="cb13-38"><a href="Survival.html#cb13-38" tabindex="-1"></a>  S.init <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span><span class="dv">1</span>)</span>
<span id="cb13-39"><a href="Survival.html#cb13-39" tabindex="-1"></a>  r.init <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>S.init</span>
<span id="cb13-40"><a href="Survival.html#cb13-40" tabindex="-1"></a></span>
<span id="cb13-41"><a href="Survival.html#cb13-41" tabindex="-1"></a>  <span class="co"># Initial values</span></span>
<span id="cb13-42"><a href="Survival.html#cb13-42" tabindex="-1"></a>  jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){<span class="fu">list</span>(<span class="at">S.est =</span> S.init, <span class="at">r.est=</span>r.init)}</span>
<span id="cb13-43"><a href="Survival.html#cb13-43" tabindex="-1"></a></span>
<span id="cb13-44"><a href="Survival.html#cb13-44" tabindex="-1"></a>  model.file <span class="ot">&lt;-</span> <span class="st">&#39;TagReturn.txt&#39;</span></span>
<span id="cb13-45"><a href="Survival.html#cb13-45" tabindex="-1"></a></span>
<span id="cb13-46"><a href="Survival.html#cb13-46" tabindex="-1"></a>  <span class="co"># Parameters monitored</span></span>
<span id="cb13-47"><a href="Survival.html#cb13-47" tabindex="-1"></a>  jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;S.est&quot;</span>, <span class="st">&quot;r.est&quot;</span>, <span class="st">&quot;A.est&quot;</span>)</span>
<span id="cb13-48"><a href="Survival.html#cb13-48" tabindex="-1"></a></span>
<span id="cb13-49"><a href="Survival.html#cb13-49" tabindex="-1"></a>   <span class="co"># Call JAGS from R</span></span>
<span id="cb13-50"><a href="Survival.html#cb13-50" tabindex="-1"></a>  jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb13-51"><a href="Survival.html#cb13-51" tabindex="-1"></a>                  <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">4000</span>, <span class="at">n.burnin=</span><span class="dv">2000</span>,</span>
<span id="cb13-52"><a href="Survival.html#cb13-52" tabindex="-1"></a>                  model.file)</span>
<span id="cb13-53"><a href="Survival.html#cb13-53" tabindex="-1"></a>  <span class="fu">print</span>(jagsfit)</span>
<span id="cb13-54"><a href="Survival.html#cb13-54" tabindex="-1"></a>  <span class="fu">plot</span>(jagsfit)</span>
<span id="cb13-55"><a href="Survival.html#cb13-55" tabindex="-1"></a>  </span>
<span id="cb13-56"><a href="Survival.html#cb13-56" tabindex="-1"></a>  <span class="co"># Estimated posterior distributions</span></span>
<span id="cb13-57"><a href="Survival.html#cb13-57" tabindex="-1"></a><span class="fu">hist</span>(jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.array[,,<span class="dv">2</span>], <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Survival&quot;</span>)</span>
<span id="cb13-58"><a href="Survival.html#cb13-58" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>S.true, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb13-59"><a href="Survival.html#cb13-59" tabindex="-1"></a><span class="fu">hist</span>(jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.array[,,<span class="dv">4</span>], <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Tag recovery rate&quot;</span>)</span>
<span id="cb13-60"><a href="Survival.html#cb13-60" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>r.true, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p>The analysis begins with the usual uninformative priors for the two rates. We calculate the total mortality rate (A.est) as the complement of the survival rate (1-S.est). One important advantage of a Bayesian analysis is that we automatically obtain measures of uncertainty for functions of model parameters. Here the function is simply 1-S.est, but this advantage applies regardless of the function’s complexity.</p>
<p>The likelihood calculations (<code>dmulti()</code>) requires cell probabilities for the multinomial distribution, so we calculate those probabilities directly rather than keeping track of numbers of tags by fate. The probability of a tag from release i being returned in period j is <code>p.est[i,j] &lt;- p.est[i,(j-1)] * S.est</code>. Make sure that you understand this expression for specific values of i and j. Can you think of another way of coding this calculation? Note that <code>for</code> loops work differently in JAGS compared to R, so we are able to use them for row and column processing. In JAGS, the ‘j’ loop is not executed when i=3 because j&gt;Periods. Note that our initial value for the tag-recovery rate is obtained as 1-S.init. The tag recovery rate cannot exceed 1-S.init, and would typically be less due to the other possible outcome, natural death.</p>
<p>Estimates are typically reliable for this case (Figure <a href="Survival.html#fig:TagRetPlot">6.2</a>), which is not surprising given the very large releases and only two time-independent parameters to estimate. The estimated number of effective parameters was 1.9 for one run, which is consistent with the two apparent model parameters (S.est, r.est) and A.est which is simply a function of S.est.</p>
<div class="figure"><span style="display:block;" id="fig:TagRetPlot"></span>
<img src="bookdown_files/figure-html/TagRetPlot-1.png" alt="Example of estimated posterior distributions for survival and tag-recovery rates from 3-year tag-return study with annual releases of 1000 tagged fish. Red vertical lines indicate true values." width="45%" /><img src="bookdown_files/figure-html/TagRetPlot-2.png" alt="Example of estimated posterior distributions for survival and tag-recovery rates from 3-year tag-return study with annual releases of 1000 tagged fish. Red vertical lines indicate true values." width="45%" />
<p class="caption">
FIGURE 6.2: Example of estimated posterior distributions for survival and tag-recovery rates from 3-year tag-return study with annual releases of 1000 tagged fish. Red vertical lines indicate true values.
</p>
</div>
<p>If you think about a local system with which you are familiar, how practical would it be to tag 1000 fish at the start of each period (e.g., annually)? If you were responsible for planning the tagging operation, what sampling gear would you recommend? Would there be any potential concern about mortality due to handling? What size field crew would be needed and how much time would the tagging operation require? Could you use simulation to explore different sample sizes before recommending a specific field design?</p>
</div>
<div id="exercises-3" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Exercises<a href="Survival.html#exercises-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>For the default age-composition analysis without gear selectivity (Section <a href="Survival.html#AgeComp">6.1</a>), compare credible intervals for survival rate at sample sizes of 30 versus 200 fish.</p></li>
<li><p>For the telemetry method of estimating survival (Section <a href="Survival.html#TelemetryBased">6.2</a>), approximately what sample size would produce an estimate with the levels of precision recommended by <span class="citation">Robson and Regier (<a href="#ref-robson.regier1964">1964</a>)</span> for management (25%) or preliminary studies (50%)?</p></li>
<li><p>For the tag-return method (Section <a href="Survival.html#BrownieSurvival">6.3</a>), compare credible intervals for survival rate at releases of 50, 100, and 200 fish. How do the results compare to the <span class="citation">Robson and Regier (<a href="#ref-robson.regier1964">1964</a>)</span> recommendations? In what ways is this simulated field study optimistic about the reliability of results?</p></li>
</ol>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-allen_1997" class="csl-entry">
Allen, M. S. 1997. <span>“Effects of <span>Variable Recruitment</span> on <span>Catch-Curve Analysis</span> for <span>Crappie Populations</span>.”</span> <em>North American Journal of Fisheries Management</em> 17 (1): 202–5. <a href="https://doi.org/10.1577/1548-8675(1997)017&lt;0202:EOVROC&gt;2.3.CO;2">https://doi.org/10.1577/1548-8675(1997)017&lt;0202:EOVROC&gt;2.3.CO;2</a>.
</div>
<div id="ref-brownie.etal1985" class="csl-entry">
Brownie, Cavell, D. R. Anderson, K. P. Burnham, and D. S. Robson. 1985. <span>“Statistical Inference from Band Recovery Data: A Handbook.”</span> Federal Government Series 156. Resource <span>Publication</span>. Washington, D.C.: <span>U.S. Fish and Wildlife</span>. <a href="http://pubs.er.usgs.gov/publication/rp156">http://pubs.er.usgs.gov/publication/rp156</a>.
</div>
<div id="ref-campana2001" class="csl-entry">
Campana, S. E. 2001. <span>“Accuracy, Precision and Quality Control in Age Determination, Including a Review of the Use and Abuse of Age Validation Methods.”</span> <em>Journal of Fish Biology</em> 59 (2): 197–242. <a href="https://doi.org/10.1111/j.1095-8649.2001.tb00127.x">https://doi.org/10.1111/j.1095-8649.2001.tb00127.x</a>.
</div>
<div id="ref-hewitt.etal2010" class="csl-entry">
Hewitt, David A., Eric C. Janney, Brian S. Hayes, and Rip S. Shively. 2010. <span>“Improving Inferences from Fisheries Capture-Recapture Studies through Remote Detection of PIT Tags.”</span> <em>Fisheries</em> 35 (5): 217–31. <a href="https://doi.org/10.1577/1548-8446-35.5.217">https://doi.org/10.1577/1548-8446-35.5.217</a>.
</div>
<div id="ref-hightower.etal2015" class="csl-entry">
Hightower, Joseph E., Michael Loeffler, William C. Post, and Douglas L. Peterson. 2015. <span>“Estimated <span>Survival</span> of <span>Subadult</span> and <span>Adult Atlantic Sturgeon</span> in <span>Four River Basins</span> in the <span>Southeastern United States</span>.”</span> <em>Marine and Coastal Fisheries</em> 7 (1): 514–22. <a href="https://doi.org/10.1080/19425120.2015.1088491">https://doi.org/10.1080/19425120.2015.1088491</a>.
</div>
<div id="ref-jiang.etal2007" class="csl-entry">
Jiang, Honghua, Kenneth H. Pollock, Cavell Brownie, John M. Hoenig, Robert J. Latour, Brian K. Wells, and Joseph E. Hightower. 2007. <span>“Tag <span>Return Models Allowing</span> for <span>Harvest</span> and <span>Catch</span> and <span>Release</span>: <span>Evidence</span> of <span>Environmental</span> and <span>Management Impacts</span> on <span>Striped Bass Fishing</span> and <span>Natural Mortality Rates</span>.”</span> <em>North American Journal of Fisheries Management</em> 27 (2): 387–96. <a href="https://doi.org/10.1577/M06-089.1">https://doi.org/10.1577/M06-089.1</a>.
</div>
<div id="ref-kéry.schaub_2011" class="csl-entry">
Kéry, Marc, and Michael Schaub. 2011. <em>Bayesian <span>Population Analysis</span> Using <span>WinBUGS</span>: <span>A Hierarchical Perspective</span></em>. 1st edition. Boston: Academic Press.
</div>
<div id="ref-lorenzen1996" class="csl-entry">
Lorenzen, K. 1996. <span>“The Relationship Between Body Weight and Natural Mortality in Juvenile and Adult Fish: A Comparison of Natural Ecosystems and Aquaculture.”</span> <em>Journal of Fish Biology</em> 49 (4): 627–42. <a href="https://doi.org/10.1111/j.1095-8649.1996.tb00060.x">https://doi.org/10.1111/j.1095-8649.1996.tb00060.x</a>.
</div>
<div id="ref-mccarthy2007" class="csl-entry">
McCarthy, Michael A. 2007. <em>Bayesian <span>Methods</span> for <span>Ecology</span></em>. 1st edition. Cambridge, UK ; New York: Cambridge University Press.
</div>
<div id="ref-millar.meyer2000" class="csl-entry">
Millar, Russell B, and Renate Meyer. 2000. <span>“Bayesian State-Space Modeling of Age-Structured Data: Fitting a Model Is Just the Beginning.”</span> <em>Canadian Journal of Fisheries and Aquatic Sciences</em> 57 (1): 43–50. <a href="https://doi.org/10.1139/f99-169">https://doi.org/10.1139/f99-169</a>.
</div>
<div id="ref-ricker1975" class="csl-entry">
Ricker, William Edwin. 1975. <em>Computation and Interpretation of Biological Statistics of Fish Populations</em>. Bulletin 191. Ottawa: <span>Dept. of Fisheries and Oceans : Minister of Supply and Services Canada</span>.
</div>
<div id="ref-robson.regier1964" class="csl-entry">
Robson, D. S., and H. A. Regier. 1964. <span>“Sample <span>Size</span> in <span>Petersen Mark</span>–<span>Recapture Experiments</span>.”</span> <em>Transactions of the American Fisheries Society</em> 93 (3): 215–26. <a href="https://doi.org/10.1577/1548-8659(1964)93[215:SSIPME]2.0.CO;2">https://doi.org/10.1577/1548-8659(1964)93[215:SSIPME]2.0.CO;2</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Abundance.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Mortality.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-crc/edit/master/06-Survival.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown.pdf", "bookdown.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
