<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Growth | A Bayesian Introduction to Fish Population Analysis</title>
  <meta name="description" content="This book is intended to be a bridge between traditional fisheries analytical methods and Bayesian statistics. It is a hands-on introduction to models for estimating abundance, survival, growth, and recruitment." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Growth | A Bayesian Introduction to Fish Population Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book is intended to be a bridge between traditional fisheries analytical methods and Bayesian statistics. It is a hands-on introduction to models for estimating abundance, survival, growth, and recruitment." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Growth | A Bayesian Introduction to Fish Population Analysis" />
  
  <meta name="twitter:description" content="This book is intended to be a bridge between traditional fisheries analytical methods and Bayesian statistics. It is a hands-on introduction to models for estimating abundance, survival, growth, and recruitment." />
  

<meta name="author" content="Joseph E. Hightower" />


<meta name="date" content="2025-04-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Mortality.html"/>
<link rel="next" href="Recruit.html"/>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian fish population analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-information-and-conventions"><i class="fa fa-check"></i>Software information and conventions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="R-intro.html"><a href="R-intro.html"><i class="fa fa-check"></i><b>2</b> A Brief Introduction to R and RStudio</a></li>
<li class="chapter" data-level="3" data-path="Distributions.html"><a href="Distributions.html"><i class="fa fa-check"></i><b>3</b> Probability Distributions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Distributions.html"><a href="Distributions.html#Discrete"><i class="fa fa-check"></i><b>3.1</b> Discrete</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="Distributions.html"><a href="Distributions.html#Bernoulli"><i class="fa fa-check"></i><b>3.1.1</b> Bernoulli</a></li>
<li class="chapter" data-level="3.1.2" data-path="Distributions.html"><a href="Distributions.html#BinomialDist"><i class="fa fa-check"></i><b>3.1.2</b> Binomial</a></li>
<li class="chapter" data-level="3.1.3" data-path="Distributions.html"><a href="Distributions.html#Multinomial"><i class="fa fa-check"></i><b>3.1.3</b> Multinomial</a></li>
<li class="chapter" data-level="3.1.4" data-path="Distributions.html"><a href="Distributions.html#PoissonDist"><i class="fa fa-check"></i><b>3.1.4</b> Poisson</a></li>
<li class="chapter" data-level="3.1.5" data-path="Distributions.html"><a href="Distributions.html#NegBinom"><i class="fa fa-check"></i><b>3.1.5</b> Negative binomial</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="Distributions.html"><a href="Distributions.html#Continuous"><i class="fa fa-check"></i><b>3.2</b> Continuous</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="Distributions.html"><a href="Distributions.html#Uniform"><i class="fa fa-check"></i><b>3.2.1</b> Uniform</a></li>
<li class="chapter" data-level="3.2.2" data-path="Distributions.html"><a href="Distributions.html#BetaDist"><i class="fa fa-check"></i><b>3.2.2</b> Beta</a></li>
<li class="chapter" data-level="3.2.3" data-path="Distributions.html"><a href="Distributions.html#NormalDist"><i class="fa fa-check"></i><b>3.2.3</b> Normal</a></li>
<li class="chapter" data-level="3.2.4" data-path="Distributions.html"><a href="Distributions.html#LognormalDist"><i class="fa fa-check"></i><b>3.2.4</b> Lognormal</a></li>
<li class="chapter" data-level="3.2.5" data-path="Distributions.html"><a href="Distributions.html#GammaDist"><i class="fa fa-check"></i><b>3.2.5</b> Gamma</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="Distributions.html"><a href="Distributions.html#exercises"><i class="fa fa-check"></i><b>3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Model-fit.html"><a href="Model-fit.html"><i class="fa fa-check"></i><b>4</b> Model Fitting</a>
<ul>
<li class="chapter" data-level="4.1" data-path="Model-fit.html"><a href="Model-fit.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="Model-fit.html"><a href="Model-fit.html#Model-fit-sim"><i class="fa fa-check"></i><b>4.2</b> Using simulation</a></li>
<li class="chapter" data-level="4.3" data-path="Model-fit.html"><a href="Model-fit.html#JAGS-model-fit"><i class="fa fa-check"></i><b>4.3</b> Using Bayesian methods</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="Model-fit.html"><a href="Model-fit.html#FirstExampleBayesian"><i class="fa fa-check"></i><b>4.3.1</b> Example: mark-recapture</a></li>
<li class="chapter" data-level="4.3.2" data-path="Model-fit.html"><a href="Model-fit.html#Debug"><i class="fa fa-check"></i><b>4.3.2</b> Debugging code</a></li>
<li class="chapter" data-level="4.3.3" data-path="Model-fit.html"><a href="Model-fit.html#Convergence"><i class="fa fa-check"></i><b>4.3.3</b> Judging convergence</a></li>
<li class="chapter" data-level="4.3.4" data-path="Model-fit.html"><a href="Model-fit.html#Likelihood"><i class="fa fa-check"></i><b>4.3.4</b> What is a likelihood?</a></li>
<li class="chapter" data-level="4.3.5" data-path="Model-fit.html"><a href="Model-fit.html#Deviance"><i class="fa fa-check"></i><b>4.3.5</b> Deviance as a measure of model fit</a></li>
<li class="chapter" data-level="4.3.6" data-path="Model-fit.html"><a href="Model-fit.html#Model-checking"><i class="fa fa-check"></i><b>4.3.6</b> Model checking</a></li>
<li class="chapter" data-level="4.3.7" data-path="Model-fit.html"><a href="Model-fit.html#Model-selection"><i class="fa fa-check"></i><b>4.3.7</b> Model selection</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="Model-fit.html"><a href="Model-fit.html#exercises-1"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Abundance.html"><a href="Abundance.html"><i class="fa fa-check"></i><b>5</b> Abundance</a>
<ul>
<li class="chapter" data-level="5.1" data-path="Abundance.html"><a href="Abundance.html#Removal"><i class="fa fa-check"></i><b>5.1</b> Removal</a></li>
<li class="chapter" data-level="5.2" data-path="Abundance.html"><a href="Abundance.html#MarkRecap"><i class="fa fa-check"></i><b>5.2</b> Mark-recapture</a></li>
<li class="chapter" data-level="5.3" data-path="Abundance.html"><a href="Abundance.html#NMix"><i class="fa fa-check"></i><b>5.3</b> Binomial-mixture</a></li>
<li class="chapter" data-level="5.4" data-path="Abundance.html"><a href="Abundance.html#exercises-2"><i class="fa fa-check"></i><b>5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Survival.html"><a href="Survival.html"><i class="fa fa-check"></i><b>6</b> Survival</a>
<ul>
<li class="chapter" data-level="6.1" data-path="Survival.html"><a href="Survival.html#AgeComp"><i class="fa fa-check"></i><b>6.1</b> Age-composition</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="Survival.html"><a href="Survival.html#CC_Selectivity"><i class="fa fa-check"></i><b>6.1.1</b> Accounting for gear selectivity</a></li>
<li class="chapter" data-level="6.1.2" data-path="Survival.html"><a href="Survival.html#Cohort"><i class="fa fa-check"></i><b>6.1.2</b> Cohort model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="Survival.html"><a href="Survival.html#TelemetryBased"><i class="fa fa-check"></i><b>6.2</b> Telemetry-based</a></li>
<li class="chapter" data-level="6.3" data-path="Survival.html"><a href="Survival.html#BrownieSurvival"><i class="fa fa-check"></i><b>6.3</b> Tag-based</a></li>
<li class="chapter" data-level="6.4" data-path="Survival.html"><a href="Survival.html#exercises-3"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Mortality.html"><a href="Mortality.html"><i class="fa fa-check"></i><b>7</b> Mortality Components</a>
<ul>
<li class="chapter" data-level="7.1" data-path="Mortality.html"><a href="Mortality.html#ExpRate"><i class="fa fa-check"></i><b>7.1</b> Exploitation rate</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="Mortality.html"><a href="Mortality.html#InformativePriors"><i class="fa fa-check"></i><b>7.1.1</b> Informative prior distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="Mortality.html"><a href="Mortality.html#Hearn"><i class="fa fa-check"></i><b>7.2</b> Completed tagging study</a></li>
<li class="chapter" data-level="7.3" data-path="Mortality.html"><a href="Mortality.html#BrownieFandM"><i class="fa fa-check"></i><b>7.3</b> Multi-year tagging study</a></li>
<li class="chapter" data-level="7.4" data-path="Mortality.html"><a href="Mortality.html#TelemetryFandM"><i class="fa fa-check"></i><b>7.4</b> Telemetry-based</a></li>
<li class="chapter" data-level="7.5" data-path="Mortality.html"><a href="Mortality.html#exercises-4"><i class="fa fa-check"></i><b>7.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Growth.html"><a href="Growth.html"><i class="fa fa-check"></i><b>8</b> Growth</a>
<ul>
<li class="chapter" data-level="8.1" data-path="Growth.html"><a href="Growth.html#vonBert"><i class="fa fa-check"></i><b>8.1</b> Growth in length</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="Growth.html"><a href="Growth.html#Otolith"><i class="fa fa-check"></i><b>8.1.1</b> Age:length</a></li>
<li class="chapter" data-level="8.1.2" data-path="Growth.html"><a href="Growth.html#GrowthInc"><i class="fa fa-check"></i><b>8.1.2</b> Using tagging data</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="Growth.html"><a href="Growth.html#LnWgt"><i class="fa fa-check"></i><b>8.2</b> Growth in weight</a></li>
<li class="chapter" data-level="8.3" data-path="Growth.html"><a href="Growth.html#exercises-5"><i class="fa fa-check"></i><b>8.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Recruit.html"><a href="Recruit.html"><i class="fa fa-check"></i><b>9</b> Recruitment</a>
<ul>
<li class="chapter" data-level="9.1" data-path="Recruit.html"><a href="Recruit.html#Recruit-Fit"><i class="fa fa-check"></i><b>9.1</b> Fitting a stock-recruitment curve</a></li>
<li class="chapter" data-level="9.2" data-path="Recruit.html"><a href="Recruit.html#Recruit-DIC"><i class="fa fa-check"></i><b>9.2</b> Does spawning stock size affect recruitment?</a></li>
<li class="chapter" data-level="9.3" data-path="Recruit.html"><a href="Recruit.html#exercises-6"><i class="fa fa-check"></i><b>9.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="PopModels.html"><a href="PopModels.html"><i class="fa fa-check"></i><b>10</b> Integrated Population Models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="PopModels.html"><a href="PopModels.html#TwoAge"><i class="fa fa-check"></i><b>10.1</b> Two-age model</a></li>
<li class="chapter" data-level="10.2" data-path="PopModels.html"><a href="PopModels.html#CAGEAN"><i class="fa fa-check"></i><b>10.2</b> Full age-structured model</a></li>
<li class="chapter" data-level="10.3" data-path="PopModels.html"><a href="PopModels.html#exercises-7"><i class="fa fa-check"></i><b>10.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="FinalThoughts.html"><a href="FinalThoughts.html"><i class="fa fa-check"></i><b>11</b> Final Thoughts</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="empirical-examples.html"><a href="empirical-examples.html"><i class="fa fa-check"></i><b>A</b> Empirical Examples</a>
<ul>
<li class="chapter" data-level="A.1" data-path="empirical-examples.html"><a href="empirical-examples.html#RemovalRealData"><i class="fa fa-check"></i><b>A.1</b> Abundance: Removal</a></li>
<li class="chapter" data-level="A.2" data-path="empirical-examples.html"><a href="empirical-examples.html#MarkRecapRealData"><i class="fa fa-check"></i><b>A.2</b> Abundance: Mark-recapture</a></li>
<li class="chapter" data-level="A.3" data-path="empirical-examples.html"><a href="empirical-examples.html#AgeCompRealData"><i class="fa fa-check"></i><b>A.3</b> Survival: Age-composition</a></li>
<li class="chapter" data-level="A.4" data-path="empirical-examples.html"><a href="empirical-examples.html#BrownieSurvivalRealData"><i class="fa fa-check"></i><b>A.4</b> Survival: Tag-based</a></li>
<li class="chapter" data-level="A.5" data-path="empirical-examples.html"><a href="empirical-examples.html#vonBertRealData"><i class="fa fa-check"></i><b>A.5</b> Growth: age:length</a></li>
<li class="chapter" data-level="A.6" data-path="empirical-examples.html"><a href="empirical-examples.html#Recruit-FitRealData"><i class="fa fa-check"></i><b>A.6</b> Recruitment: Beverton-Holt curve</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Bayesian Introduction to Fish Population Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Growth" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Growth<a href="Growth.html#Growth" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Growth is a basic aspect of a fish’s life history, but it is also an important process to consider in managing fish populations. For example, a minimum size limit for harvest might be used to increase the proportion of fish surviving to the size (and age) of sexual maturity. Another consideration in developing a harvest strategy is finding a balance between the growth rate (increasing the size of each individual in a cohort) and the loss rate due to natural mortality (reducing the number of individuals in a cohort).</p>
<p>There are typically two aspects to growth modeling: age versus length and length versus weight. With those two equations, it is possible to predict the length or weight at any age, and to examine harvest strategies using minimum size or slot (legal harvest between lower and upper limits) regulations. The focus in commercial marine fisheries is typically on weight because income from commercial fishing is a function of weight of the catch. Length gets more emphasis in freshwater fisheries management because anglers are not selling their catches (and trophy designations are generally length-based).</p>
<div id="vonBert" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Growth in length<a href="Growth.html#vonBert" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The relationship between age and length for adult fish usually is a curve of decreasing slope; that is, growth gradually slows with age as individuals approach some average maximum size. The equation most often used for age and length is the von Bertalanffy growth function: <span class="math inline">\(L_t=L_\infty*(1-e^{-k*(t-t_0)})\)</span>. This equation for size at time ‘t’ has three parameters: the asymptotic size or average maximum length (<span class="math inline">\(L_\infty\)</span>), growth rate (<span class="math inline">\(k\)</span>), and time (age) at length of 0 (<span class="math inline">\(t_0\)</span>). The last parameter is a theoretical one rather than something that is observed. It can take on positive or negative values, and can be thought of as an extrapolation from sizes at older ages.</p>
<p>In the following sections, we fit von Bertalanffy growth curves using two sources of data: paired age:length observations from a laboratory examination of otoliths or other hard parts that form annual marks <span class="citation">(<a href="#ref-campana2001">Campana 2001</a>)</span>, or a tagging study.</p>
<div id="Otolith" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Age:length<a href="Growth.html#Otolith" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Age:length observations may come from a survey or from sampling a fishery. Some ageing error invariably occurs when interpreting otoliths or other hard parts <span class="citation">(<a href="#ref-campana2001">Campana 2001</a>)</span>, but for simplicity I assume that the ages are determined without error. I further assume that fish are not sampled randomly but are instead a systematic sample by age. This ensures that the data set includes less common ages (sizes), particularly older fish.</p>
<p>The first step in fitting the model is to generate a simulated age:length data set.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="Growth.html#cb73-1" tabindex="-1"></a><span class="co"># Fitting von Bertalanffy curve to simulated data</span></span>
<span id="cb73-2"><a href="Growth.html#cb73-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb73-3"><a href="Growth.html#cb73-3" tabindex="-1"></a></span>
<span id="cb73-4"><a href="Growth.html#cb73-4" tabindex="-1"></a><span class="co"># Choose von Bertalanffy parameter values and other simulation settings</span></span>
<span id="cb73-5"><a href="Growth.html#cb73-5" tabindex="-1"></a>L_inf <span class="ot">&lt;-</span> <span class="dv">80</span>  <span class="co"># e.g., 80-cm fish</span></span>
<span id="cb73-6"><a href="Growth.html#cb73-6" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fl">0.3</span> <span class="co"># Slope</span></span>
<span id="cb73-7"><a href="Growth.html#cb73-7" tabindex="-1"></a>t_0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span> <span class="co"># Age at length 0</span></span>
<span id="cb73-8"><a href="Growth.html#cb73-8" tabindex="-1"></a>MaxAge <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb73-9"><a href="Growth.html#cb73-9" tabindex="-1"></a>SystSample <span class="ot">&lt;-</span> <span class="dv">5</span>  <span class="co"># Number per age group</span></span>
<span id="cb73-10"><a href="Growth.html#cb73-10" tabindex="-1"></a>N.AgeLen <span class="ot">&lt;-</span> SystSample <span class="sc">*</span> MaxAge</span>
<span id="cb73-11"><a href="Growth.html#cb73-11" tabindex="-1"></a>Age <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>MaxAge, <span class="at">each=</span>SystSample)</span>
<span id="cb73-12"><a href="Growth.html#cb73-12" tabindex="-1"></a>Var_L <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># Variance about age:length relationship</span></span>
<span id="cb73-13"><a href="Growth.html#cb73-13" tabindex="-1"></a>Len <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>N.AgeLen,L_inf<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>k<span class="sc">*</span>(Age<span class="sc">-</span>t_0))), <span class="at">sd=</span><span class="fu">sqrt</span>(Var_L))</span>
<span id="cb73-14"><a href="Growth.html#cb73-14" tabindex="-1"></a></span>
<span id="cb73-15"><a href="Growth.html#cb73-15" tabindex="-1"></a><span class="fu">plot</span>(Age, Len, <span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Length (cm)&quot;</span>)</span></code></pre></div>
<p>The parameter values and other simulation settings provide a reasonable sample size and well-defined growth pattern and asymptote. The latter characteristic is critical in obtaining reliable results. For real data sets, it is always worthwhile to look at the shape of the scatterplot of length versus age. Data sets with few young fish or lacking a well-defined asymptote will often result in poor estimates. Our simulation uses integer ages but fractional (real-valued) ages could be used if there was good information about the timing of spawning and formation of annual marks on hard parts. Using fractional ages would be more important for short-lived species. The model fitting process is the same whether using integer or fractional ages.</p>
<p>We assume an additive error term; i.e., variability in length at age is constant. Whether an additive or multiplicative error term is appropriate can often be seen by examining a scatterplot of length versus age. A multiplicative error term would be called for if points have greater spread for older fish.</p>
<div style="page-break-after: always;"></div>
<p>The JAGS code for fitting the model is generally similar to the simulation, except that the <code>dnorm()</code> function for the likelihood requires precision, defined as the inverse of the variance. Vague uniform priors are used for all four parameters. The prior distribution ranges and initial values may need to be adjusted if the range of simulated (or observed) lengths is varied. Note that max(Len) is used as a convenient upper bound for initial values of <span class="math inline">\(L_\infty\)</span>, but a fixed value greater than observed lengths could also be used.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="Growth.html#cb74-1" tabindex="-1"></a><span class="co"># Load necessary library packages</span></span>
<span id="cb74-2"><a href="Growth.html#cb74-2" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb74-3"><a href="Growth.html#cb74-3" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb74-4"><a href="Growth.html#cb74-4" tabindex="-1"></a></span>
<span id="cb74-5"><a href="Growth.html#cb74-5" tabindex="-1"></a><span class="co"># JAGS code</span></span>
<span id="cb74-6"><a href="Growth.html#cb74-6" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;GrowthCurve.txt&quot;</span>)</span>
<span id="cb74-7"><a href="Growth.html#cb74-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb74-8"><a href="Growth.html#cb74-8" tabindex="-1"></a><span class="st">model{</span></span>
<span id="cb74-9"><a href="Growth.html#cb74-9" tabindex="-1"></a></span>
<span id="cb74-10"><a href="Growth.html#cb74-10" tabindex="-1"></a><span class="st"># Priors</span></span>
<span id="cb74-11"><a href="Growth.html#cb74-11" tabindex="-1"></a></span>
<span id="cb74-12"><a href="Growth.html#cb74-12" tabindex="-1"></a><span class="st"> L_inf.est ~ dunif(0, 200)</span></span>
<span id="cb74-13"><a href="Growth.html#cb74-13" tabindex="-1"></a><span class="st"> k.est ~ dunif(0, 2)</span></span>
<span id="cb74-14"><a href="Growth.html#cb74-14" tabindex="-1"></a><span class="st"> t0.est ~ dunif(-5, 5)</span></span>
<span id="cb74-15"><a href="Growth.html#cb74-15" tabindex="-1"></a><span class="st"> Var_L.est ~ dunif(0,100)   # Variability in length at age</span></span>
<span id="cb74-16"><a href="Growth.html#cb74-16" tabindex="-1"></a></span>
<span id="cb74-17"><a href="Growth.html#cb74-17" tabindex="-1"></a><span class="st"># Calculated value</span></span>
<span id="cb74-18"><a href="Growth.html#cb74-18" tabindex="-1"></a><span class="st"> tau.est &lt;- 1/Var_L.est</span></span>
<span id="cb74-19"><a href="Growth.html#cb74-19" tabindex="-1"></a></span>
<span id="cb74-20"><a href="Growth.html#cb74-20" tabindex="-1"></a><span class="st"># Likelihood</span></span>
<span id="cb74-21"><a href="Growth.html#cb74-21" tabindex="-1"></a><span class="st"> for (i in 1:N.AgeLen) {</span></span>
<span id="cb74-22"><a href="Growth.html#cb74-22" tabindex="-1"></a><span class="st">    Len_hat[i] &lt;- L_inf.est*(1-exp(-k.est*(Age[i]-t0.est)))</span></span>
<span id="cb74-23"><a href="Growth.html#cb74-23" tabindex="-1"></a><span class="st">    Len[i] ~ dnorm(Len_hat[i], tau.est)</span></span>
<span id="cb74-24"><a href="Growth.html#cb74-24" tabindex="-1"></a><span class="st"> } #i</span></span>
<span id="cb74-25"><a href="Growth.html#cb74-25" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb74-26"><a href="Growth.html#cb74-26" tabindex="-1"></a><span class="st">    &quot;</span>,<span class="at">fill=</span><span class="cn">TRUE</span>)</span>
<span id="cb74-27"><a href="Growth.html#cb74-27" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb74-28"><a href="Growth.html#cb74-28" tabindex="-1"></a></span>
<span id="cb74-29"><a href="Growth.html#cb74-29" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb74-30"><a href="Growth.html#cb74-30" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;N.AgeLen&quot;</span>, <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Len&quot;</span>)</span>
<span id="cb74-31"><a href="Growth.html#cb74-31" tabindex="-1"></a></span>
<span id="cb74-32"><a href="Growth.html#cb74-32" tabindex="-1"></a><span class="co"># Initial values</span></span>
<span id="cb74-33"><a href="Growth.html#cb74-33" tabindex="-1"></a>jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){<span class="fu">list</span>(<span class="at">L_inf.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="fu">max</span>(Len)),</span>
<span id="cb74-34"><a href="Growth.html#cb74-34" tabindex="-1"></a>                              <span class="at">k.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">2</span>),</span>
<span id="cb74-35"><a href="Growth.html#cb74-35" tabindex="-1"></a>                              <span class="at">t0.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="sc">-</span><span class="dv">5</span>, <span class="at">max=</span><span class="dv">5</span>),</span>
<span id="cb74-36"><a href="Growth.html#cb74-36" tabindex="-1"></a>                              <span class="at">Var_L.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">100</span>))}</span>
<span id="cb74-37"><a href="Growth.html#cb74-37" tabindex="-1"></a></span>
<span id="cb74-38"><a href="Growth.html#cb74-38" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;GrowthCurve.txt&#39;</span></span>
<span id="cb74-39"><a href="Growth.html#cb74-39" tabindex="-1"></a></span>
<span id="cb74-40"><a href="Growth.html#cb74-40" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb74-41"><a href="Growth.html#cb74-41" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;L_inf.est&quot;</span>, <span class="st">&quot;k.est&quot;</span>, <span class="st">&quot;t0.est&quot;</span>, <span class="st">&quot;Var_L.est&quot;</span>)</span>
<span id="cb74-42"><a href="Growth.html#cb74-42" tabindex="-1"></a></span>
<span id="cb74-43"><a href="Growth.html#cb74-43" tabindex="-1"></a><span class="co"># Call JAGS from R</span></span>
<span id="cb74-44"><a href="Growth.html#cb74-44" tabindex="-1"></a>jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb74-45"><a href="Growth.html#cb74-45" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">10000</span>,</span>
<span id="cb74-46"><a href="Growth.html#cb74-46" tabindex="-1"></a>                model.file)</span>
<span id="cb74-47"><a href="Growth.html#cb74-47" tabindex="-1"></a><span class="fu">print</span>(jagsfit)</span>
<span id="cb74-48"><a href="Growth.html#cb74-48" tabindex="-1"></a><span class="fu">plot</span>(jagsfit)</span></code></pre></div>
<p>Convergence is generally rapid, and the estimates from simulated data are reliable. Try varying some of the simulation settings and parameter values to see how the model performs under different conditions. For example, note how the growth curve changes as you try different values for the von Bertalanffy growth parameters and the variance about the curve. One caution is to ensure that the assumed additive error term does not produce negative length values. If that occurs, one solution would be to switch to a multiplicative error term, using a lognormal rather than a normal distribution; see Section <a href="Growth.html#LnWgt">8.2</a>. Another setting to vary is the maximum age. A low value, as might occur if the population was heavily exploited, can make it difficult to estimate <span class="math inline">\(L_\infty\)</span>. A Bayesian approach for dealing with limited data is to use an informative prior distribution <span class="citation">(<a href="#ref-doll.jacquemin_2018">Doll and Jacquemin 2018</a>)</span>. This curve is particularly well suited to use of informative priors, given the wealth of published information about fish growth and von Bertalanffy parameters.</p>
<p>The uniform prior distributions chosen for this example were intended to be uninformative, and additional testing with large sample sizes showed no apparent bias. <span class="citation">Lemoine (<a href="#ref-lemoine_2019">2019</a>)</span> argues against using priors with fixed limits and instead recommends using an unbounded, positive-only distribution. Trying multiple priors is a practical way to establish that the results are robust to the particular distributions chosen. For example, similar results were obtained when using a vague lognormal prior (e.g., <code>dlnorm(0,1E-6))</code> with initial values from <code>rlnorm(n=1, meanlog=0, sdlog=0.5)</code>) for <span class="math inline">\(L_\infty\)</span>, <span class="math inline">\(k\)</span>, and Var_L, which are restricted to positive values. A vague normal distribution (e.g., <code>dnorm(0,1E-6))</code>, with initial values from <code>rnorm(n=1, mean=0, sd=1)</code>) was used for <span class="math inline">\(t_0\)</span>, which can take on positive or negative values. Note that the model structure can affect whether a prior distribution is uninformative <span class="citation">(<a href="#ref-mccarthy_2007">McCarthy 2007</a>)</span>. For example, the uniform prior for Var_L will not be flat when transformed to calculate precision (tau). In general, a prior distribution chosen to be uninformative will not be for transformed parameters. One way of examining this issue for the growth model would be to fit the model using a prior for tau (so that Var_L is the calculated value). Test runs with large sample sizes showed similar results for the original model and when a vague uniform prior was used for tau.</p>
<p>An empirical example <span class="citation">(<a href="#ref-quinn.deriso_1999">Quinn and Deriso 1999</a>)</span> of fitting a von Bertalanffy growth curve to age and length data for rougheye rockfish (<em>Sebastes aleutianus</em>) is included as Appendix <a href="empirical-examples.html#vonBertRealData">A.5</a>.</p>
</div>
<div id="GrowthInc" class="section level3 hasAnchor" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Using tagging data<a href="Growth.html#GrowthInc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Growth information can also be obtained from a tagging study <span class="citation">(<a href="#ref-wang.etal1995">Wang, Thomas, and Somers 1995</a>; <a href="#ref-zhang.etal2009">Zhang, Lessard, and Campbell 2009</a>; <a href="#ref-scherrer.etal2021">Scherrer et al. 2021</a>)</span>. Fish seen on two or more occasions provide information on growth as a function of size at initial capture, time-at-large (interval between tagging and a subsequent recapture) and the growth increment. This approach differs from using age and length data because age at tagging is not known. However, it can be made compatible with a traditional age:length analysis by estimating relative age (true age - <span class="math inline">\(t_0\)</span>) of all individuals as additional parameters <span class="citation">(<a href="#ref-wang.etal1995">Wang, Thomas, and Somers 1995</a>; <a href="#ref-zhang.etal2009">Zhang, Lessard, and Campbell 2009</a>; <a href="#ref-scherrer.etal2021">Scherrer et al. 2021</a>)</span>. This allows growth to be modeled as a function of age rather than size. Flexible versions of these models can allow for separate growth parameters (<span class="math inline">\(L_\infty\)</span>, k) for each individual. Here we fit a simpler model <span class="citation">(Model 4 of <a href="#ref-scherrer.etal2021">Scherrer et al. 2021</a>)</span> with all individuals sharing <span class="math inline">\(L_\infty\)</span> and k. It is straightforward to modify the code to allow for either or both parameters to vary among individuals <span class="citation">(<a href="#ref-scherrer.etal2021">Scherrer et al. 2021</a>)</span>.</p>
<p>One important practical question is how to obtain length data when fish are encountered after tagging. Using lengths from fishers provides the greatest sample size but runs the risk of substantial measurement error or outright bias, if an angler “estimates” the length. Length data obtained by biologists limits the sample size but ensures data quality, and could be obtained through field survey sampling or fishery monitoring by creel clerks or at-sea observers. In order for our results to apply to the whole population, we also assume that growth is the same for tagged and untagged fish. The model allows for measurement error and other sources of variability (e.g., environmental, genetic) that cause individual fish lengths to vary about the fitted curve. A constant additive error is assumed here, but the model could be modified to allow for a multiplicative error term. We begin with simulation code for generating the observations:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="Growth.html#cb75-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb75-2"><a href="Growth.html#cb75-2" tabindex="-1"></a></span>
<span id="cb75-3"><a href="Growth.html#cb75-3" tabindex="-1"></a>L_inf <span class="ot">&lt;-</span> <span class="dv">80</span>  <span class="co"># e.g., 80-cm fish</span></span>
<span id="cb75-4"><a href="Growth.html#cb75-4" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fl">0.3</span> <span class="co"># Slope</span></span>
<span id="cb75-5"><a href="Growth.html#cb75-5" tabindex="-1"></a>Var_L <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># Variance about age:length relationship</span></span>
<span id="cb75-6"><a href="Growth.html#cb75-6" tabindex="-1"></a>N.Tag <span class="ot">&lt;-</span> <span class="dv">120</span> <span class="co"># Number of fish recaptured at least once</span></span>
<span id="cb75-7"><a href="Growth.html#cb75-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N.Tag, <span class="at">lambda=</span><span class="fl">0.1</span>)<span class="sc">+</span><span class="dv">2</span> </span>
<span id="cb75-8"><a href="Growth.html#cb75-8" tabindex="-1"></a>  <span class="co"># Number of encounters for each recaptured individual, &gt;2 uncommon</span></span>
<span id="cb75-9"><a href="Growth.html#cb75-9" tabindex="-1"></a></span>
<span id="cb75-10"><a href="Growth.html#cb75-10" tabindex="-1"></a><span class="co"># Generate vector for relative age at initial capture (true age + t0)</span></span>
<span id="cb75-11"><a href="Growth.html#cb75-11" tabindex="-1"></a>Shape <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># Parameters for gamma distribution generating relative ages</span></span>
<span id="cb75-12"><a href="Growth.html#cb75-12" tabindex="-1"></a>Rate <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb75-13"><a href="Growth.html#cb75-13" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n=</span>N.Tag, <span class="at">shape=</span>Shape, <span class="at">rate=</span>Rate) <span class="co"># Relative age vector</span></span>
<span id="cb75-14"><a href="Growth.html#cb75-14" tabindex="-1"></a><span class="fu">hist</span>(A, <span class="at">xlab=</span><span class="st">&quot;Relative age&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb75-15"><a href="Growth.html#cb75-15" tabindex="-1"></a></span>
<span id="cb75-16"><a href="Growth.html#cb75-16" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(N.Tag, <span class="fu">max</span>(n)))</span>
<span id="cb75-17"><a href="Growth.html#cb75-17" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(N.Tag, <span class="fu">max</span>(n)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb75-18"><a href="Growth.html#cb75-18" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N.Tag){</span>
<span id="cb75-19"><a href="Growth.html#cb75-19" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n[i]<span class="sc">-</span><span class="dv">1</span>)){</span>
<span id="cb75-20"><a href="Growth.html#cb75-20" tabindex="-1"></a>    dt[i,j] <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">shape=</span><span class="dv">6</span>, <span class="at">rate=</span><span class="dv">2</span>) </span>
<span id="cb75-21"><a href="Growth.html#cb75-21" tabindex="-1"></a>      <span class="co"># Random dist of times at large</span></span>
<span id="cb75-22"><a href="Growth.html#cb75-22" tabindex="-1"></a>  }</span>
<span id="cb75-23"><a href="Growth.html#cb75-23" tabindex="-1"></a>}</span>
<span id="cb75-24"><a href="Growth.html#cb75-24" tabindex="-1"></a><span class="fu">hist</span>(dt, <span class="at">xlab=</span><span class="st">&quot;Time at large&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb75-25"><a href="Growth.html#cb75-25" tabindex="-1"></a></span>
<span id="cb75-26"><a href="Growth.html#cb75-26" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N.Tag){</span>
<span id="cb75-27"><a href="Growth.html#cb75-27" tabindex="-1"></a>  L[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">mean=</span>L_inf <span class="sc">*</span>(<span class="fl">1.0</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>k<span class="sc">*</span>A[i])), <span class="fu">sqrt</span>(Var_L))</span>
<span id="cb75-28"><a href="Growth.html#cb75-28" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n[i]){</span>
<span id="cb75-29"><a href="Growth.html#cb75-29" tabindex="-1"></a>    L[i, j] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span><span class="dv">1</span>, L_inf<span class="sc">*</span>(<span class="fl">1.0</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>k<span class="sc">*</span>(A[i]<span class="sc">+</span>dt[i, j<span class="dv">-1</span>]))), </span>
<span id="cb75-30"><a href="Growth.html#cb75-30" tabindex="-1"></a>                     <span class="fu">sqrt</span>(Var_L))</span>
<span id="cb75-31"><a href="Growth.html#cb75-31" tabindex="-1"></a>  } <span class="co">#j</span></span>
<span id="cb75-32"><a href="Growth.html#cb75-32" tabindex="-1"></a>} <span class="co">#i</span></span>
<span id="cb75-33"><a href="Growth.html#cb75-33" tabindex="-1"></a></span>
<span id="cb75-34"><a href="Growth.html#cb75-34" tabindex="-1"></a><span class="fu">plot</span>(A, L[,<span class="dv">1</span>], <span class="at">xlab=</span><span class="st">&quot;Relative age&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Length at first capture&quot;</span>)</span>
<span id="cb75-35"><a href="Growth.html#cb75-35" tabindex="-1"></a><span class="fu">plot</span>(dt[,<span class="dv">1</span>], (L[,<span class="dv">2</span>]<span class="sc">-</span>L[,<span class="dv">1</span>]), <span class="at">xlab=</span><span class="st">&quot;Time at large&quot;</span>, </span>
<span id="cb75-36"><a href="Growth.html#cb75-36" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Growth increment&quot;</span>)</span>
<span id="cb75-37"><a href="Growth.html#cb75-37" tabindex="-1"></a><span class="fu">plot</span>(L[,<span class="dv">1</span>], (L[,<span class="dv">2</span>]<span class="sc">-</span>L[,<span class="dv">1</span>]), <span class="at">xlab=</span><span class="st">&quot;Length at first capture&quot;</span>, </span>
<span id="cb75-38"><a href="Growth.html#cb75-38" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Growth increment&quot;</span>)</span></code></pre></div>
<p>Choices for the growth parameters are arbitrary but should produce a well-defined asymptote when combined with the other settings (time-at-large, relative age). The sample size of fish recaptured at least once is relatively robust but can of course be varied to judge model performance given fewer or more individuals. To allow for random variation in the tagging data set, a Poisson distribution (Section <a href="Distributions.html#PoissonDist">3.1.4</a>) is used to generate the number of encounters for each individual. Each individual is seen at least twice, but the lambda parameter can be adjusted to vary the typical number of encounters (use <code>hist(n)</code> to see distribution). As in previous studies <span class="citation">(<a href="#ref-wang.etal1995">Wang, Thomas, and Somers 1995</a>; <a href="#ref-zhang.etal2009">Zhang, Lessard, and Campbell 2009</a>; <a href="#ref-scherrer.etal2021">Scherrer et al. 2021</a>)</span>, we use a gamma distribution (Section <a href="Distributions.html#GammaDist">3.2.5</a>) for relative age. The two gamma parameters (shape and rate) can be varied to obtain relative age distributions with desired characteristics (as observed on the <code>hist()</code> plot). Here they are chosen to provide a data set of mostly younger fish. Times-at-large are also generated using a gamma distribution, with shape and rate settings chosen to obtain a realistic pattern (mostly shorter times). Three plots are used to examine the tagging data set. The first (relative age versus length) may not have a well-defined asymptote if mostly younger fish are tagged. The plot can be examined to ensure that the chosen variance in length at age is reasonable (and not generating negative lengths). The second and third plots are noisy and difficult to interpret because growth increment is a function of both time-at-large and size-at-tagging. They are nevertheless useful for ensuring that the data set encompasses the early faster-growing period and slowed growth near the asymptote.</p>
<p>The JAGS code for fitting the model uses uninformative uniform prior distributions for the two growth parameters, variance in length-at-age, and the two gamma hyperparameters that describe the distribution of relative ages.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="Growth.html#cb76-1" tabindex="-1"></a><span class="co"># Load necessary library packages</span></span>
<span id="cb76-2"><a href="Growth.html#cb76-2" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb76-3"><a href="Growth.html#cb76-3" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb76-4"><a href="Growth.html#cb76-4" tabindex="-1"></a></span>
<span id="cb76-5"><a href="Growth.html#cb76-5" tabindex="-1"></a><span class="co"># JAGS code</span></span>
<span id="cb76-6"><a href="Growth.html#cb76-6" tabindex="-1"></a><span class="co"># Code modified from Scherrer et al. 2021: model 4</span></span>
<span id="cb76-7"><a href="Growth.html#cb76-7" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;vonBert_GrowthInc.txt&quot;</span>)</span>
<span id="cb76-8"><a href="Growth.html#cb76-8" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb76-9"><a href="Growth.html#cb76-9" tabindex="-1"></a><span class="st">model{</span></span>
<span id="cb76-10"><a href="Growth.html#cb76-10" tabindex="-1"></a><span class="st"># Priors</span></span>
<span id="cb76-11"><a href="Growth.html#cb76-11" tabindex="-1"></a><span class="st">  Var_L.est ~ dunif(0, 100) # Variance about expected length</span></span>
<span id="cb76-12"><a href="Growth.html#cb76-12" tabindex="-1"></a><span class="st">  tau.est &lt;- 1/Var_L.est # Precision</span></span>
<span id="cb76-13"><a href="Growth.html#cb76-13" tabindex="-1"></a><span class="st">    k.est ~ dunif(0, 2)</span></span>
<span id="cb76-14"><a href="Growth.html#cb76-14" tabindex="-1"></a><span class="st">    L_inf.est ~ dunif(0, 200)</span></span>
<span id="cb76-15"><a href="Growth.html#cb76-15" tabindex="-1"></a><span class="st">    Shape.est ~ dunif(0, 100) # Gamma hyperparameters for relative age</span></span>
<span id="cb76-16"><a href="Growth.html#cb76-16" tabindex="-1"></a><span class="st">    Rate.est ~ dunif(0, 100)</span></span>
<span id="cb76-17"><a href="Growth.html#cb76-17" tabindex="-1"></a></span>
<span id="cb76-18"><a href="Growth.html#cb76-18" tabindex="-1"></a><span class="st">    # Likelihood</span></span>
<span id="cb76-19"><a href="Growth.html#cb76-19" tabindex="-1"></a><span class="st">    for (i in 1:N.Tag)   {</span></span>
<span id="cb76-20"><a href="Growth.html#cb76-20" tabindex="-1"></a><span class="st">        A.est[i] ~ dgamma(Shape.est, Rate.est)</span></span>
<span id="cb76-21"><a href="Growth.html#cb76-21" tabindex="-1"></a><span class="st">          # Relative age (true age + t0)</span></span>
<span id="cb76-22"><a href="Growth.html#cb76-22" tabindex="-1"></a><span class="st">        L_Exp[i, 1] &lt;-   L_inf.est *(1.0 - exp(-k.est*A.est[i])) </span></span>
<span id="cb76-23"><a href="Growth.html#cb76-23" tabindex="-1"></a><span class="st">          # Expected length at capture</span></span>
<span id="cb76-24"><a href="Growth.html#cb76-24" tabindex="-1"></a><span class="st">        L[i, 1] ~ dnorm(L_Exp[i, 1], tau.est) </span></span>
<span id="cb76-25"><a href="Growth.html#cb76-25" tabindex="-1"></a><span class="st">          # Length at initial capture</span></span>
<span id="cb76-26"><a href="Growth.html#cb76-26" tabindex="-1"></a><span class="st">        for (j in 2:n[i])   { # Recapture lengths</span></span>
<span id="cb76-27"><a href="Growth.html#cb76-27" tabindex="-1"></a><span class="st">            L_Exp[i, j] &lt;-  L_inf.est*(1.0 -</span></span>
<span id="cb76-28"><a href="Growth.html#cb76-28" tabindex="-1"></a><span class="st">                              exp(-k.est*(A.est[i]+dt[i, j-1])))</span></span>
<span id="cb76-29"><a href="Growth.html#cb76-29" tabindex="-1"></a><span class="st">            L[i, j] ~ dnorm(L_Exp[i, j], tau.est)</span></span>
<span id="cb76-30"><a href="Growth.html#cb76-30" tabindex="-1"></a><span class="st">        } #j</span></span>
<span id="cb76-31"><a href="Growth.html#cb76-31" tabindex="-1"></a><span class="st">    } #i</span></span>
<span id="cb76-32"><a href="Growth.html#cb76-32" tabindex="-1"></a></span>
<span id="cb76-33"><a href="Growth.html#cb76-33" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb76-34"><a href="Growth.html#cb76-34" tabindex="-1"></a><span class="st">    &quot;</span>,<span class="at">fill=</span><span class="cn">TRUE</span>)</span>
<span id="cb76-35"><a href="Growth.html#cb76-35" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb76-36"><a href="Growth.html#cb76-36" tabindex="-1"></a></span>
<span id="cb76-37"><a href="Growth.html#cb76-37" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb76-38"><a href="Growth.html#cb76-38" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;N.Tag&quot;</span>, <span class="st">&quot;n&quot;</span>, <span class="st">&quot;L&quot;</span>, <span class="st">&quot;dt&quot;</span>)</span>
<span id="cb76-39"><a href="Growth.html#cb76-39" tabindex="-1"></a></span>
<span id="cb76-40"><a href="Growth.html#cb76-40" tabindex="-1"></a><span class="co"># Initial values</span></span>
<span id="cb76-41"><a href="Growth.html#cb76-41" tabindex="-1"></a>jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){ <span class="fu">list</span>(<span class="at">L_inf.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">200</span>),</span>
<span id="cb76-42"><a href="Growth.html#cb76-42" tabindex="-1"></a>                               <span class="at">k.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">2</span>),</span>
<span id="cb76-43"><a href="Growth.html#cb76-43" tabindex="-1"></a>                               <span class="at">Var_L.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">100</span>),</span>
<span id="cb76-44"><a href="Growth.html#cb76-44" tabindex="-1"></a>                               <span class="at">Shape.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">100</span>),</span>
<span id="cb76-45"><a href="Growth.html#cb76-45" tabindex="-1"></a>                               <span class="at">Rate.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">100</span>)</span>
<span id="cb76-46"><a href="Growth.html#cb76-46" tabindex="-1"></a>                               )}</span>
<span id="cb76-47"><a href="Growth.html#cb76-47" tabindex="-1"></a></span>
<span id="cb76-48"><a href="Growth.html#cb76-48" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;vonBert_GrowthInc.txt&#39;</span></span>
<span id="cb76-49"><a href="Growth.html#cb76-49" tabindex="-1"></a></span>
<span id="cb76-50"><a href="Growth.html#cb76-50" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb76-51"><a href="Growth.html#cb76-51" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;L_inf.est&quot;</span>, <span class="st">&quot;k.est&quot;</span>, <span class="st">&quot;Var_L.est&quot;</span> ,<span class="st">&quot;Shape.est&quot;</span>,</span>
<span id="cb76-52"><a href="Growth.html#cb76-52" tabindex="-1"></a>                 <span class="st">&quot;Rate.est&quot;</span>)</span>
<span id="cb76-53"><a href="Growth.html#cb76-53" tabindex="-1"></a></span>
<span id="cb76-54"><a href="Growth.html#cb76-54" tabindex="-1"></a><span class="co"># Call JAGS from R</span></span>
<span id="cb76-55"><a href="Growth.html#cb76-55" tabindex="-1"></a>jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb76-56"><a href="Growth.html#cb76-56" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">20000</span>,</span>
<span id="cb76-57"><a href="Growth.html#cb76-57" tabindex="-1"></a>                model.file)</span>
<span id="cb76-58"><a href="Growth.html#cb76-58" tabindex="-1"></a><span class="fu">print</span>(jagsfit)</span>
<span id="cb76-59"><a href="Growth.html#cb76-59" tabindex="-1"></a><span class="fu">plot</span>(jagsfit)</span></code></pre></div>
<p>The model requires a considerable number of updates to achieve convergence, which is understandable given the large number of parameters (due to estimating relative age for each individual). The estimates tend to be reliable, which can be attributed to the large sample size and good ranges for length-at-tagging and time-at-large. Varying the simulation settings for time-at-large and relative age are helpful for understanding this approach to growth analysis. It should not matter for this model whether observations are from more individuals or more captures per individual. Increasing the number of observations per individual (Poisson lambda) would be relevant if fitting a model with growth parameters that varied among individuals.</p>
<p>For a given sample size, precision is lower for tagging compared to age:length data. This seems reasonable given that relative age must be estimated in a tagging study, whereas absolute ages are (assumed to be) known in an age:length analysis. Nevertheless, there are some situations where tagging data are preferred to age:length, such as for tropical fishes that do not show annual marks on hard parts.</p>
<p>It is straightforward to carry out a combined analysis using age:length and tagging data. The age:length data provide information on all three growth parameters (<span class="math inline">\(L_\infty\)</span>, <span class="math inline">\(k\)</span>, <span class="math inline">\(t_0\)</span>) as well as the variance term. The tagging data provide information on all parameters except <span class="math inline">\(t_0\)</span>. A combined analysis might be preferable if multiple methods provide better coverage over the entire age/size range. For example, <span class="citation">Scherrer et al. (<a href="#ref-scherrer.etal2021">2021</a>)</span> demonstrated the benefits of a combined analysis using age:length, tagging, and length frequency data.</p>
</div>
</div>
<div id="LnWgt" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Growth in weight<a href="Growth.html#LnWgt" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The length-weight relationship for fish is typically nonlinear: <span class="math inline">\(W=a*L^b\)</span>. The ‘a’ parameter is a scaling coefficient and varies depending on the units chosen for measuring length and weight (e.g., cm versus mm or kg versus g). The ‘b’ parameter is close to 3 for most fishes, because weight is a three-dimensional value, increasing approximately as a cube of length.</p>
<p>The length-weight relationship is useful for several reasons. It provides information about fish condition (shape). Fish in poor condition may be overcrowded (e.g., in a pond or aquaculture setting) or lacking in suitable forage. A practical reason for developing a length-weight relationship is that length can be measured more quickly and accurately than weight, especially on the water. Fortunately, there tends to be a very strong relationship between length and weight, so it is often advantageous to measure length and predict weight.</p>
<p>We begin with simulation code, using an arbitrary range of 20 to 80 for length (e.g., measured in cm). For our example, the scaling parameter ‘a’ will be around 1E-6, so we instead work with the ln-scale value (-12). The model can be fitted using either ‘a’ or the ln-scale transformed parameter. Any assumed value around 3 is fine for the ‘b’ parameter. A multiplicative error term is assumed, as variability in weight typically increases as a function of length <span class="citation">(<a href="#ref-hayes.brodziack1997">Hayes and Brodziack 1997</a>)</span>.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="Growth.html#cb77-1" tabindex="-1"></a><span class="co"># Fitting length:weight relationship to simulated data</span></span>
<span id="cb77-2"><a href="Growth.html#cb77-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb77-3"><a href="Growth.html#cb77-3" tabindex="-1"></a></span>
<span id="cb77-4"><a href="Growth.html#cb77-4" tabindex="-1"></a><span class="co"># Choose parameter values and other simulation settings</span></span>
<span id="cb77-5"><a href="Growth.html#cb77-5" tabindex="-1"></a>ln_L_W_a <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">12</span> <span class="co"># e.g., L in cm, weight in kg</span></span>
<span id="cb77-6"><a href="Growth.html#cb77-6" tabindex="-1"></a>L_W_b <span class="ot">&lt;-</span> <span class="fl">3.2</span></span>
<span id="cb77-7"><a href="Growth.html#cb77-7" tabindex="-1"></a>MinL <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb77-8"><a href="Growth.html#cb77-8" tabindex="-1"></a>MaxL <span class="ot">&lt;-</span> <span class="dv">80</span></span>
<span id="cb77-9"><a href="Growth.html#cb77-9" tabindex="-1"></a>SystSample <span class="ot">&lt;-</span> <span class="dv">2</span>  <span class="co"># Number per length bin</span></span>
<span id="cb77-10"><a href="Growth.html#cb77-10" tabindex="-1"></a>Len <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="at">from=</span>MinL, <span class="at">to=</span>MaxL, <span class="at">by=</span><span class="dv">1</span>), <span class="at">each=</span>SystSample)</span>
<span id="cb77-11"><a href="Growth.html#cb77-11" tabindex="-1"></a>SampSize <span class="ot">&lt;-</span> <span class="fu">length</span>(Len)</span>
<span id="cb77-12"><a href="Growth.html#cb77-12" tabindex="-1"></a>W_Var <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># Ln-scale variance in weight at length</span></span>
<span id="cb77-13"><a href="Growth.html#cb77-13" tabindex="-1"></a>Wgt <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="at">n=</span>SampSize, <span class="at">mean=</span>(ln_L_W_a<span class="sc">+</span><span class="fu">log</span>(Len<span class="sc">^</span>(L_W_b))),</span>
<span id="cb77-14"><a href="Growth.html#cb77-14" tabindex="-1"></a>              <span class="at">sd=</span><span class="fu">sqrt</span>(W_Var))</span>
<span id="cb77-15"><a href="Growth.html#cb77-15" tabindex="-1"></a></span>
<span id="cb77-16"><a href="Growth.html#cb77-16" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co"># Ensure default of 1 panel (changes in trace plots)</span></span>
<span id="cb77-17"><a href="Growth.html#cb77-17" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>)) <span class="co"># Set to default margins</span></span>
<span id="cb77-18"><a href="Growth.html#cb77-18" tabindex="-1"></a><span class="fu">plot</span>(Len, Wgt, <span class="at">xlab=</span><span class="st">&quot;Length (cm)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Weight (kg)&quot;</span>)</span></code></pre></div>
<p>The simulation uses a systematic sample for length, using the <code>seq()</code> function nested within <code>rep()</code>. Use Help for the <code>rep()</code> function and try each function separately in the Console to understand how the two functions work together to generate the length vector. The plot <code>par()</code> function is used to undo any plot formatting changes (from the trace plots generated below). As the plot illustrates, variability around the underlying length-weight relationship increases as a function of length.</p>
<p>The JAGS code is relatively short and fitting appears straightforward, although appearances can be deceiving! This simple model is probably the most difficult one to fit in this book, because the two parameters are highly correlated. The high correlation means that offsetting changes in ‘a’ and ‘b’ can provide essentially the same fit, so the updating process is very slow. This model provides a good opportunity to learn about the updating process and using Rhat and trace plots to judge convergence.</p>
<p>The JAGS code for fitting the model begins with broad uniform ranges for the prior distributions. Note that we use same lognormal distribution for the likelihood as in the simulation code (<code>dlnorm()</code> in JAGS). The lognormal distribution assumes a constant additive error term which is a multiplicative error in the back-transformed arithmetic scale. It is convenient to work with the ln-scale transformed value (<span class="math inline">\(log(a)+log(L^b)\)</span>), but the model can also be fitted working directly with ‘a’ parameter (<span class="math inline">\(log(aL^b)\)</span>).</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="Growth.html#cb78-1" tabindex="-1"></a><span class="co"># Load necessary library packages</span></span>
<span id="cb78-2"><a href="Growth.html#cb78-2" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb78-3"><a href="Growth.html#cb78-3" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb78-4"><a href="Growth.html#cb78-4" tabindex="-1"></a></span>
<span id="cb78-5"><a href="Growth.html#cb78-5" tabindex="-1"></a><span class="co"># JAGS code</span></span>
<span id="cb78-6"><a href="Growth.html#cb78-6" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;LenWgt.txt&quot;</span>)</span>
<span id="cb78-7"><a href="Growth.html#cb78-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb78-8"><a href="Growth.html#cb78-8" tabindex="-1"></a><span class="st">model{</span></span>
<span id="cb78-9"><a href="Growth.html#cb78-9" tabindex="-1"></a></span>
<span id="cb78-10"><a href="Growth.html#cb78-10" tabindex="-1"></a><span class="st"># Priors</span></span>
<span id="cb78-11"><a href="Growth.html#cb78-11" tabindex="-1"></a><span class="st"> ln_L_W_a.est ~ dunif(-20, 20)</span></span>
<span id="cb78-12"><a href="Growth.html#cb78-12" tabindex="-1"></a><span class="st"> L_W_b.est ~ dunif(1, 4)</span></span>
<span id="cb78-13"><a href="Growth.html#cb78-13" tabindex="-1"></a><span class="st"> W_Var.est ~ dunif(0,0.5)   </span></span>
<span id="cb78-14"><a href="Growth.html#cb78-14" tabindex="-1"></a><span class="st">   # Multiplicative error. Ln-scale variability</span></span>
<span id="cb78-15"><a href="Growth.html#cb78-15" tabindex="-1"></a></span>
<span id="cb78-16"><a href="Growth.html#cb78-16" tabindex="-1"></a><span class="st"># Calculated value</span></span>
<span id="cb78-17"><a href="Growth.html#cb78-17" tabindex="-1"></a><span class="st"> precision &lt;- 1/W_Var.est</span></span>
<span id="cb78-18"><a href="Growth.html#cb78-18" tabindex="-1"></a></span>
<span id="cb78-19"><a href="Growth.html#cb78-19" tabindex="-1"></a><span class="st"># Likelihood</span></span>
<span id="cb78-20"><a href="Growth.html#cb78-20" tabindex="-1"></a><span class="st"> for (i in 1:SampSize) {</span></span>
<span id="cb78-21"><a href="Growth.html#cb78-21" tabindex="-1"></a><span class="st">    lnWgt_hat[i] &lt;- ln_L_W_a.est+log(Len[i]^L_W_b.est)</span></span>
<span id="cb78-22"><a href="Growth.html#cb78-22" tabindex="-1"></a><span class="st">    Wgt[i] ~ dlnorm(lnWgt_hat[i], precision)</span></span>
<span id="cb78-23"><a href="Growth.html#cb78-23" tabindex="-1"></a><span class="st"> } #i</span></span>
<span id="cb78-24"><a href="Growth.html#cb78-24" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb78-25"><a href="Growth.html#cb78-25" tabindex="-1"></a><span class="st">    &quot;</span>,<span class="at">fill=</span><span class="cn">TRUE</span>)</span>
<span id="cb78-26"><a href="Growth.html#cb78-26" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb78-27"><a href="Growth.html#cb78-27" tabindex="-1"></a></span>
<span id="cb78-28"><a href="Growth.html#cb78-28" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb78-29"><a href="Growth.html#cb78-29" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;SampSize&quot;</span>, <span class="st">&quot;Wgt&quot;</span>, <span class="st">&quot;Len&quot;</span>)</span>
<span id="cb78-30"><a href="Growth.html#cb78-30" tabindex="-1"></a></span>
<span id="cb78-31"><a href="Growth.html#cb78-31" tabindex="-1"></a><span class="co"># Initial values</span></span>
<span id="cb78-32"><a href="Growth.html#cb78-32" tabindex="-1"></a></span>
<span id="cb78-33"><a href="Growth.html#cb78-33" tabindex="-1"></a>jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){ <span class="fu">list</span>(<span class="at">ln_L_W_a.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>),</span>
<span id="cb78-34"><a href="Growth.html#cb78-34" tabindex="-1"></a>                               <span class="at">L_W_b.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">1</span>, <span class="at">max=</span><span class="dv">4</span>),</span>
<span id="cb78-35"><a href="Growth.html#cb78-35" tabindex="-1"></a>                               <span class="at">W_Var.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="fl">0.5</span>))}</span>
<span id="cb78-36"><a href="Growth.html#cb78-36" tabindex="-1"></a></span>
<span id="cb78-37"><a href="Growth.html#cb78-37" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;LenWgt.txt&#39;</span></span>
<span id="cb78-38"><a href="Growth.html#cb78-38" tabindex="-1"></a></span>
<span id="cb78-39"><a href="Growth.html#cb78-39" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb78-40"><a href="Growth.html#cb78-40" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ln_L_W_a.est&quot;</span>, <span class="st">&quot;L_W_b.est&quot;</span>, <span class="st">&quot;W_Var.est&quot;</span>)</span>
<span id="cb78-41"><a href="Growth.html#cb78-41" tabindex="-1"></a></span>
<span id="cb78-42"><a href="Growth.html#cb78-42" tabindex="-1"></a><span class="co"># Call JAGS from R</span></span>
<span id="cb78-43"><a href="Growth.html#cb78-43" tabindex="-1"></a>jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb78-44"><a href="Growth.html#cb78-44" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">5000</span>,</span>
<span id="cb78-45"><a href="Growth.html#cb78-45" tabindex="-1"></a>                model.file)</span>
<span id="cb78-46"><a href="Growth.html#cb78-46" tabindex="-1"></a><span class="fu">print</span>(jagsfit)</span>
<span id="cb78-47"><a href="Growth.html#cb78-47" tabindex="-1"></a><span class="fu">plot</span>(jagsfit)</span>
<span id="cb78-48"><a href="Growth.html#cb78-48" tabindex="-1"></a></span>
<span id="cb78-49"><a href="Growth.html#cb78-49" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>)) <span class="co"># Set default margins</span></span>
<span id="cb78-50"><a href="Growth.html#cb78-50" tabindex="-1"></a><span class="fu">plot</span>(jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.list<span class="sc">$</span>ln_L_W_a.est,</span>
<span id="cb78-51"><a href="Growth.html#cb78-51" tabindex="-1"></a>     jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.list<span class="sc">$</span>L_W_b.est)</span>
<span id="cb78-52"><a href="Growth.html#cb78-52" tabindex="-1"></a><span class="fu">cor</span>(jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.list<span class="sc">$</span>ln_L_W_a.est,</span>
<span id="cb78-53"><a href="Growth.html#cb78-53" tabindex="-1"></a>    jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.list<span class="sc">$</span>L_W_b.est)</span>
<span id="cb78-54"><a href="Growth.html#cb78-54" tabindex="-1"></a></span>
<span id="cb78-55"><a href="Growth.html#cb78-55" tabindex="-1"></a>jagsfit.mcmc <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(jagsfit) <span class="co"># Creates an MCMC object for plotting</span></span>
<span id="cb78-56"><a href="Growth.html#cb78-56" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co"># Avoid error for &quot;figure margins too large&quot;</span></span>
<span id="cb78-57"><a href="Growth.html#cb78-57" tabindex="-1"></a><span class="fu">plot</span>(jagsfit.mcmc) <span class="co"># Trace and density plots</span></span>
<span id="cb78-58"><a href="Growth.html#cb78-58" tabindex="-1"></a><span class="fu">autocorr.diag</span>(jagsfit.mcmc)</span></code></pre></div>
<p>With 5,000 MCMC iterations, the estimates are generally close to the true values, but in some runs Rhat values are inflated. Plotting the sequence of MCMC estimates for ln-scale ‘a’ versus ‘b’ makes clear the extremely high correlation between the two parameters. A numerical estimate of the correlation (~0.99) is obtained in the Console window by using the <code>cor()</code> function.</p>
<p>The trace plots show poor mixing for the ‘a’ and ‘b’ parameters and sometimes more than one mode in the density plots, indicating that many additional updates are needed (Figure <a href="Growth.html#fig:LnWtPlot">8.1</a>). Compare this result to a longer run using 50,000 updates. The trace plots for ‘a’ and ‘b’ now have a much better appearance, and we have good low estimates for Rhat. The autocorrelations can be reduced by thinning (e.g., try n.thin=10), which also reduces the memory required.</p>
<div class="figure"><span style="display:block;" id="fig:LnWtPlot"></span>
<img src="bookdown_files/figure-html/LnWtPlot-1.png" alt="Example trace and density plots for length-weight relationship, based on 5000 updates." width="90%" />
<p class="caption">
FIGURE 8.1: Example trace and density plots for length-weight relationship, based on 5000 updates.
</p>
</div>
<p>It can be helpful to add code for displaying the length-weight observations and the fitted curve. The <code>as.numeric()</code> function converts each array (of length 1) to a scalar for use in generating the fitted curve, which is added to the plot using the points function.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="Growth.html#cb79-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>)) <span class="co"># Restore default margins</span></span>
<span id="cb79-2"><a href="Growth.html#cb79-2" tabindex="-1"></a><span class="fu">plot</span>(Len, Wgt, <span class="at">xlab=</span><span class="st">&quot;Length (cm)&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Weight (kg)&quot;</span>)</span>
<span id="cb79-3"><a href="Growth.html#cb79-3" tabindex="-1"></a>par_a <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">as.numeric</span>(jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>median<span class="sc">$</span>ln_L_W_a.est))</span>
<span id="cb79-4"><a href="Growth.html#cb79-4" tabindex="-1"></a>par_b <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>median<span class="sc">$</span>L_W_b.est)</span>
<span id="cb79-5"><a href="Growth.html#cb79-5" tabindex="-1"></a>Wgt_hat <span class="ot">&lt;-</span> par_a<span class="sc">*</span>(Len<span class="sc">^</span>par_b)</span>
<span id="cb79-6"><a href="Growth.html#cb79-6" tabindex="-1"></a><span class="fu">points</span>(Len, Wgt_hat, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="exercises-5" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Exercises<a href="Growth.html#exercises-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>Before carrying out simulation runs (code from Section <a href="Growth.html#Otolith">8.1.1</a>), describe the expected outcome in fitting the von Bertalanffy growth curve to age:length data if you changed the growth rate (<span class="math inline">\(k\)</span>) to 0.05. Report the results for asymptotic size estimates from several runs. What other simulation setting would need to change in order to accommodate such a slow growth rate?</p></li>
<li><p>For the model in Section <a href="Growth.html#Otolith">8.1.1</a>, compare estimates from the default model (vague uniform prior distributions) to a model using vague lognormal priors for <span class="math inline">\(L_\infty\)</span>, growth rate (<span class="math inline">\(k\)</span>), and Var_L, and a vague normal prior for <span class="math inline">\(t_0\)</span>.</p></li>
<li><p>For either the default or lognormal case from Exercise 2, modify the code to add the fitted curve to the age:length scatterplot. As a hint, you can either redo the scatterplot after the <code>plot(jagsfit)</code> line or add a # to turn off the jagsfit plot.</p></li>
<li><p>Before carrying out simulation runs, describe the expected outcome in fitting the von Bertalanffy growth curve to age:length data if you changed the maximum age to 4 (e.g., if the stock was heavily exploited). Report the results for asymptotic size estimates from several runs.</p></li>
<li><p>Modify the code for the von Bertalanffy age:length analysis to obtain the Age vector using the rgamma function that provided relative ages for the tagging analysis. Find a pair of values for shape and rate that result in reliable estimates of the growth parameters.</p></li>
</ol>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-campana2001" class="csl-entry">
Campana, S. E. 2001. <span>“Accuracy, Precision and Quality Control in Age Determination, Including a Review of the Use and Abuse of Age Validation Methods.”</span> <em>Journal of Fish Biology</em> 59 (2): 197–242. <a href="https://doi.org/10.1111/j.1095-8649.2001.tb00127.x">https://doi.org/10.1111/j.1095-8649.2001.tb00127.x</a>.
</div>
<div id="ref-doll.jacquemin_2018" class="csl-entry">
Doll, Jason C., and Stephen J. Jacquemin. 2018. <span>“Introduction to <span>Bayesian</span> Modeling and Inference for Fisheries Scientists.”</span> <em>Fisheries</em> 43 (3): 152–61. <a href="https://doi.org/10.1002/fsh.10038">https://doi.org/10.1002/fsh.10038</a>.
</div>
<div id="ref-hayes.brodziack1997" class="csl-entry">
Hayes, D B, and JKT Brodziack. 1997. <span>“Reply: <span>Efficiency</span> and Bias of Estimators and Sampling Designs for Determining Lengthweight Relationships of Fish.”</span> <em>Canadian Journal of Fisheries and Aquatic Sciences</em> 54 (3): 744–45. <a href="https://doi.org/10.1139/f96-299">https://doi.org/10.1139/f96-299</a>.
</div>
<div id="ref-lemoine_2019" class="csl-entry">
Lemoine, Nathan P. 2019. <span>“Moving Beyond Noninformative Priors: Why and How to Choose Weakly Informative Priors in <span>Bayesian</span> Analyses.”</span> <em>Oikos</em> 128 (7): 912–28. <a href="https://doi.org/10.1111/oik.05985">https://doi.org/10.1111/oik.05985</a>.
</div>
<div id="ref-mccarthy_2007" class="csl-entry">
McCarthy, Michael A. 2007. <em>Bayesian <span>Methods</span> for <span>Ecology</span></em>. 1st ed. Cambridge, UK: Cambridge University Press.
</div>
<div id="ref-quinn.deriso_1999" class="csl-entry">
Quinn, Terrance J., and Richard B. Deriso. 1999. <em>Quantitative <span>Fish Dynamics</span></em>. Oxford, New York: Oxford University Press.
</div>
<div id="ref-scherrer.etal2021" class="csl-entry">
Scherrer, Stephen R., Donald R. Kobayashi, Kevin C. Weng, Henry Y. Okamoto, Francis G. Oishi, and Erik C. Franklin. 2021. <span>“Estimation of Growth Parameters Integrating Tag-Recapture, Length-Frequency, and Direct Aging Data Using Likelihood and <span>Bayesian</span> Methods for the Tropical Deepwater Snapper <span>Pristipomoides</span> Filamentosus in <span>Hawaii</span>.”</span> <em>Fisheries Research</em> 233 (January): 105753. <a href="https://doi.org/10.1016/j.fishres.2020.105753">https://doi.org/10.1016/j.fishres.2020.105753</a>.
</div>
<div id="ref-wang.etal1995" class="csl-entry">
Wang, You-Gan, Mervyn R. Thomas, and Ian F. Somers. 1995. <span>“A Maximum Likelihood Approach for Estimating Growth from Tag–Recapture Data.”</span> <em>Canadian Journal of Fisheries and Aquatic Sciences</em> 52 (2): 252–59. <a href="https://doi.org/10.1139/f95-025">https://doi.org/10.1139/f95-025</a>.
</div>
<div id="ref-zhang.etal2009" class="csl-entry">
Zhang, Zane, Joanne Lessard, and Alan Campbell. 2009. <span>“Use of <span>Bayesian</span> Hierarchical Models to Estimate Northern Abalone, <span>Haliotis</span> Kamtschatkana, Growth Parameters from Tag-Recapture Data.”</span> <em>Fisheries Research</em> 95 (2): 289–95. <a href="https://doi.org/10.1016/j.fishres.2008.09.035">https://doi.org/10.1016/j.fishres.2008.09.035</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Mortality.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Recruit.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": true,
    "facebook": false,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/yihui/bookdown-crc/edit/master/08-Growth.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["bookdown.pdf", "bookdown.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "none"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
