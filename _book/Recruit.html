<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Recruitment | A Bayesian Introduction to Fish Population Analysis</title>
  <meta name="description" content="This book is intended to be a bridge between traditional fisheries analytical methods and Bayesian statistics. It is a hands-on introduction to models for estimating abundance, survival, growth, recruitment, and population trends." />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Recruitment | A Bayesian Introduction to Fish Population Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book is intended to be a bridge between traditional fisheries analytical methods and Bayesian statistics. It is a hands-on introduction to models for estimating abundance, survival, growth, recruitment, and population trends." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Recruitment | A Bayesian Introduction to Fish Population Analysis" />
  
  <meta name="twitter:description" content="This book is intended to be a bridge between traditional fisheries analytical methods and Bayesian statistics. It is a hands-on introduction to models for estimating abundance, survival, growth, recruitment, and population trends." />
  

<meta name="author" content="Joseph E. Hightower" />


<meta name="date" content="2024-08-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Growth.html"/>
<link rel="next" href="Trend.html"/>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Joe Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-information-and-conventions"><i class="fa fa-check"></i>Software information and conventions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="R-intro.html"><a href="R-intro.html"><i class="fa fa-check"></i><b>2</b> A Brief Introduction to R and RStudio</a></li>
<li class="chapter" data-level="3" data-path="Distributions.html"><a href="Distributions.html"><i class="fa fa-check"></i><b>3</b> Probability Distributions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Distributions.html"><a href="Distributions.html#Discrete"><i class="fa fa-check"></i><b>3.1</b> Discrete</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="Distributions.html"><a href="Distributions.html#Bernoulli"><i class="fa fa-check"></i><b>3.1.1</b> Bernoulli</a></li>
<li class="chapter" data-level="3.1.2" data-path="Distributions.html"><a href="Distributions.html#BinomialDist"><i class="fa fa-check"></i><b>3.1.2</b> Binomial</a></li>
<li class="chapter" data-level="3.1.3" data-path="Distributions.html"><a href="Distributions.html#Multinomial"><i class="fa fa-check"></i><b>3.1.3</b> Multinomial</a></li>
<li class="chapter" data-level="3.1.4" data-path="Distributions.html"><a href="Distributions.html#PoissonDist"><i class="fa fa-check"></i><b>3.1.4</b> Poisson</a></li>
<li class="chapter" data-level="3.1.5" data-path="Distributions.html"><a href="Distributions.html#NegBinom"><i class="fa fa-check"></i><b>3.1.5</b> Negative binomial</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="Distributions.html"><a href="Distributions.html#Continuous"><i class="fa fa-check"></i><b>3.2</b> Continuous</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="Distributions.html"><a href="Distributions.html#Uniform"><i class="fa fa-check"></i><b>3.2.1</b> Uniform</a></li>
<li class="chapter" data-level="3.2.2" data-path="Distributions.html"><a href="Distributions.html#BetaDist"><i class="fa fa-check"></i><b>3.2.2</b> Beta</a></li>
<li class="chapter" data-level="3.2.3" data-path="Distributions.html"><a href="Distributions.html#NormalDist"><i class="fa fa-check"></i><b>3.2.3</b> Normal</a></li>
<li class="chapter" data-level="3.2.4" data-path="Distributions.html"><a href="Distributions.html#LognormalDist"><i class="fa fa-check"></i><b>3.2.4</b> Lognormal</a></li>
<li class="chapter" data-level="3.2.5" data-path="Distributions.html"><a href="Distributions.html#GammaDist"><i class="fa fa-check"></i><b>3.2.5</b> Gamma</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="Distributions.html"><a href="Distributions.html#exercises"><i class="fa fa-check"></i><b>3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Model-fit.html"><a href="Model-fit.html"><i class="fa fa-check"></i><b>4</b> Model Fitting</a>
<ul>
<li class="chapter" data-level="4.1" data-path="Model-fit.html"><a href="Model-fit.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="Model-fit.html"><a href="Model-fit.html#Model-fit-sim"><i class="fa fa-check"></i><b>4.2</b> Using simulation</a></li>
<li class="chapter" data-level="4.3" data-path="Model-fit.html"><a href="Model-fit.html#JAGS-model-fit"><i class="fa fa-check"></i><b>4.3</b> Using Bayesian methods</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="Model-fit.html"><a href="Model-fit.html#Debug"><i class="fa fa-check"></i><b>4.3.1</b> Debugging code</a></li>
<li class="chapter" data-level="4.3.2" data-path="Model-fit.html"><a href="Model-fit.html#Convergence"><i class="fa fa-check"></i><b>4.3.2</b> Judging convergence</a></li>
<li class="chapter" data-level="4.3.3" data-path="Model-fit.html"><a href="Model-fit.html#Likelihood"><i class="fa fa-check"></i><b>4.3.3</b> What is a likelihood?</a></li>
<li class="chapter" data-level="4.3.4" data-path="Model-fit.html"><a href="Model-fit.html#Deviance"><i class="fa fa-check"></i><b>4.3.4</b> Deviance as a measure of model fit</a></li>
<li class="chapter" data-level="4.3.5" data-path="Model-fit.html"><a href="Model-fit.html#Model-checking"><i class="fa fa-check"></i><b>4.3.5</b> Model checking</a></li>
<li class="chapter" data-level="4.3.6" data-path="Model-fit.html"><a href="Model-fit.html#Model-selection"><i class="fa fa-check"></i><b>4.3.6</b> Model selection</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="Model-fit.html"><a href="Model-fit.html#exercises-1"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Abundance.html"><a href="Abundance.html"><i class="fa fa-check"></i><b>5</b> Abundance</a>
<ul>
<li class="chapter" data-level="5.1" data-path="Abundance.html"><a href="Abundance.html#removal"><i class="fa fa-check"></i><b>5.1</b> Removal</a></li>
<li class="chapter" data-level="5.2" data-path="Abundance.html"><a href="Abundance.html#mark-recapture"><i class="fa fa-check"></i><b>5.2</b> Mark-recapture</a></li>
<li class="chapter" data-level="5.3" data-path="Abundance.html"><a href="Abundance.html#binomial-mixture"><i class="fa fa-check"></i><b>5.3</b> Binomial-mixture</a></li>
<li class="chapter" data-level="5.4" data-path="Abundance.html"><a href="Abundance.html#exercises-2"><i class="fa fa-check"></i><b>5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Survival.html"><a href="Survival.html"><i class="fa fa-check"></i><b>6</b> Survival</a>
<ul>
<li class="chapter" data-level="6.1" data-path="Survival.html"><a href="Survival.html#AgeComp"><i class="fa fa-check"></i><b>6.1</b> Age-composition</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="Survival.html"><a href="Survival.html#CC_Selectivity"><i class="fa fa-check"></i><b>6.1.1</b> Accounting For Gear Selectivity</a></li>
<li class="chapter" data-level="6.1.2" data-path="Survival.html"><a href="Survival.html#Cohort"><i class="fa fa-check"></i><b>6.1.2</b> Cohort model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="Survival.html"><a href="Survival.html#TelemetryBased"><i class="fa fa-check"></i><b>6.2</b> Telemetry-based</a></li>
<li class="chapter" data-level="6.3" data-path="Survival.html"><a href="Survival.html#BrownieSurvival"><i class="fa fa-check"></i><b>6.3</b> Tag-based</a></li>
<li class="chapter" data-level="6.4" data-path="Survival.html"><a href="Survival.html#exercises-3"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Mortality.html"><a href="Mortality.html"><i class="fa fa-check"></i><b>7</b> Mortality Components</a>
<ul>
<li class="chapter" data-level="7.1" data-path="Mortality.html"><a href="Mortality.html#ExpRate"><i class="fa fa-check"></i><b>7.1</b> Exploitation rate</a></li>
<li class="chapter" data-level="7.2" data-path="Mortality.html"><a href="Mortality.html#Hearn"><i class="fa fa-check"></i><b>7.2</b> Completed tagging study</a></li>
<li class="chapter" data-level="7.3" data-path="Mortality.html"><a href="Mortality.html#BrownieFandM"><i class="fa fa-check"></i><b>7.3</b> Multi-year tagging study</a></li>
<li class="chapter" data-level="7.4" data-path="Mortality.html"><a href="Mortality.html#TelemetryFandM"><i class="fa fa-check"></i><b>7.4</b> Telemetry estimates of F and M</a></li>
<li class="chapter" data-level="7.5" data-path="Mortality.html"><a href="Mortality.html#exercises-4"><i class="fa fa-check"></i><b>7.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Growth.html"><a href="Growth.html"><i class="fa fa-check"></i><b>8</b> Growth</a>
<ul>
<li class="chapter" data-level="8.1" data-path="Growth.html"><a href="Growth.html#vonBert"><i class="fa fa-check"></i><b>8.1</b> Growth in length</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="Growth.html"><a href="Growth.html#Otolith"><i class="fa fa-check"></i><b>8.1.1</b> Age-length</a></li>
<li class="chapter" data-level="8.1.2" data-path="Growth.html"><a href="Growth.html#GrowthInc"><i class="fa fa-check"></i><b>8.1.2</b> Using tagging data</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="Growth.html"><a href="Growth.html#LnWgt"><i class="fa fa-check"></i><b>8.2</b> Growth in weight</a></li>
<li class="chapter" data-level="8.3" data-path="Growth.html"><a href="Growth.html#exercises-5"><i class="fa fa-check"></i><b>8.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Recruit.html"><a href="Recruit.html"><i class="fa fa-check"></i><b>9</b> Recruitment</a>
<ul>
<li class="chapter" data-level="9.1" data-path="Recruit.html"><a href="Recruit.html#Recruit-Fit"><i class="fa fa-check"></i><b>9.1</b> Fitting a stock-recruitment curve</a></li>
<li class="chapter" data-level="9.2" data-path="Recruit.html"><a href="Recruit.html#Recruit-DIC"><i class="fa fa-check"></i><b>9.2</b> Does spawning stock size affect recruitment?</a></li>
<li class="chapter" data-level="9.3" data-path="Recruit.html"><a href="Recruit.html#exercises-6"><i class="fa fa-check"></i><b>9.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Trend.html"><a href="Trend.html"><i class="fa fa-check"></i><b>10</b> Abundance trends</a>
<ul>
<li class="chapter" data-level="10.1" data-path="Trend.html"><a href="Trend.html#Linear"><i class="fa fa-check"></i><b>10.1</b> Linear model</a></li>
<li class="chapter" data-level="10.2" data-path="Trend.html"><a href="Trend.html#ExpGr"><i class="fa fa-check"></i><b>10.2</b> Exponential growth model</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="Trend.html"><a href="Trend.html#Forecast"><i class="fa fa-check"></i><b>10.2.1</b> Forecasting</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="Trend.html"><a href="Trend.html#exercises-7"><i class="fa fa-check"></i><b>10.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="PopModels.html"><a href="PopModels.html"><i class="fa fa-check"></i><b>11</b> Integrated Population Models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="PopModels.html"><a href="PopModels.html#exercises-8"><i class="fa fa-check"></i><b>11.1</b> Exercises</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="title-placeholder.html"><a href="title-placeholder.html"><i class="fa fa-check"></i><b>A</b> Title Placeholder</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Bayesian Introduction to Fish Population Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Recruit" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Recruitment<a href="Recruit.html#Recruit" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Growth, mortality, and recruitment are the three fundamental processes that regulate fish populations. Previous chapters have addressed the first two; here we consider methods for studying recruitment. Recruitment is usually considered to be the annual process of young fish entering the part of the population that is vulnerable to fishing (i.e., the fishable stock). Thus the timing of recruitment depends on fishery selectivity pattern(s), which tend to be gradual rather than knife-edged. One practical approach for defining age at recruitment is to choose the first age at which fishery catches are non-negligible. For simplicity in this chapter, we will simulate recruitment occurring at age one so there is a one-year lag from the time of spawning to recruitment.</p>
<p>What happens between spawning and recruitment is of interest to the fish ecologist and the fishery manager. Typical factors affecting recruitment include environmental conditions, prey availability, and predation. It may seem obvious to assume that spawning stock size affects recruitment, but it is not always easy to detect such a relationship <span class="citation">(<a href="#ref-hilborn.walters_1992">Hilborn and Walters 1992</a>)</span>. The relationship may not be evident if there is little contrast in spawning stock size, high variability in recruitment, too short a time series, or low precision for estimates of spawning stock and recruitment. Characterizing the strength of the relationship can provide valuable guidance to the fishery manager. For example, management will need to be more restrictive in cases where recruitment drops consistently as spawning stock declines. If recruitment appears to be relatively stable over a wide range of spawning stock sizes, a more aggressive harvest policy may be possible. The risk in any case is of fishing the stock down to a point where recruitment declines sharply. This is termed recruitment overfishing, and it can be very difficult to rebuild a population after that occurs.</p>
<p>The process of recruitment starts with eggs, but egg production is difficult to estimate directly so it is common to use spawning stock biomass (<span class="math inline">\(B_S\)</span>) as a proxy. One of the most commonly used curves relating spawning stock size and recruitment is the Beverton-Holt equation: <span class="math inline">\(R=1/(\alpha +\beta/B_S)\)</span>. This curve approaches zero as <span class="math inline">\(B_S\)</span> approaches zero and approaches 1/<span class="math inline">\(\alpha\)</span> as <span class="math inline">\(B_S\)</span> approaches infinity. It is often a good descriptor of observed stock-recruitment data in that recruitment is low when spawning stock size is close to zero but appears to be without trend at higher spawning stock sizes.</p>
<p>The best way to explore the behavior of the Beverton-Holt curve is to try different values for the two parameters:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="Recruit.html#cb79-1" tabindex="-1"></a>SpBio <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">10</span>, <span class="at">to=</span><span class="dv">200</span>, <span class="at">by=</span><span class="dv">5</span>)</span>
<span id="cb79-2"><a href="Recruit.html#cb79-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fl">0.001</span></span>
<span id="cb79-3"><a href="Recruit.html#cb79-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb79-4"><a href="Recruit.html#cb79-4" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(a<span class="sc">+</span>b<span class="sc">/</span>SpBio)</span>
<span id="cb79-5"><a href="Recruit.html#cb79-5" tabindex="-1"></a><span class="fu">plot</span>(SpBio, R)</span></code></pre></div>
<p>In this example code, spawning stock biomass is generated with the <code>seq()</code> (sequence) function over a wide but arbitrary range. The Beverton-Holt parameters are also arbitrary but are chosen to allow for gradually increasing recruitment toward an asymptote of 1000 (1/a). Experiment with different parameter values to find a set that would maintain an asymptote of 1000 but would produce a steeper curve (near the origin), with about 90% of asymptotic recruitment at a spawning stock level of 100.</p>
<div id="Recruit-Fit" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Fitting a stock-recruitment curve<a href="Recruit.html#Recruit-Fit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We begin by fitting a Beverton-Holt model to simulated stock-recruitment data. Our simulation uses a full age-structured model to generate the stock-recruitment data. First, we choose the structure of the population matrix (number of ages and years). Next, we choose arbitrary annual fishing mortality rates. By starting the population at a high level and fishing intensively, we ensure that there is sufficient contrast <span class="citation">(<a href="#ref-hilborn.walters_1992">Hilborn and Walters 1992</a>)</span> in spawning stock size to be able to detect the underlying relationship. Age-specific fishing mortality rates are obtained by defining the fishery selectivity pattern. We use a logistic curve and arbitrarily choose parameters so that 50% selectivity occurs at age two. (It is useful to plot the selectivity curve (code commented out) while varying the two selectivity parameters.) Obtaining year- and age- specific fishing mortality rates as a product of a year-specific measure of fishing intensity and an age-specific vulnerability to fishing is sometimes referred to as a “separable” model.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="Recruit.html#cb80-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb80-2"><a href="Recruit.html#cb80-2" tabindex="-1"></a></span>
<span id="cb80-3"><a href="Recruit.html#cb80-3" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># Arbitrary. If changed, redo maturity and meanwt vectors</span></span>
<span id="cb80-4"><a href="Recruit.html#cb80-4" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="co"># Arbitrary. If changed, redo AnnualF vector</span></span>
<span id="cb80-5"><a href="Recruit.html#cb80-5" tabindex="-1"></a></span>
<span id="cb80-6"><a href="Recruit.html#cb80-6" tabindex="-1"></a>AnnualF <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.59</span>, <span class="fl">0.41</span>, <span class="fl">0.74</span>, <span class="fl">0.91</span>, <span class="fl">0.86</span>, <span class="fl">0.74</span>, <span class="fl">1.07</span>, <span class="fl">0.9</span>, <span class="fl">0.87</span>, <span class="fl">1.1</span>, <span class="fl">0.93</span>)</span>
<span id="cb80-7"><a href="Recruit.html#cb80-7" tabindex="-1"></a><span class="co"># Arbitrary, increasing trend to create contrast in SpBio. Redo if Y changes</span></span>
<span id="cb80-8"><a href="Recruit.html#cb80-8" tabindex="-1"></a>AnnualM <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb80-9"><a href="Recruit.html#cb80-9" tabindex="-1"></a></span>
<span id="cb80-10"><a href="Recruit.html#cb80-10" tabindex="-1"></a><span class="co"># F by age, using separable model</span></span>
<span id="cb80-11"><a href="Recruit.html#cb80-11" tabindex="-1"></a>Fishery_k <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># Slope for logistic function</span></span>
<span id="cb80-12"><a href="Recruit.html#cb80-12" tabindex="-1"></a>Fishery_a_50 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Age at 0.5 selectivity</span></span>
<span id="cb80-13"><a href="Recruit.html#cb80-13" tabindex="-1"></a>SelF <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span>A) <span class="co"># Fishery selectivity pattern</span></span>
<span id="cb80-14"><a href="Recruit.html#cb80-14" tabindex="-1"></a>F_a <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(A,(Y<span class="dv">-1</span>))) <span class="co"># Matrix F by age and year</span></span>
<span id="cb80-15"><a href="Recruit.html#cb80-15" tabindex="-1"></a>Z_a <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(A,(Y<span class="dv">-1</span>))) <span class="co"># Matrix Z by age and year</span></span>
<span id="cb80-16"><a href="Recruit.html#cb80-16" tabindex="-1"></a>S_a <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(A,(Y<span class="dv">-1</span>))) <span class="co"># Matrix survival rate by age and year</span></span>
<span id="cb80-17"><a href="Recruit.html#cb80-17" tabindex="-1"></a><span class="cf">for</span> (a <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>A){</span>
<span id="cb80-18"><a href="Recruit.html#cb80-18" tabindex="-1"></a>  SelF[a] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>Fishery_k<span class="sc">*</span>(a<span class="sc">-</span>Fishery_a_50)))</span>
<span id="cb80-19"><a href="Recruit.html#cb80-19" tabindex="-1"></a>  } <span class="co">#a</span></span>
<span id="cb80-20"><a href="Recruit.html#cb80-20" tabindex="-1"></a><span class="co">#plot(SelF)</span></span>
<span id="cb80-21"><a href="Recruit.html#cb80-21" tabindex="-1"></a><span class="cf">for</span> (y <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(Y<span class="dv">-1</span>)) {</span>
<span id="cb80-22"><a href="Recruit.html#cb80-22" tabindex="-1"></a>  <span class="cf">for</span> (a <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>A){</span>
<span id="cb80-23"><a href="Recruit.html#cb80-23" tabindex="-1"></a>    F_a[a,y] <span class="ot">&lt;-</span> AnnualF[y] <span class="sc">*</span> SelF[a]</span>
<span id="cb80-24"><a href="Recruit.html#cb80-24" tabindex="-1"></a>    Z_a[a,y] <span class="ot">&lt;-</span> F_a[a,y]<span class="sc">+</span>AnnualM</span>
<span id="cb80-25"><a href="Recruit.html#cb80-25" tabindex="-1"></a>    S_a[a,y] <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>Z_a[a,y])</span>
<span id="cb80-26"><a href="Recruit.html#cb80-26" tabindex="-1"></a>  } <span class="co">#a</span></span>
<span id="cb80-27"><a href="Recruit.html#cb80-27" tabindex="-1"></a>} <span class="co">#y</span></span>
<span id="cb80-28"><a href="Recruit.html#cb80-28" tabindex="-1"></a></span>
<span id="cb80-29"><a href="Recruit.html#cb80-29" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span><span class="fu">c</span>(A, Y))</span>
<span id="cb80-30"><a href="Recruit.html#cb80-30" tabindex="-1"></a></span>
<span id="cb80-31"><a href="Recruit.html#cb80-31" tabindex="-1"></a>BH_alpha <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fl">1E5</span> <span class="co"># Parameter defining Beverton-Holt asymptotic recruitment</span></span>
<span id="cb80-32"><a href="Recruit.html#cb80-32" tabindex="-1"></a>BH_beta <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># Arbitrary</span></span>
<span id="cb80-33"><a href="Recruit.html#cb80-33" tabindex="-1"></a>SD_rec <span class="ot">&lt;-</span> <span class="fl">0.25</span> <span class="co"># Low level of lognormal error in recruitment</span></span>
<span id="cb80-34"><a href="Recruit.html#cb80-34" tabindex="-1"></a></span>
<span id="cb80-35"><a href="Recruit.html#cb80-35" tabindex="-1"></a><span class="co"># Set up year-1 vector based on asymptotic recruitment and year-1 survival</span></span>
<span id="cb80-36"><a href="Recruit.html#cb80-36" tabindex="-1"></a>Mat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>) </span>
<span id="cb80-37"><a href="Recruit.html#cb80-37" tabindex="-1"></a><span class="co"># Arbitrary maturity schedule. Redo if max age (A) changes</span></span>
<span id="cb80-38"><a href="Recruit.html#cb80-38" tabindex="-1"></a>Wgt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.10</span>, <span class="fl">0.20</span>, <span class="fl">0.40</span>, <span class="fl">0.62</span>, <span class="fl">0.80</span>, <span class="fl">1.01</span>, <span class="fl">1.30</span>, <span class="fl">1.56</span>) </span>
<span id="cb80-39"><a href="Recruit.html#cb80-39" tabindex="-1"></a><span class="co"># Mean wt. Redo if A changes</span></span>
<span id="cb80-40"><a href="Recruit.html#cb80-40" tabindex="-1"></a>SpBio <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data=</span><span class="cn">NA</span>, <span class="at">dim=</span>(Y<span class="dv">-1</span>)) <span class="co"># Spawning biomass vector</span></span>
<span id="cb80-41"><a href="Recruit.html#cb80-41" tabindex="-1"></a><span class="co"># Year-1 N (arbitrarily) from asymptotic recruitment, year-1 survival.</span></span>
<span id="cb80-42"><a href="Recruit.html#cb80-42" tabindex="-1"></a>N[<span class="dv">1</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">trunc</span>(<span class="dv">1</span><span class="sc">/</span>BH_alpha<span class="sc">*</span><span class="fu">rlnorm</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="dv">0</span>, SD_rec))</span>
<span id="cb80-43"><a href="Recruit.html#cb80-43" tabindex="-1"></a><span class="cf">for</span> (a <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>A){</span>
<span id="cb80-44"><a href="Recruit.html#cb80-44" tabindex="-1"></a>  N[a,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1</span>, N[(a<span class="dv">-1</span>),<span class="dv">1</span>], S_a[(a<span class="dv">-1</span>),<span class="dv">1</span>])</span>
<span id="cb80-45"><a href="Recruit.html#cb80-45" tabindex="-1"></a>}<span class="co">#a</span></span>
<span id="cb80-46"><a href="Recruit.html#cb80-46" tabindex="-1"></a><span class="cf">for</span> (y <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>Y){</span>
<span id="cb80-47"><a href="Recruit.html#cb80-47" tabindex="-1"></a>  SpBio[y<span class="dv">-1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(N[,y<span class="dv">-1</span>]<span class="sc">*</span>Wgt<span class="sc">*</span>Mat) <span class="co"># Spawning stock biomass</span></span>
<span id="cb80-48"><a href="Recruit.html#cb80-48" tabindex="-1"></a>  N[<span class="dv">1</span>,y] <span class="ot">&lt;-</span> <span class="fu">trunc</span>(<span class="dv">1</span><span class="sc">/</span>(BH_alpha<span class="sc">+</span>BH_beta<span class="sc">/</span>SpBio[y<span class="dv">-1</span>])<span class="sc">*</span><span class="fu">rlnorm</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="dv">0</span>, SD_rec))</span>
<span id="cb80-49"><a href="Recruit.html#cb80-49" tabindex="-1"></a>  <span class="cf">for</span> (a <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>A){</span>
<span id="cb80-50"><a href="Recruit.html#cb80-50" tabindex="-1"></a>    N[a,y] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, N[(a<span class="dv">-1</span>), (y<span class="dv">-1</span>)], S_a[(a<span class="dv">-1</span>),(y<span class="dv">-1</span>)])</span>
<span id="cb80-51"><a href="Recruit.html#cb80-51" tabindex="-1"></a>  } <span class="co">#a</span></span>
<span id="cb80-52"><a href="Recruit.html#cb80-52" tabindex="-1"></a>} <span class="co">#y</span></span>
<span id="cb80-53"><a href="Recruit.html#cb80-53" tabindex="-1"></a><span class="co">#plot(SpBio,N[1,2:Y], ylab=&quot;Recruits&quot;, xlab=&quot;Spawning stock biomass&quot;)</span></span>
<span id="cb80-54"><a href="Recruit.html#cb80-54" tabindex="-1"></a></span>
<span id="cb80-55"><a href="Recruit.html#cb80-55" tabindex="-1"></a><span class="co"># Generate survey data on recruitment and spawning stock</span></span>
<span id="cb80-56"><a href="Recruit.html#cb80-56" tabindex="-1"></a>Survey_q <span class="ot">&lt;-</span> <span class="fl">1E-3</span> <span class="co"># Arbitrary catchability coefficient for survey</span></span>
<span id="cb80-57"><a href="Recruit.html#cb80-57" tabindex="-1"></a>SD_survey <span class="ot">&lt;-</span> <span class="fl">0.2</span> <span class="co"># Arbitrary ln-scale SD</span></span>
<span id="cb80-58"><a href="Recruit.html#cb80-58" tabindex="-1"></a>Exp_ln_B <span class="ot">&lt;-</span> <span class="fu">log</span>(Survey_q<span class="sc">*</span>SpBio)</span>
<span id="cb80-59"><a href="Recruit.html#cb80-59" tabindex="-1"></a>Survey_B <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="at">n=</span>Y, <span class="at">meanlog=</span>Exp_ln_B, <span class="at">sdlog=</span>SD_survey)</span>
<span id="cb80-60"><a href="Recruit.html#cb80-60" tabindex="-1"></a><span class="co">#plot(SpBio, Survey_B[1:Y-1])</span></span>
<span id="cb80-61"><a href="Recruit.html#cb80-61" tabindex="-1"></a>Exp_ln_R <span class="ot">&lt;-</span> <span class="fu">log</span>(Survey_q<span class="sc">*</span>N[<span class="dv">1</span>,<span class="dv">2</span><span class="sc">:</span>Y])</span>
<span id="cb80-62"><a href="Recruit.html#cb80-62" tabindex="-1"></a>Survey_R <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="fu">rlnorm</span>(<span class="at">n=</span>(Y<span class="dv">-1</span>), <span class="at">meanlog=</span>Exp_ln_R, <span class="at">sdlog=</span>SD_survey))</span>
<span id="cb80-63"><a href="Recruit.html#cb80-63" tabindex="-1"></a><span class="co">#plot(N[1,], Survey_R)</span></span></code></pre></div>
<p>The next section of code generates the population matrix. The Beverton-Holt parameters are arbitrarily chosen and can be varied to explore different shapes for the curve. Next, we generate the population vector for year one, using approximate equilibrium values. Expected recruitment is set equal to the curve’s asymptote, with a lognormal (Section <a href="Distributions.html#LognormalDist">3.2.4</a>) error term used to add random variation; for example, due to environmental conditions. The lognormal distribution is well suited to recruitment data because of the potential for occasional extreme values <span class="citation">(<a href="#ref-hilborn.walters_1992">Hilborn and Walters 1992</a>)</span>. The chosen standard deviation (0.25) is on the lower end of variation in recruitment <span class="citation">(<a href="#ref-hightower.grossman_1985">Hightower and Grossman 1985</a>)</span>. The rest of the year-1 vector is obtained from age-1 recruitment using year-1 mortality rates (<span class="math inline">\(N_{a,1}=S_{a-1,1}*N_{a-1,1}\)</span>). The <code>rbinom()</code> function introduces stochastic variation in survival. Starting (age-1) population size is truncated because the binomial function requires a whole number for the size of the experiment.</p>
<p>The population vector for the remaining years can be filled in once the year-1 vector is determined. For example, recruitment in year 2 depends on spawning stock biomass in year 1. The age-specific vectors for maturity schedule and weight-at-age are arbitrary. Numbers of fish age 2 and older are obtained as survivors from the prior year’s vector; i.e., <span class="math inline">\(N_{a,y}=S_{a-1,y-1}*N_{a-1,y-1}\)</span>, with random variation in survival from a binomial distribution. The final step is to obtain survey observations for recruitment and spawning stock biomass. The random survey values are drawn from a lognormal distribution, using an arbitrary catchability coefficient and ln-scale standard deviation for error. The survey values are referred to as indices but could be estimates of the absolute magnitude of recruitment and spawning stock size. There is not a recruitment survey value for year 1 because the simulated recruitment was not based on spawning stock size.</p>
<p>The JAGS code uses uninformative prior distributions for the two Beverton-Holt parameters and the lognormal error term. Expected recruitment is predicted on ln-scale in order to match the assumed lognormal error. The recruitment index is predicted (R_hat) for use in plotting (see below).</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="Recruit.html#cb81-1" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb81-2"><a href="Recruit.html#cb81-2" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb81-3"><a href="Recruit.html#cb81-3" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb81-4"><a href="Recruit.html#cb81-4" tabindex="-1"></a></span>
<span id="cb81-5"><a href="Recruit.html#cb81-5" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;StockRecruit.txt&quot;</span>)</span>
<span id="cb81-6"><a href="Recruit.html#cb81-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb81-7"><a href="Recruit.html#cb81-7" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb81-8"><a href="Recruit.html#cb81-8" tabindex="-1"></a><span class="st"># Model parameters: Beverton-Holt alpha and beta, SD for fitted curve</span></span>
<span id="cb81-9"><a href="Recruit.html#cb81-9" tabindex="-1"></a></span>
<span id="cb81-10"><a href="Recruit.html#cb81-10" tabindex="-1"></a><span class="st"># Priors</span></span>
<span id="cb81-11"><a href="Recruit.html#cb81-11" tabindex="-1"></a><span class="st"> BH_alpha.est ~ dunif(0, 10)</span></span>
<span id="cb81-12"><a href="Recruit.html#cb81-12" tabindex="-1"></a><span class="st"> BH_beta.est ~ dunif(0, 10)</span></span>
<span id="cb81-13"><a href="Recruit.html#cb81-13" tabindex="-1"></a><span class="st"> SD_rec.est ~ dunif(0, 10)</span></span>
<span id="cb81-14"><a href="Recruit.html#cb81-14" tabindex="-1"></a><span class="st"> tau &lt;- pow(SD_rec.est, -2)</span></span>
<span id="cb81-15"><a href="Recruit.html#cb81-15" tabindex="-1"></a></span>
<span id="cb81-16"><a href="Recruit.html#cb81-16" tabindex="-1"></a><span class="st"># Likelihood</span></span>
<span id="cb81-17"><a href="Recruit.html#cb81-17" tabindex="-1"></a><span class="st">    for(y in 2:Y) {</span></span>
<span id="cb81-18"><a href="Recruit.html#cb81-18" tabindex="-1"></a><span class="st">      lnR_hat[y] &lt;- log(1/(BH_alpha.est+BH_beta.est/Survey_B[y-1]))</span></span>
<span id="cb81-19"><a href="Recruit.html#cb81-19" tabindex="-1"></a><span class="st">      Survey_R[y] ~ dlnorm(lnR_hat[y],tau)</span></span>
<span id="cb81-20"><a href="Recruit.html#cb81-20" tabindex="-1"></a><span class="st">      R_hat[y] &lt;- exp(lnR_hat[y])</span></span>
<span id="cb81-21"><a href="Recruit.html#cb81-21" tabindex="-1"></a><span class="st">      } #y</span></span>
<span id="cb81-22"><a href="Recruit.html#cb81-22" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb81-23"><a href="Recruit.html#cb81-23" tabindex="-1"></a><span class="st">    &quot;</span>,<span class="at">fill=</span><span class="cn">TRUE</span>)</span>
<span id="cb81-24"><a href="Recruit.html#cb81-24" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb81-25"><a href="Recruit.html#cb81-25" tabindex="-1"></a></span>
<span id="cb81-26"><a href="Recruit.html#cb81-26" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb81-27"><a href="Recruit.html#cb81-27" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;Y&quot;</span>, <span class="st">&quot;Survey_R&quot;</span>, <span class="st">&quot;Survey_B&quot;</span>)</span>
<span id="cb81-28"><a href="Recruit.html#cb81-28" tabindex="-1"></a></span>
<span id="cb81-29"><a href="Recruit.html#cb81-29" tabindex="-1"></a><span class="co"># Initial values</span></span>
<span id="cb81-30"><a href="Recruit.html#cb81-30" tabindex="-1"></a>y <span class="ot">&lt;-</span> Survey_R[<span class="dv">2</span><span class="sc">:</span>Y]</span>
<span id="cb81-31"><a href="Recruit.html#cb81-31" tabindex="-1"></a>x <span class="ot">&lt;-</span> Survey_B[<span class="dv">1</span><span class="sc">:</span>(Y<span class="dv">-1</span>)]</span>
<span id="cb81-32"><a href="Recruit.html#cb81-32" tabindex="-1"></a>nls_init <span class="ot">&lt;-</span> <span class="fu">nls</span>(y <span class="sc">~</span> <span class="dv">1</span><span class="sc">/</span>(BH_a_start<span class="sc">+</span>BH_b_start<span class="sc">/</span>x),</span>
<span id="cb81-33"><a href="Recruit.html#cb81-33" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">list</span>(<span class="at">BH_a_start =</span> <span class="fl">0.001</span>, <span class="at">BH_b_start =</span> <span class="fl">0.001</span>),</span>
<span id="cb81-34"><a href="Recruit.html#cb81-34" tabindex="-1"></a>                <span class="at">algorithm=</span><span class="st">&quot;port&quot;</span>, </span>
<span id="cb81-35"><a href="Recruit.html#cb81-35" tabindex="-1"></a>                <span class="at">lower=</span><span class="fu">c</span>(<span class="fl">1E-6</span>, <span class="dv">0</span>), <span class="at">upper=</span><span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">1000</span>))</span>
<span id="cb81-36"><a href="Recruit.html#cb81-36" tabindex="-1"></a><span class="co">#summary(nls_init)</span></span>
<span id="cb81-37"><a href="Recruit.html#cb81-37" tabindex="-1"></a>nls_save <span class="ot">&lt;-</span> <span class="fu">coef</span>(nls_init)</span>
<span id="cb81-38"><a href="Recruit.html#cb81-38" tabindex="-1"></a><span class="co">#y_hat &lt;- 1/(nls_save[1]+nls_save[2]/x)</span></span>
<span id="cb81-39"><a href="Recruit.html#cb81-39" tabindex="-1"></a><span class="co">#plot(x,y)</span></span>
<span id="cb81-40"><a href="Recruit.html#cb81-40" tabindex="-1"></a><span class="co">#points(x,y_hat, col=&quot;red&quot;, type=&quot;l&quot;)</span></span>
<span id="cb81-41"><a href="Recruit.html#cb81-41" tabindex="-1"></a></span>
<span id="cb81-42"><a href="Recruit.html#cb81-42" tabindex="-1"></a>jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){ <span class="fu">list</span>(<span class="at">BH_alpha.est=</span>nls_save[<span class="dv">1</span>],</span>
<span id="cb81-43"><a href="Recruit.html#cb81-43" tabindex="-1"></a>                               <span class="at">BH_beta.est=</span>nls_save[<span class="dv">2</span>],</span>
<span id="cb81-44"><a href="Recruit.html#cb81-44" tabindex="-1"></a>                               <span class="at">SD_rec.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="fl">0.75</span>))}</span>
<span id="cb81-45"><a href="Recruit.html#cb81-45" tabindex="-1"></a></span>
<span id="cb81-46"><a href="Recruit.html#cb81-46" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;StockRecruit.txt&#39;</span></span>
<span id="cb81-47"><a href="Recruit.html#cb81-47" tabindex="-1"></a></span>
<span id="cb81-48"><a href="Recruit.html#cb81-48" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb81-49"><a href="Recruit.html#cb81-49" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;BH_alpha.est&quot;</span>, <span class="st">&quot;BH_beta.est&quot;</span>, <span class="st">&quot;SD_rec.est&quot;</span>,</span>
<span id="cb81-50"><a href="Recruit.html#cb81-50" tabindex="-1"></a>                 <span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb81-51"><a href="Recruit.html#cb81-51" tabindex="-1"></a></span>
<span id="cb81-52"><a href="Recruit.html#cb81-52" tabindex="-1"></a><span class="co"># Call JAGS from R</span></span>
<span id="cb81-53"><a href="Recruit.html#cb81-53" tabindex="-1"></a>jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb81-54"><a href="Recruit.html#cb81-54" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">10000</span>,</span>
<span id="cb81-55"><a href="Recruit.html#cb81-55" tabindex="-1"></a>                model.file)</span>
<span id="cb81-56"><a href="Recruit.html#cb81-56" tabindex="-1"></a><span class="fu">print</span>(jagsfit)</span>
<span id="cb81-57"><a href="Recruit.html#cb81-57" tabindex="-1"></a><span class="fu">plot</span>(jagsfit)</span>
<span id="cb81-58"><a href="Recruit.html#cb81-58" tabindex="-1"></a></span>
<span id="cb81-59"><a href="Recruit.html#cb81-59" tabindex="-1"></a>BH.DIC <span class="ot">&lt;-</span> jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>DIC <span class="co"># Used in next section</span></span>
<span id="cb81-60"><a href="Recruit.html#cb81-60" tabindex="-1"></a></span>
<span id="cb81-61"><a href="Recruit.html#cb81-61" tabindex="-1"></a>min.y <span class="ot">&lt;-</span> <span class="fu">min</span>(Survey_R[<span class="dv">2</span><span class="sc">:</span>Y],jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>mean<span class="sc">$</span>R_hat)</span>
<span id="cb81-62"><a href="Recruit.html#cb81-62" tabindex="-1"></a>max.y <span class="ot">&lt;-</span> <span class="fu">max</span>(Survey_R[<span class="dv">2</span><span class="sc">:</span>Y],jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>mean<span class="sc">$</span>R_hat)</span>
<span id="cb81-63"><a href="Recruit.html#cb81-63" tabindex="-1"></a></span>
<span id="cb81-64"><a href="Recruit.html#cb81-64" tabindex="-1"></a>df.xy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Survey_B[<span class="dv">1</span><span class="sc">:</span>(Y<span class="dv">-1</span>)], Survey_R[<span class="dv">2</span><span class="sc">:</span>Y],jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>mean<span class="sc">$</span>R_hat)</span>
<span id="cb81-65"><a href="Recruit.html#cb81-65" tabindex="-1"></a>df.xy <span class="ot">&lt;-</span> df.xy[<span class="fu">order</span>(df.xy[,<span class="dv">1</span>]),]  <span class="co"># Sort by survey index for plotting</span></span>
<span id="cb81-66"><a href="Recruit.html#cb81-66" tabindex="-1"></a></span>
<span id="cb81-67"><a href="Recruit.html#cb81-67" tabindex="-1"></a><span class="fu">plot</span>(df.xy[,<span class="dv">1</span>],df.xy[,<span class="dv">2</span>], <span class="at">ylab=</span><span class="st">&quot;Recruitment index&quot;</span>,</span>
<span id="cb81-68"><a href="Recruit.html#cb81-68" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Spawning Stock Index&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(min.y, max.y))</span>
<span id="cb81-69"><a href="Recruit.html#cb81-69" tabindex="-1"></a><span class="fu">points</span>(df.xy[,<span class="dv">1</span>], df.xy[,<span class="dv">3</span>], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p>Randomly chosen starting values for the two Beverton-Holt parameters sometimes caused JAGS to crash, so <code>nls()</code>, the R function for nonlinear least-squares, was used to generate good initial values. When unconstrained, <code>nls()</code> occasionally produced a negative estimate of the first parameter (1/asymptotic recruitment), so the “port” algorithm was used to allow bounds to be specified. The <code>nls()</code> code illustrates the compactness of using R functions, compared to a Bayesian analysis, but also the “black box” nature of the analysis.</p>
<p>The JAGS results tend to be reliable for the default settings. The plotted estimates of the recruitment indices capture the decrease due to declining spawning stock size. Estimates of the Beverton-Holt alpha parameter are typically close to 0.01 (BH_alpha/Survey_q), because we fit the curve to a recruitment index (true recruitment * Survey_q) rather than to absolute levels. Estimates of the Beverton-Holt beta parameter tend to be close to the true value. Estimates of the standard deviation for variation about the curve tend to be higher than the true value of 0.25, because the points vary due not only to true recruitment variation but also variation due to survey sampling.</p>
<p>As always, it is very helpful to view the points and fitted curve (Figure <a href="Recruit.html#fig:SRRPlot">9.1</a>). We use a data frame to sort the spawning stock, recruitment, and predicted recruitment indicies, in order to have a smooth fitted curve (i.e., continuously increasing spawning stock values). (A data frame is a collection of variables, similar to a spreadsheet. Columns have the same number of observations but can be of different types.) Try multiple runs to see how variation in recruitment affects the pattern of points and fitted curve.</p>
<div class="figure"><span style="display:block;" id="fig:SRRPlot"></span>
<img src="bookdown_files/figure-html/SRRPlot-1.png" alt="Example of fitted Beverton-Holt curve relating indices of spawning stock and recruitment." width="90%" />
<p class="caption">
FIGURE 9.1: Example of fitted Beverton-Holt curve relating indices of spawning stock and recruitment.
</p>
</div>
</div>
<div id="Recruit-DIC" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Does spawning stock size affect recruitment?<a href="Recruit.html#Recruit-DIC" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Section <a href="Recruit.html#Recruit-Fit">9.1</a> illustrated the process of model fitting but did not answer the question of whether there is a detectable relationship between the spawning stock and recruitment indices. To address that question, we return to the approach shown in Section <a href="Model-fit.html#Model-selection">4.3.6</a>; i.e., comparing DIC scores for candidate models. Here the two candidates are the full Beverton-Holt model and a reduced model with constant recruitment.</p>
<p>We append JAGS code for the constant recruitment case at the end of the previous code so that both models are applied to the same spawning stock and recruitment data. Convergence is extremely rapid for this simpler case. The difference in DIC scores between the full (Beverton-Holt) and reduced (constant recruitment) models is printed to the Console, but it is also useful to compare pD, deviance, and DIC scores.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="Recruit.html#cb82-1" tabindex="-1"></a><span class="co"># Constant recruitment fit</span></span>
<span id="cb82-2"><a href="Recruit.html#cb82-2" tabindex="-1"></a><span class="co"># JAGS code ##################################</span></span>
<span id="cb82-3"><a href="Recruit.html#cb82-3" tabindex="-1"></a></span>
<span id="cb82-4"><a href="Recruit.html#cb82-4" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;StockRecruit.txt&quot;</span>)</span>
<span id="cb82-5"><a href="Recruit.html#cb82-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb82-6"><a href="Recruit.html#cb82-6" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb82-7"><a href="Recruit.html#cb82-7" tabindex="-1"></a><span class="st"># Model parameters: Beverton-Holt alpha, SD for fitted curve</span></span>
<span id="cb82-8"><a href="Recruit.html#cb82-8" tabindex="-1"></a></span>
<span id="cb82-9"><a href="Recruit.html#cb82-9" tabindex="-1"></a><span class="st"># Priors</span></span>
<span id="cb82-10"><a href="Recruit.html#cb82-10" tabindex="-1"></a><span class="st"> BH_alpha.est ~ dunif(0, 10)</span></span>
<span id="cb82-11"><a href="Recruit.html#cb82-11" tabindex="-1"></a><span class="st"> SD_rec.est ~ dunif(0, 10)</span></span>
<span id="cb82-12"><a href="Recruit.html#cb82-12" tabindex="-1"></a><span class="st"> tau &lt;- pow(SD_rec.est, -2)</span></span>
<span id="cb82-13"><a href="Recruit.html#cb82-13" tabindex="-1"></a></span>
<span id="cb82-14"><a href="Recruit.html#cb82-14" tabindex="-1"></a><span class="st"># Likelihood</span></span>
<span id="cb82-15"><a href="Recruit.html#cb82-15" tabindex="-1"></a><span class="st">    for(y in 2:Y) {</span></span>
<span id="cb82-16"><a href="Recruit.html#cb82-16" tabindex="-1"></a><span class="st">      lnR_hat[y] &lt;- log(1/BH_alpha.est)</span></span>
<span id="cb82-17"><a href="Recruit.html#cb82-17" tabindex="-1"></a><span class="st">      Survey_R[y] ~ dlnorm(lnR_hat[y],tau)</span></span>
<span id="cb82-18"><a href="Recruit.html#cb82-18" tabindex="-1"></a><span class="st">      R_hat[y] &lt;- exp(lnR_hat[y])</span></span>
<span id="cb82-19"><a href="Recruit.html#cb82-19" tabindex="-1"></a><span class="st">      } #y</span></span>
<span id="cb82-20"><a href="Recruit.html#cb82-20" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb82-21"><a href="Recruit.html#cb82-21" tabindex="-1"></a><span class="st">    &quot;</span>,<span class="at">fill=</span><span class="cn">TRUE</span>)</span>
<span id="cb82-22"><a href="Recruit.html#cb82-22" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb82-23"><a href="Recruit.html#cb82-23" tabindex="-1"></a></span>
<span id="cb82-24"><a href="Recruit.html#cb82-24" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb82-25"><a href="Recruit.html#cb82-25" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;Y&quot;</span>, <span class="st">&quot;Survey_R&quot;</span>)</span>
<span id="cb82-26"><a href="Recruit.html#cb82-26" tabindex="-1"></a></span>
<span id="cb82-27"><a href="Recruit.html#cb82-27" tabindex="-1"></a>jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){ <span class="fu">list</span>(<span class="at">BH_alpha.est=</span>nls_save[<span class="dv">1</span>],</span>
<span id="cb82-28"><a href="Recruit.html#cb82-28" tabindex="-1"></a>                               <span class="at">SD_rec.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="fl">0.75</span>))}</span>
<span id="cb82-29"><a href="Recruit.html#cb82-29" tabindex="-1"></a></span>
<span id="cb82-30"><a href="Recruit.html#cb82-30" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;StockRecruit.txt&#39;</span></span>
<span id="cb82-31"><a href="Recruit.html#cb82-31" tabindex="-1"></a></span>
<span id="cb82-32"><a href="Recruit.html#cb82-32" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb82-33"><a href="Recruit.html#cb82-33" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;BH_alpha.est&quot;</span>, <span class="st">&quot;SD_rec.est&quot;</span>, <span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb82-34"><a href="Recruit.html#cb82-34" tabindex="-1"></a></span>
<span id="cb82-35"><a href="Recruit.html#cb82-35" tabindex="-1"></a><span class="co"># Call JAGS from R</span></span>
<span id="cb82-36"><a href="Recruit.html#cb82-36" tabindex="-1"></a>jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb82-37"><a href="Recruit.html#cb82-37" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">10000</span>,</span>
<span id="cb82-38"><a href="Recruit.html#cb82-38" tabindex="-1"></a>                model.file)</span>
<span id="cb82-39"><a href="Recruit.html#cb82-39" tabindex="-1"></a><span class="fu">print</span>(jagsfit)</span>
<span id="cb82-40"><a href="Recruit.html#cb82-40" tabindex="-1"></a><span class="fu">plot</span>(jagsfit)</span>
<span id="cb82-41"><a href="Recruit.html#cb82-41" tabindex="-1"></a>ConstR.DIC <span class="ot">&lt;-</span> jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>DIC</span>
<span id="cb82-42"><a href="Recruit.html#cb82-42" tabindex="-1"></a>ConstR.DIC <span class="sc">-</span> BH.DIC</span></code></pre></div>
<p>With the default settings, the DIC score is typically higher (indicating a poorer fit) for the constant recruitment model. Next, try varying some of the simulation settings. The pattern for annual fishing mortality could be altered to produce less of a decline over time in spawning stock (less contrast). Higher levels of recruitment variation are not uncommon [e.g., 0.5-0.75; <span class="citation">Hightower and Grossman (<a href="#ref-hightower.grossman_1985">1985</a>)</span>], and will make the relationship harder to detect. For a lognormal variance of 0.5 or 0.75, the DIC score may actually be lower for the constant recruitment model because of a smaller penalty for model complexity (smaller estimate of pD). Other potential settings to vary include the length of the time series and the precision of the survey data. Be sure to look back at the scatter plot and fitted Beverton-Holt curve, to get a sense of how the constant recruitment model would compare.</p>
</div>
<div id="exercises-6" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Exercises<a href="Recruit.html#exercises-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>Revise the code for Section <a href="Recruit.html#Recruit-Fit">9.1</a> to fit a Ricker model (<span class="math inline">\(R=\alpha*B_S*exp(-\beta*B_S)\)</span>). Experiment with the Ricker parameters to produce maximum recruitment at an intermediate observed spawning stock size.</p></li>
<li><p>The expected value for <span class="math inline">\(\alpha\)</span> (0.01 for our default simulation settings) is the true underlying value divided by the survey catchability, because we are fitting the model using survey indices rather than estimates of absolute abundance. Compare estimates of <span class="math inline">\(\alpha\)</span> for the Beverton-Holt and constant recruitment models, using the approach from Section <a href="Recruit.html#Recruit-DIC">9.2</a>. Explain any pattern that you detect.</p></li>
</ol>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-hightower.grossman_1985" class="csl-entry">
Hightower, Joseph E., and Gary D. Grossman. 1985. <span>“Comparison of <span>Constant Effort Harvest Policies</span> for <span>Fish Stocks</span> with <span>Variable Recruitment</span>.”</span> <em>Canadian Journal of Fisheries and Aquatic Sciences</em> 42 (5): 982–88. <a href="https://doi.org/10.1139/f85-123">https://doi.org/10.1139/f85-123</a>.
</div>
<div id="ref-hilborn.walters_1992" class="csl-entry">
Hilborn, Ray, and Carl J. Walters. 1992. <em>Quantitative <span>Fisheries Stock Assessment</span></em>. Boston, MA: Springer US. <a href="https://doi.org/10.1007/978-1-4615-3598-0">https://doi.org/10.1007/978-1-4615-3598-0</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Growth.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Trend.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-crc/edit/master/09-Recruitment.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown.pdf", "bookdown.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
