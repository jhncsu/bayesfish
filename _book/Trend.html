<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Population trends | A Bayesian Introduction to Fish Population Analysis</title>
  <meta name="description" content="This book is intended to be a bridge between traditional fisheries analytical methods and Bayesian statistics. It is a hands-on introduction to models for estimating abundance, survival, growth, recruitment, and population trends." />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Population trends | A Bayesian Introduction to Fish Population Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book is intended to be a bridge between traditional fisheries analytical methods and Bayesian statistics. It is a hands-on introduction to models for estimating abundance, survival, growth, recruitment, and population trends." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Population trends | A Bayesian Introduction to Fish Population Analysis" />
  
  <meta name="twitter:description" content="This book is intended to be a bridge between traditional fisheries analytical methods and Bayesian statistics. It is a hands-on introduction to models for estimating abundance, survival, growth, recruitment, and population trends." />
  

<meta name="author" content="Joseph E. Hightower" />


<meta name="date" content="2024-11-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Recruit.html"/>
<link rel="next" href="PopModels.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Joe Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-information-and-conventions"><i class="fa fa-check"></i>Software information and conventions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="R-intro.html"><a href="R-intro.html"><i class="fa fa-check"></i><b>2</b> A Brief Introduction to R and RStudio</a></li>
<li class="chapter" data-level="3" data-path="Distributions.html"><a href="Distributions.html"><i class="fa fa-check"></i><b>3</b> Probability Distributions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Distributions.html"><a href="Distributions.html#Discrete"><i class="fa fa-check"></i><b>3.1</b> Discrete</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="Distributions.html"><a href="Distributions.html#Bernoulli"><i class="fa fa-check"></i><b>3.1.1</b> Bernoulli</a></li>
<li class="chapter" data-level="3.1.2" data-path="Distributions.html"><a href="Distributions.html#BinomialDist"><i class="fa fa-check"></i><b>3.1.2</b> Binomial</a></li>
<li class="chapter" data-level="3.1.3" data-path="Distributions.html"><a href="Distributions.html#Multinomial"><i class="fa fa-check"></i><b>3.1.3</b> Multinomial</a></li>
<li class="chapter" data-level="3.1.4" data-path="Distributions.html"><a href="Distributions.html#PoissonDist"><i class="fa fa-check"></i><b>3.1.4</b> Poisson</a></li>
<li class="chapter" data-level="3.1.5" data-path="Distributions.html"><a href="Distributions.html#NegBinom"><i class="fa fa-check"></i><b>3.1.5</b> Negative binomial</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="Distributions.html"><a href="Distributions.html#Continuous"><i class="fa fa-check"></i><b>3.2</b> Continuous</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="Distributions.html"><a href="Distributions.html#Uniform"><i class="fa fa-check"></i><b>3.2.1</b> Uniform</a></li>
<li class="chapter" data-level="3.2.2" data-path="Distributions.html"><a href="Distributions.html#BetaDist"><i class="fa fa-check"></i><b>3.2.2</b> Beta</a></li>
<li class="chapter" data-level="3.2.3" data-path="Distributions.html"><a href="Distributions.html#NormalDist"><i class="fa fa-check"></i><b>3.2.3</b> Normal</a></li>
<li class="chapter" data-level="3.2.4" data-path="Distributions.html"><a href="Distributions.html#LognormalDist"><i class="fa fa-check"></i><b>3.2.4</b> Lognormal</a></li>
<li class="chapter" data-level="3.2.5" data-path="Distributions.html"><a href="Distributions.html#GammaDist"><i class="fa fa-check"></i><b>3.2.5</b> Gamma</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="Distributions.html"><a href="Distributions.html#exercises"><i class="fa fa-check"></i><b>3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Model-fit.html"><a href="Model-fit.html"><i class="fa fa-check"></i><b>4</b> Model Fitting</a>
<ul>
<li class="chapter" data-level="4.1" data-path="Model-fit.html"><a href="Model-fit.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="Model-fit.html"><a href="Model-fit.html#Model-fit-sim"><i class="fa fa-check"></i><b>4.2</b> Using simulation</a></li>
<li class="chapter" data-level="4.3" data-path="Model-fit.html"><a href="Model-fit.html#JAGS-model-fit"><i class="fa fa-check"></i><b>4.3</b> Using Bayesian methods</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="Model-fit.html"><a href="Model-fit.html#Debug"><i class="fa fa-check"></i><b>4.3.1</b> Debugging code</a></li>
<li class="chapter" data-level="4.3.2" data-path="Model-fit.html"><a href="Model-fit.html#Convergence"><i class="fa fa-check"></i><b>4.3.2</b> Judging convergence</a></li>
<li class="chapter" data-level="4.3.3" data-path="Model-fit.html"><a href="Model-fit.html#Likelihood"><i class="fa fa-check"></i><b>4.3.3</b> What is a likelihood?</a></li>
<li class="chapter" data-level="4.3.4" data-path="Model-fit.html"><a href="Model-fit.html#Deviance"><i class="fa fa-check"></i><b>4.3.4</b> Deviance as a measure of model fit</a></li>
<li class="chapter" data-level="4.3.5" data-path="Model-fit.html"><a href="Model-fit.html#Model-checking"><i class="fa fa-check"></i><b>4.3.5</b> Model checking</a></li>
<li class="chapter" data-level="4.3.6" data-path="Model-fit.html"><a href="Model-fit.html#Model-selection"><i class="fa fa-check"></i><b>4.3.6</b> Model selection</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="Model-fit.html"><a href="Model-fit.html#exercises-1"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Abundance.html"><a href="Abundance.html"><i class="fa fa-check"></i><b>5</b> Abundance</a>
<ul>
<li class="chapter" data-level="5.1" data-path="Abundance.html"><a href="Abundance.html#removal"><i class="fa fa-check"></i><b>5.1</b> Removal</a></li>
<li class="chapter" data-level="5.2" data-path="Abundance.html"><a href="Abundance.html#mark-recapture"><i class="fa fa-check"></i><b>5.2</b> Mark-recapture</a></li>
<li class="chapter" data-level="5.3" data-path="Abundance.html"><a href="Abundance.html#binomial-mixture"><i class="fa fa-check"></i><b>5.3</b> Binomial-mixture</a></li>
<li class="chapter" data-level="5.4" data-path="Abundance.html"><a href="Abundance.html#exercises-2"><i class="fa fa-check"></i><b>5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Survival.html"><a href="Survival.html"><i class="fa fa-check"></i><b>6</b> Survival</a>
<ul>
<li class="chapter" data-level="6.1" data-path="Survival.html"><a href="Survival.html#AgeComp"><i class="fa fa-check"></i><b>6.1</b> Age-composition</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="Survival.html"><a href="Survival.html#CC_Selectivity"><i class="fa fa-check"></i><b>6.1.1</b> Accounting For Gear Selectivity</a></li>
<li class="chapter" data-level="6.1.2" data-path="Survival.html"><a href="Survival.html#Cohort"><i class="fa fa-check"></i><b>6.1.2</b> Cohort model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="Survival.html"><a href="Survival.html#TelemetryBased"><i class="fa fa-check"></i><b>6.2</b> Telemetry-based</a></li>
<li class="chapter" data-level="6.3" data-path="Survival.html"><a href="Survival.html#BrownieSurvival"><i class="fa fa-check"></i><b>6.3</b> Tag-based</a></li>
<li class="chapter" data-level="6.4" data-path="Survival.html"><a href="Survival.html#exercises-3"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="Mortality.html"><a href="Mortality.html"><i class="fa fa-check"></i><b>7</b> Mortality Components</a>
<ul>
<li class="chapter" data-level="7.1" data-path="Mortality.html"><a href="Mortality.html#ExpRate"><i class="fa fa-check"></i><b>7.1</b> Exploitation rate</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="Mortality.html"><a href="Mortality.html#InformativePriors"><i class="fa fa-check"></i><b>7.1.1</b> Informative prior distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="Mortality.html"><a href="Mortality.html#Hearn"><i class="fa fa-check"></i><b>7.2</b> Completed tagging study</a></li>
<li class="chapter" data-level="7.3" data-path="Mortality.html"><a href="Mortality.html#BrownieFandM"><i class="fa fa-check"></i><b>7.3</b> Multi-year tagging study</a></li>
<li class="chapter" data-level="7.4" data-path="Mortality.html"><a href="Mortality.html#TelemetryFandM"><i class="fa fa-check"></i><b>7.4</b> Telemetry estimates of F and M</a></li>
<li class="chapter" data-level="7.5" data-path="Mortality.html"><a href="Mortality.html#exercises-4"><i class="fa fa-check"></i><b>7.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Growth.html"><a href="Growth.html"><i class="fa fa-check"></i><b>8</b> Growth</a>
<ul>
<li class="chapter" data-level="8.1" data-path="Growth.html"><a href="Growth.html#vonBert"><i class="fa fa-check"></i><b>8.1</b> Growth in length</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="Growth.html"><a href="Growth.html#Otolith"><i class="fa fa-check"></i><b>8.1.1</b> Age-length</a></li>
<li class="chapter" data-level="8.1.2" data-path="Growth.html"><a href="Growth.html#GrowthInc"><i class="fa fa-check"></i><b>8.1.2</b> Using tagging data</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="Growth.html"><a href="Growth.html#LnWgt"><i class="fa fa-check"></i><b>8.2</b> Growth in weight</a></li>
<li class="chapter" data-level="8.3" data-path="Growth.html"><a href="Growth.html#exercises-5"><i class="fa fa-check"></i><b>8.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="Recruit.html"><a href="Recruit.html"><i class="fa fa-check"></i><b>9</b> Recruitment</a>
<ul>
<li class="chapter" data-level="9.1" data-path="Recruit.html"><a href="Recruit.html#Recruit-Fit"><i class="fa fa-check"></i><b>9.1</b> Fitting a stock-recruitment curve</a></li>
<li class="chapter" data-level="9.2" data-path="Recruit.html"><a href="Recruit.html#Recruit-DIC"><i class="fa fa-check"></i><b>9.2</b> Does spawning stock size affect recruitment?</a></li>
<li class="chapter" data-level="9.3" data-path="Recruit.html"><a href="Recruit.html#exercises-6"><i class="fa fa-check"></i><b>9.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="Trend.html"><a href="Trend.html"><i class="fa fa-check"></i><b>10</b> Population trends</a>
<ul>
<li class="chapter" data-level="10.1" data-path="Trend.html"><a href="Trend.html#Linear"><i class="fa fa-check"></i><b>10.1</b> Linear model</a></li>
<li class="chapter" data-level="10.2" data-path="Trend.html"><a href="Trend.html#ExpGr"><i class="fa fa-check"></i><b>10.2</b> Exponential growth model</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="Trend.html"><a href="Trend.html#Forecast"><i class="fa fa-check"></i><b>10.2.1</b> Forecasting</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="Trend.html"><a href="Trend.html#exercises-7"><i class="fa fa-check"></i><b>10.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="PopModels.html"><a href="PopModels.html"><i class="fa fa-check"></i><b>11</b> Integrated Population Models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="PopModels.html"><a href="PopModels.html#TwoAge"><i class="fa fa-check"></i><b>11.1</b> Two-age model</a></li>
<li class="chapter" data-level="11.2" data-path="PopModels.html"><a href="PopModels.html#CAGEAN"><i class="fa fa-check"></i><b>11.2</b> Full age-structured model</a></li>
<li class="chapter" data-level="11.3" data-path="PopModels.html"><a href="PopModels.html#exercises-8"><i class="fa fa-check"></i><b>11.3</b> Exercises</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="title-placeholder.html"><a href="title-placeholder.html"><i class="fa fa-check"></i><b>A</b> Title Placeholder</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Bayesian Introduction to Fish Population Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Trend" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Population trends<a href="Trend.html#Trend" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>A common goal for biologists is to estimate trends in population abundance. For example, population change for a threatened or endangered species could indicate whether a recovery plan was working. For exploited species, survey data are often used to assess the effectiveness of a management plan (e.g., whether a population was building toward a target level). Models for population trends can utilize information on relative or absolute abundance. Surveys of relative abundance are more common, especially for larger populations. The general approach is to conduct a survey using consistent methods over time, using a gear such as electrofishing, traps, or nets. It is assumed that trends in survey catch reflect trends in abundance. Said another way, we are assuming that catches (on average) are directly proportional to abundance.</p>
<p>There are several important aspects in planning a survey for monitoring population trends. Presumably the focus is on annual trends, so one decision would be how many years would be required before a trend could be detected. Other considerations are the variability of survey observations and the magnitude of change we seek to detect. More gradual changes require much higher precision than if we only seek to detect large increases or decreases. We begin with the simplest case of whether there is a linear trend in relative abundance. This is a Bayesian version of the simple linear regression analysis of traditional statistics courses. Then we consider a more advanced model intended to capture the underlying population dynamics.</p>
<div id="Linear" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Linear model<a href="Trend.html#Linear" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We begin with the simulation code for generating absolute abundance, which is unknown, and relative abundance as estimated by the survey. Variables that describe the data set and survey process include the length of the time series (n.years), mean population growth rate (mean.lambda), and the standard deviation for the annual growth rate (sigma.lambda). We use a 10-year survey data set, which seems relatively short for a trend analysis but would also be a daunting task if starting up a new survey. The starting absolute population size (10,000) is arbitrary and not estimable, but we can examine trends in relative abundance from the annual catches.</p>
<p>Following <span class="citation">Kéry and Schaub (<a href="#ref-kéry.schaub_2011">2011</a>)</span> (their Section 5.2), population change is modeled assuming exponential growth. A value just above 1 (1.02) for the mean population growth rate provides for a modest rate of population increase, on average. The standard deviation introduces stochasticity in the annual changes, as could occur due to variation in fishing effort or environmental factors. The expected survey catch is the product of population size and the capture probability, or fraction of the population caught by our annual “unit” of survey effort. We use a default capture probability of 0.025. Observation error for the survey catches allows for normally-distributed random variation about the expected catch. Note that a different formulation (e.g., lognormal errors) should be used if observation error is large enough to generate negative values.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="Trend.html#cb1-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb1-2"><a href="Trend.html#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="Trend.html#cb1-3" tabindex="-1"></a><span class="co"># Generation of simulated data</span></span>
<span id="cb1-4"><a href="Trend.html#cb1-4" tabindex="-1"></a>n.years <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb1-5"><a href="Trend.html#cb1-5" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># Initial population size</span></span>
<span id="cb1-6"><a href="Trend.html#cb1-6" tabindex="-1"></a>mean.lambda <span class="ot">&lt;-</span> <span class="fl">1.02</span> <span class="co"># Mean annual population growth rate</span></span>
<span id="cb1-7"><a href="Trend.html#cb1-7" tabindex="-1"></a>sigma.lambda <span class="ot">&lt;-</span> <span class="fl">0.02</span> <span class="co"># Process (temporal) variation in the growth rate (SD)</span></span>
<span id="cb1-8"><a href="Trend.html#cb1-8" tabindex="-1"></a>p.survey <span class="ot">&lt;-</span> <span class="fl">0.025</span> <span class="co"># Default capture probability for survey</span></span>
<span id="cb1-9"><a href="Trend.html#cb1-9" tabindex="-1"></a>sigma.obs <span class="ot">&lt;-</span> <span class="dv">40</span> <span class="co"># Observation error for survey catch (SD)</span></span>
<span id="cb1-10"><a href="Trend.html#cb1-10" tabindex="-1"></a>C <span class="ot">&lt;-</span> N <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n.years)</span>
<span id="cb1-11"><a href="Trend.html#cb1-11" tabindex="-1"></a>N[<span class="dv">1</span>] <span class="ot">&lt;-</span> N1</span>
<span id="cb1-12"><a href="Trend.html#cb1-12" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.years<span class="dv">-1</span>, mean.lambda, sigma.lambda) </span>
<span id="cb1-13"><a href="Trend.html#cb1-13" tabindex="-1"></a><span class="co"># Lambda is vector of annual population growth rates</span></span>
<span id="cb1-14"><a href="Trend.html#cb1-14" tabindex="-1"></a><span class="cf">for</span> (y <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n.years<span class="dv">-1</span>)){</span>
<span id="cb1-15"><a href="Trend.html#cb1-15" tabindex="-1"></a>  N[y<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> N[y] <span class="sc">*</span> lambda[y]</span>
<span id="cb1-16"><a href="Trend.html#cb1-16" tabindex="-1"></a>}</span>
<span id="cb1-17"><a href="Trend.html#cb1-17" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>n.years, <span class="at">mean=</span>p.survey<span class="sc">*</span>N, <span class="at">sd=</span>sigma.obs)</span>
<span id="cb1-18"><a href="Trend.html#cb1-18" tabindex="-1"></a><span class="fu">plot</span>(C, <span class="at">ylab=</span><span class="st">&quot;Survey Catch&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>)</span></code></pre></div>
<p>Run the simulation code several times to gain insight into the level of variation possible in a ten-year pattern. Then vary survey length, mean population growth rate and temporal variation, capture probability, and observation error to understand how each setting contributes to the survey pattern of relative abundance.</p>
<p>The JAGS code treats the annual survey catches as independent observations, and estimates an intercept (<span class="math inline">\(b_1\)</span>) and slope (<span class="math inline">\(b_2\)</span>) for the linear regression model relating year to the relative abundance data. A third parameter (sigma.est) accounts for variation in the survey catch around the line, which would be due not only to observation error but also annual variation in population growth. Uninformative prior distributions are used for the three parameters. The initial value for the slope is set at 0, and the initial value for the intercept varies between the minimum and maximum observed annual catch.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="Trend.html#cb2-1" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb2-2"><a href="Trend.html#cb2-2" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb2-3"><a href="Trend.html#cb2-3" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb2-4"><a href="Trend.html#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="Trend.html#cb2-5" tabindex="-1"></a><span class="co"># JAGS code for estimating model parameters</span></span>
<span id="cb2-6"><a href="Trend.html#cb2-6" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;PopTrend_Linear.txt&quot;</span>)</span>
<span id="cb2-7"><a href="Trend.html#cb2-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb2-8"><a href="Trend.html#cb2-8" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb2-9"><a href="Trend.html#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a href="Trend.html#cb2-10" tabindex="-1"></a><span class="st"># Priors</span></span>
<span id="cb2-11"><a href="Trend.html#cb2-11" tabindex="-1"></a><span class="st">for (i in 1:2){</span></span>
<span id="cb2-12"><a href="Trend.html#cb2-12" tabindex="-1"></a><span class="st">  b[i] ~ dnorm(0, 0.0001)</span></span>
<span id="cb2-13"><a href="Trend.html#cb2-13" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb2-14"><a href="Trend.html#cb2-14" tabindex="-1"></a><span class="st">sigma.est ~ dunif(0, 100)</span></span>
<span id="cb2-15"><a href="Trend.html#cb2-15" tabindex="-1"></a><span class="st">tau &lt;- pow(sigma.est, -2)</span></span>
<span id="cb2-16"><a href="Trend.html#cb2-16" tabindex="-1"></a></span>
<span id="cb2-17"><a href="Trend.html#cb2-17" tabindex="-1"></a><span class="st">  # Likelihood</span></span>
<span id="cb2-18"><a href="Trend.html#cb2-18" tabindex="-1"></a><span class="st">  for (y in 1:n.years){</span></span>
<span id="cb2-19"><a href="Trend.html#cb2-19" tabindex="-1"></a><span class="st">  ExpC[y] &lt;- b[1] + b[2]*y</span></span>
<span id="cb2-20"><a href="Trend.html#cb2-20" tabindex="-1"></a><span class="st">  C[y] ~ dnorm(ExpC[y], tau)</span></span>
<span id="cb2-21"><a href="Trend.html#cb2-21" tabindex="-1"></a><span class="st">  } #y</span></span>
<span id="cb2-22"><a href="Trend.html#cb2-22" tabindex="-1"></a><span class="st">  p.pos &lt;- step(b[2])</span></span>
<span id="cb2-23"><a href="Trend.html#cb2-23" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb2-24"><a href="Trend.html#cb2-24" tabindex="-1"></a><span class="st">    &quot;</span>,<span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-25"><a href="Trend.html#cb2-25" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb2-26"><a href="Trend.html#cb2-26" tabindex="-1"></a></span>
<span id="cb2-27"><a href="Trend.html#cb2-27" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb2-28"><a href="Trend.html#cb2-28" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;n.years&quot;</span>, <span class="st">&quot;C&quot;</span>)</span>
<span id="cb2-29"><a href="Trend.html#cb2-29" tabindex="-1"></a></span>
<span id="cb2-30"><a href="Trend.html#cb2-30" tabindex="-1"></a><span class="co"># Initial values.</span></span>
<span id="cb2-31"><a href="Trend.html#cb2-31" tabindex="-1"></a>jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){ <span class="fu">list</span>(<span class="at">b=</span><span class="fu">c</span>(<span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="fu">min</span>(C), <span class="at">max=</span><span class="fu">max</span>(C)), <span class="dv">0</span>),</span>
<span id="cb2-32"><a href="Trend.html#cb2-32" tabindex="-1"></a>                               <span class="at">sigma.est=</span><span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">100</span>)</span>
<span id="cb2-33"><a href="Trend.html#cb2-33" tabindex="-1"></a>                               )}</span>
<span id="cb2-34"><a href="Trend.html#cb2-34" tabindex="-1"></a></span>
<span id="cb2-35"><a href="Trend.html#cb2-35" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;PopTrend_Linear.txt&#39;</span></span>
<span id="cb2-36"><a href="Trend.html#cb2-36" tabindex="-1"></a></span>
<span id="cb2-37"><a href="Trend.html#cb2-37" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb2-38"><a href="Trend.html#cb2-38" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;b&quot;</span>, <span class="st">&quot;sigma.est&quot;</span>, <span class="st">&quot;p.pos&quot;</span>)</span>
<span id="cb2-39"><a href="Trend.html#cb2-39" tabindex="-1"></a></span>
<span id="cb2-40"><a href="Trend.html#cb2-40" tabindex="-1"></a><span class="co"># Call JAGS from R</span></span>
<span id="cb2-41"><a href="Trend.html#cb2-41" tabindex="-1"></a>jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb2-42"><a href="Trend.html#cb2-42" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">5000</span>,</span>
<span id="cb2-43"><a href="Trend.html#cb2-43" tabindex="-1"></a>                model.file)</span>
<span id="cb2-44"><a href="Trend.html#cb2-44" tabindex="-1"></a><span class="fu">print</span>(jagsfit)</span>
<span id="cb2-45"><a href="Trend.html#cb2-45" tabindex="-1"></a><span class="co">#plot(jagsfit)</span></span>
<span id="cb2-46"><a href="Trend.html#cb2-46" tabindex="-1"></a></span>
<span id="cb2-47"><a href="Trend.html#cb2-47" tabindex="-1"></a>year.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span>n.years)</span>
<span id="cb2-48"><a href="Trend.html#cb2-48" tabindex="-1"></a>C.hat <span class="ot">&lt;-</span> jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>mean<span class="sc">$</span>b[<span class="dv">1</span>]<span class="sc">+</span>jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>mean<span class="sc">$</span>b[<span class="dv">2</span>]<span class="sc">*</span>year.seq</span>
<span id="cb2-49"><a href="Trend.html#cb2-49" tabindex="-1"></a><span class="fu">points</span>(year.seq, C.hat, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p>For convenience in viewing the results, we skip plotting the jagsfit object and simply add the regression line to the original plot of survey catches (Figure <a href="Trend.html#fig:LinTrendPlot">10.1</a>). We can examine the credible interval for <span class="math inline">\(b_2\)</span> to determine whether the survey provides evidence of a trend (credible interval not including 0). A more quantitative approach is to estimate the probability of a positive mean growth rate <span class="citation">(<a href="#ref-pregler.etal_2019">Pregler et al. 2019</a>)</span>. We can use the <code>step()</code> function (which is 1 for an argument &gt; 0; 0 otherwise) to calculate the fraction of retained slope estimates that are greater than 0 (mean for calculated variable p.pos).</p>
<div class="figure"><span style="display:block;" id="fig:LinTrendPlot"></span>
<img src="bookdown_files/figure-html/LinTrendPlot-1.png" alt="Example of fitted linear model for survey catch versus year." width="90%" />
<p class="caption">
FIGURE 10.1: Example of fitted linear model for survey catch versus year.
</p>
</div>
<p>Try running the simulation and analysis code multiple times and see whether your visual interpretation of the pattern (or lack thereof) matches with the regression results. Then vary the simulation settings to see the level of support for a positive trend. For example, the probability of a positive mean growth rate was 0.80, 0.96, 0.84, 0.50, and 1.00 for five trials using the default settings, compared to 0.99, 0.57, 0.94, 0.98, and 0.97 if observation error was reduced by half.</p>
</div>
<div id="ExpGr" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Exponential growth model<a href="Trend.html#ExpGr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An exponential growth model was used in Section <a href="Trend.html#Linear">10.1</a> to simulate population change, but our analysis ignored the dependence between the annual survey catches. An improved approach would be to fit a model that attempts to reveal the underlying population dynamics. To better illustrate this modeling approach, we use a small starting population size (100), a longer time series (n.years=20), higher variation in population growth rate, and a reduced observation error (sigma.obs=30). Rather than survey catches, we assume here that our counts are for total population size, as might be obtained from a fish ladder or a hydroacoustic survey.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="Trend.html#cb3-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb3-2"><a href="Trend.html#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="Trend.html#cb3-3" tabindex="-1"></a><span class="co"># Generation of simulated data</span></span>
<span id="cb3-4"><a href="Trend.html#cb3-4" tabindex="-1"></a>n.years <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb3-5"><a href="Trend.html#cb3-5" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> <span class="dv">100</span>  <span class="co"># Initial population size</span></span>
<span id="cb3-6"><a href="Trend.html#cb3-6" tabindex="-1"></a>mean.lambda <span class="ot">&lt;-</span> <span class="fl">1.02</span> <span class="co"># Mean annual population growth rate</span></span>
<span id="cb3-7"><a href="Trend.html#cb3-7" tabindex="-1"></a>sigma.lambda <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># Process (temporal) variation in the growth rate (SD)</span></span>
<span id="cb3-8"><a href="Trend.html#cb3-8" tabindex="-1"></a>sigma.obs <span class="ot">&lt;-</span> <span class="dv">30</span> <span class="co"># Observation error for counts (SD)</span></span>
<span id="cb3-9"><a href="Trend.html#cb3-9" tabindex="-1"></a>C <span class="ot">&lt;-</span> N <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n.years)</span>
<span id="cb3-10"><a href="Trend.html#cb3-10" tabindex="-1"></a>N[<span class="dv">1</span>] <span class="ot">&lt;-</span> N1</span>
<span id="cb3-11"><a href="Trend.html#cb3-11" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n.years<span class="dv">-1</span>, mean.lambda, sigma.lambda) </span>
<span id="cb3-12"><a href="Trend.html#cb3-12" tabindex="-1"></a><span class="co"># Lambda is vector of annual population growth rates</span></span>
<span id="cb3-13"><a href="Trend.html#cb3-13" tabindex="-1"></a><span class="cf">for</span> (y <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n.years<span class="dv">-1</span>)){</span>
<span id="cb3-14"><a href="Trend.html#cb3-14" tabindex="-1"></a>  N[y<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> N[y] <span class="sc">*</span> lambda[y]</span>
<span id="cb3-15"><a href="Trend.html#cb3-15" tabindex="-1"></a>}</span>
<span id="cb3-16"><a href="Trend.html#cb3-16" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>n.years, <span class="at">mean=</span>N, <span class="at">sd=</span>sigma.obs) <span class="co"># Counts</span></span></code></pre></div>
<p>The JAGS code now fits a state-space model <span class="citation">(<a href="#ref-kéry.schaub_2011">Kéry and Schaub 2011</a>; <a href="#ref-auger-méthé.etal_2021">Auger-Méthé et al. 2021</a>)</span>, which has two parts: one describing the hidden or latent biological process for population change (state), and the second describing the survey observations. Fitting an underlying population model makes it possible to distinguish between the two sources of variation in survey counts: variation in population growth rate and survey sampling. The former is referred to as process error <span class="citation">(<a href="#ref-kéry.schaub_2011">Kéry and Schaub 2011</a>)</span>, as it is variation in the biological process (population growth). The latter is observation error, or random variation in the counts.</p>
<p>The JAGS code now has a parameter for initial abundance, the mean and standard deviation for the annual sequence of population growth rates, and the standard deviation for observation error. This is a hierarchical model structure, in that the annual estimates of population growth are drawn from a shared normal distribution with the mean and standard deviation as hyperparameters. Uninformative prior distributions are used for all parameters.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="Trend.html#cb4-1" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb4-2"><a href="Trend.html#cb4-2" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb4-3"><a href="Trend.html#cb4-3" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb4-4"><a href="Trend.html#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="Trend.html#cb4-5" tabindex="-1"></a><span class="co"># JAGS code for estimating model parameters</span></span>
<span id="cb4-6"><a href="Trend.html#cb4-6" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;Pop_ExpGr.txt&quot;</span>)</span>
<span id="cb4-7"><a href="Trend.html#cb4-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb4-8"><a href="Trend.html#cb4-8" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb4-9"><a href="Trend.html#cb4-9" tabindex="-1"></a><span class="st"># Priors</span></span>
<span id="cb4-10"><a href="Trend.html#cb4-10" tabindex="-1"></a><span class="st">N.est[1] ~ dunif(0, 1000)   # Initial abundance</span></span>
<span id="cb4-11"><a href="Trend.html#cb4-11" tabindex="-1"></a><span class="st">mean.lambda.est ~ dunif(0, 10)    # Mean growth rate</span></span>
<span id="cb4-12"><a href="Trend.html#cb4-12" tabindex="-1"></a><span class="st">sigma.proc.est ~ dunif(0, 10)  # Process error (annual variation in lambda)</span></span>
<span id="cb4-13"><a href="Trend.html#cb4-13" tabindex="-1"></a><span class="st">tau.proc.est &lt;- pow(sigma.proc.est, -2)</span></span>
<span id="cb4-14"><a href="Trend.html#cb4-14" tabindex="-1"></a><span class="st">sigma.obs.est ~ dunif(0, 100)     # Observation error</span></span>
<span id="cb4-15"><a href="Trend.html#cb4-15" tabindex="-1"></a><span class="st">tau.obs.est &lt;- pow(sigma.obs.est, -2)</span></span>
<span id="cb4-16"><a href="Trend.html#cb4-16" tabindex="-1"></a></span>
<span id="cb4-17"><a href="Trend.html#cb4-17" tabindex="-1"></a><span class="st"># Likelihood</span></span>
<span id="cb4-18"><a href="Trend.html#cb4-18" tabindex="-1"></a><span class="st">for (y in 1:(n.years-1)){</span></span>
<span id="cb4-19"><a href="Trend.html#cb4-19" tabindex="-1"></a><span class="st">   lambda[y] ~ dnorm(mean.lambda.est, tau.proc.est)</span></span>
<span id="cb4-20"><a href="Trend.html#cb4-20" tabindex="-1"></a><span class="st">   N.est[y+1] &lt;- N.est[y] * lambda[y]</span></span>
<span id="cb4-21"><a href="Trend.html#cb4-21" tabindex="-1"></a><span class="st">   } #y</span></span>
<span id="cb4-22"><a href="Trend.html#cb4-22" tabindex="-1"></a><span class="st">for (y in 1:n.years) {</span></span>
<span id="cb4-23"><a href="Trend.html#cb4-23" tabindex="-1"></a><span class="st">  C[y] ~ dnorm(N.est[y], tau.obs.est)</span></span>
<span id="cb4-24"><a href="Trend.html#cb4-24" tabindex="-1"></a><span class="st">   } #y</span></span>
<span id="cb4-25"><a href="Trend.html#cb4-25" tabindex="-1"></a><span class="st">     p.pos &lt;- step(mean.lambda.est-1)</span></span>
<span id="cb4-26"><a href="Trend.html#cb4-26" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb4-27"><a href="Trend.html#cb4-27" tabindex="-1"></a><span class="st">    &quot;</span>,<span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-28"><a href="Trend.html#cb4-28" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb4-29"><a href="Trend.html#cb4-29" tabindex="-1"></a></span>
<span id="cb4-30"><a href="Trend.html#cb4-30" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb4-31"><a href="Trend.html#cb4-31" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;n.years&quot;</span>, <span class="st">&quot;C&quot;</span>)</span>
<span id="cb4-32"><a href="Trend.html#cb4-32" tabindex="-1"></a></span>
<span id="cb4-33"><a href="Trend.html#cb4-33" tabindex="-1"></a><span class="co"># Initial values.</span></span>
<span id="cb4-34"><a href="Trend.html#cb4-34" tabindex="-1"></a>jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){<span class="fu">list</span>(<span class="at">sigma.proc.est =</span> <span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">10</span>), </span>
<span id="cb4-35"><a href="Trend.html#cb4-35" tabindex="-1"></a>                              <span class="at">mean.lambda.est =</span> <span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="fl">0.1</span>, <span class="at">max=</span><span class="dv">2</span>),</span>
<span id="cb4-36"><a href="Trend.html#cb4-36" tabindex="-1"></a>                              <span class="at">sigma.obs.est =</span> <span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">10</span>),</span>
<span id="cb4-37"><a href="Trend.html#cb4-37" tabindex="-1"></a>                              <span class="at">N.est =</span> <span class="fu">c</span>(<span class="fu">mean</span>(C),</span>
<span id="cb4-38"><a href="Trend.html#cb4-38" tabindex="-1"></a>                                           <span class="co">#rlnorm(n=1, meanlog=10, sdlog=1),</span></span>
<span id="cb4-39"><a href="Trend.html#cb4-39" tabindex="-1"></a>                                           <span class="fu">rep</span>(<span class="cn">NA</span>,(n.years<span class="dv">-1</span>))))}</span>
<span id="cb4-40"><a href="Trend.html#cb4-40" tabindex="-1"></a></span>
<span id="cb4-41"><a href="Trend.html#cb4-41" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;Pop_ExpGr.txt&#39;</span></span>
<span id="cb4-42"><a href="Trend.html#cb4-42" tabindex="-1"></a></span>
<span id="cb4-43"><a href="Trend.html#cb4-43" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb4-44"><a href="Trend.html#cb4-44" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;mean.lambda.est&quot;</span>, <span class="st">&quot;sigma.proc.est&quot;</span>, <span class="st">&quot;sigma.obs.est&quot;</span>, <span class="st">&quot;N.est&quot;</span>,</span>
<span id="cb4-45"><a href="Trend.html#cb4-45" tabindex="-1"></a>                 <span class="st">&quot;p.pos&quot;</span>)</span>
<span id="cb4-46"><a href="Trend.html#cb4-46" tabindex="-1"></a></span>
<span id="cb4-47"><a href="Trend.html#cb4-47" tabindex="-1"></a><span class="co"># Call JAGS from R</span></span>
<span id="cb4-48"><a href="Trend.html#cb4-48" tabindex="-1"></a>jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb4-49"><a href="Trend.html#cb4-49" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">40000</span>,</span>
<span id="cb4-50"><a href="Trend.html#cb4-50" tabindex="-1"></a>                model.file)</span>
<span id="cb4-51"><a href="Trend.html#cb4-51" tabindex="-1"></a><span class="fu">print</span>(jagsfit)</span>
<span id="cb4-52"><a href="Trend.html#cb4-52" tabindex="-1"></a><span class="co">#plot(jagsfit)</span></span>
<span id="cb4-53"><a href="Trend.html#cb4-53" tabindex="-1"></a></span>
<span id="cb4-54"><a href="Trend.html#cb4-54" tabindex="-1"></a>year.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span>n.years)</span>
<span id="cb4-55"><a href="Trend.html#cb4-55" tabindex="-1"></a>y.bounds<span class="ot">=</span><span class="fu">range</span>(N, C, jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>mean<span class="sc">$</span>N.est)</span>
<span id="cb4-56"><a href="Trend.html#cb4-56" tabindex="-1"></a><span class="fu">plot</span>(N, <span class="at">ylab=</span><span class="st">&quot;Population size&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="at">ylim=</span>y.bounds, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">type=</span><span class="st">&quot;b&quot;</span>)</span>
<span id="cb4-57"><a href="Trend.html#cb4-57" tabindex="-1"></a><span class="fu">points</span>(C, <span class="at">pch=</span><span class="dv">17</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb4-58"><a href="Trend.html#cb4-58" tabindex="-1"></a><span class="fu">points</span>(year.seq, jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>mean<span class="sc">$</span>N.est, <span class="at">pch=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;b&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb4-59"><a href="Trend.html#cb4-59" tabindex="-1"></a><span class="fu">par</span>(<span class="at">xpd=</span><span class="cn">TRUE</span>) <span class="co"># Turn off clipping to put legend above plot</span></span>
<span id="cb4-60"><a href="Trend.html#cb4-60" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;top&quot;</span>,</span>
<span id="cb4-61"><a href="Trend.html#cb4-61" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;N&quot;</span>, <span class="st">&quot;Counts&quot;</span>, <span class="st">&quot;Est&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>),</span>
<span id="cb4-62"><a href="Trend.html#cb4-62" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">2</span>), <span class="at">text.col =</span> <span class="st">&quot;black&quot;</span>,  <span class="at">horiz =</span> T , <span class="at">inset =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.2</span>))</span>
<span id="cb4-63"><a href="Trend.html#cb4-63" tabindex="-1"></a><span class="fu">par</span>(<span class="at">xpd=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p>This is a much more complex model than the linear regression, and we increase the number of iterations to achieve convergence (which should be confirmed by checking Rhat values). The smoothed pattern for estimated population size (Figure <a href="Trend.html#fig:ExpGrPlot">10.2</a>) is the model’s attempt to describe the biological process (exponential growth with year-to-year variation in growth rate). Variation in observed catches about the fitted line reflects estimated observation error. Is the model Try several runs using a small value for observation error to see that the model can closely mimic the population trajectory when observation error is low. It can also be instructive to try a shorter value for the length of the time series. The annual estimates of population growth rate are drawn from a shared normal distribution, so with a shorter time series (e.g., n.years=10) the model may be less successful in in sorting out process versus observation error.</p>
<div class="figure"><span style="display:block;" id="fig:ExpGrPlot"></span>
<img src="bookdown_files/figure-html/ExpGrPlot-1.png" alt="Example of fitted exponential growth model for annual counts (survey estimates of population size). Filled circles are true N, filled triangles are survey counts, and open triangles are model estimates." width="90%" />
<p class="caption">
FIGURE 10.2: Example of fitted exponential growth model for annual counts (survey estimates of population size). Filled circles are true N, filled triangles are survey counts, and open triangles are model estimates.
</p>
</div>
<p>We use the <code>step()</code> function (calculated parameter p.pos) to estimate the probability that the mean population growth rate is positive. We obtained probabilities of 0.73, 0.73, 0.40, 0.44, and 0.61 for five trials using the default settings, compared to 0.74, 0.69, 0.92, 0.99, and 0.91 for a simulation mean growth rate of 1.05. These results show the challenge in detecting a population trend, which will depend on the magnitude and annual variation in the mean annual change, the length of the time series, and the precision of the survey.</p>
<p>The legend is added above the plot, which shows true population size, annual counts, and the model estimates.</p>
<div id="Forecast" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Forecasting<a href="Trend.html#Forecast" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In Section <a href="Trend.html#ExpGr">10.2</a>, we fitted an exponential growth model to describe underlying population dynamics. One advantage of that approach is that we can use that underlying model to project future population levels. We add a new simulation setting (p.years) for the number of future years to predict abundance, and generate n.years+p.years values for population size (N). The catch vector has n.years of observed survey catches, augmented by p.years of NA values. The code for plotting catch is moved below the JAGS section, because now we need to choose a range for the y-axis that will accommodate the observed and predicted catches plus the (generally wider) credible intervals.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="Trend.html#cb5-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Clear Environment</span></span>
<span id="cb5-2"><a href="Trend.html#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="Trend.html#cb5-3" tabindex="-1"></a><span class="co"># Generation of simulated data</span></span>
<span id="cb5-4"><a href="Trend.html#cb5-4" tabindex="-1"></a>p.years <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># Predicted future population levels</span></span>
<span id="cb5-5"><a href="Trend.html#cb5-5" tabindex="-1"></a>n.years <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># Years of survey data</span></span>
<span id="cb5-6"><a href="Trend.html#cb5-6" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># Initial population size</span></span>
<span id="cb5-7"><a href="Trend.html#cb5-7" tabindex="-1"></a>mean.lambda <span class="ot">&lt;-</span> <span class="fl">1.02</span> <span class="co"># Mean annual population growth rate</span></span>
<span id="cb5-8"><a href="Trend.html#cb5-8" tabindex="-1"></a>sigma.lambda <span class="ot">&lt;-</span> <span class="fl">0.02</span> <span class="co"># Process (temporal) variation in the growth rate (SD)</span></span>
<span id="cb5-9"><a href="Trend.html#cb5-9" tabindex="-1"></a>p.survey <span class="ot">&lt;-</span> <span class="fl">0.025</span> <span class="co"># Default capture probability for survey</span></span>
<span id="cb5-10"><a href="Trend.html#cb5-10" tabindex="-1"></a>sigma.obs <span class="ot">&lt;-</span> <span class="dv">40</span> <span class="co"># Observation error for survey catch (SD)</span></span>
<span id="cb5-11"><a href="Trend.html#cb5-11" tabindex="-1"></a>C <span class="ot">&lt;-</span> N <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n.years<span class="sc">+</span>p.years)</span>
<span id="cb5-12"><a href="Trend.html#cb5-12" tabindex="-1"></a>N[<span class="dv">1</span>] <span class="ot">&lt;-</span> N1</span>
<span id="cb5-13"><a href="Trend.html#cb5-13" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">rnorm</span>((n.years<span class="sc">+</span>p.years<span class="dv">-1</span>), mean.lambda, sigma.lambda) </span>
<span id="cb5-14"><a href="Trend.html#cb5-14" tabindex="-1"></a>  <span class="co"># Draw vector of annual growth rates</span></span>
<span id="cb5-15"><a href="Trend.html#cb5-15" tabindex="-1"></a><span class="cf">for</span> (y <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n.years<span class="sc">+</span>p.years<span class="dv">-1</span>)){</span>
<span id="cb5-16"><a href="Trend.html#cb5-16" tabindex="-1"></a>  N[y<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> N[y] <span class="sc">*</span> lambda[y]</span>
<span id="cb5-17"><a href="Trend.html#cb5-17" tabindex="-1"></a>}</span>
<span id="cb5-18"><a href="Trend.html#cb5-18" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>n.years, <span class="at">mean=</span>p.survey<span class="sc">*</span>N, <span class="at">sd=</span>sigma.obs)</span>
<span id="cb5-19"><a href="Trend.html#cb5-19" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">c</span>(C, <span class="fu">rep</span>(<span class="cn">NA</span>, p.years))  <span class="co"># Observed survey catches augmented by NA values</span></span></code></pre></div>
<p>The likelihood in the JAGS code is modified slightly to accommodate the p.years of additional (missing) catches. We also add a <code>step()</code> function to estimate p.increase, the probability that predicted catch in the final year is higher than in year one. This is an arbitrary choice, but provides some insight into whether a detectable increase is expected over the modeled time horizon. Data passed to JAGS now includes p.years, and we modify the length of the vector of initial values for predicted catch.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="Trend.html#cb6-1" tabindex="-1"></a><span class="co"># Load necessary library</span></span>
<span id="cb6-2"><a href="Trend.html#cb6-2" tabindex="-1"></a><span class="fu">library</span>(rjags)</span>
<span id="cb6-3"><a href="Trend.html#cb6-3" tabindex="-1"></a><span class="fu">library</span>(R2jags)</span>
<span id="cb6-4"><a href="Trend.html#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="Trend.html#cb6-5" tabindex="-1"></a><span class="co"># JAGS code for estimating model parameters</span></span>
<span id="cb6-6"><a href="Trend.html#cb6-6" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">&quot;PopTrend_ExpGr.txt&quot;</span>)</span>
<span id="cb6-7"><a href="Trend.html#cb6-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span></span>
<span id="cb6-8"><a href="Trend.html#cb6-8" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb6-9"><a href="Trend.html#cb6-9" tabindex="-1"></a><span class="st"># Priors</span></span>
<span id="cb6-10"><a href="Trend.html#cb6-10" tabindex="-1"></a><span class="st">logC.est[1] ~ dunif(1, 100)     # Initial relative abundance</span></span>
<span id="cb6-11"><a href="Trend.html#cb6-11" tabindex="-1"></a><span class="st">mean.r.est ~ dnorm(0, 0.001)    # Mean growth rate</span></span>
<span id="cb6-12"><a href="Trend.html#cb6-12" tabindex="-1"></a><span class="st">sigma.proc.est ~ dunif(0, 1)  # Annual variation in r</span></span>
<span id="cb6-13"><a href="Trend.html#cb6-13" tabindex="-1"></a><span class="st">tau.proc.est &lt;- pow(sigma.proc.est, -2)</span></span>
<span id="cb6-14"><a href="Trend.html#cb6-14" tabindex="-1"></a><span class="st">sigma.obs.est ~ dunif(0, 100)     # Observation error</span></span>
<span id="cb6-15"><a href="Trend.html#cb6-15" tabindex="-1"></a><span class="st">tau.obs.est &lt;- pow(sigma.obs.est, -2)</span></span>
<span id="cb6-16"><a href="Trend.html#cb6-16" tabindex="-1"></a></span>
<span id="cb6-17"><a href="Trend.html#cb6-17" tabindex="-1"></a><span class="st"># Likelihood</span></span>
<span id="cb6-18"><a href="Trend.html#cb6-18" tabindex="-1"></a><span class="st">for (y in 1:(n.years+p.years-1)){</span></span>
<span id="cb6-19"><a href="Trend.html#cb6-19" tabindex="-1"></a><span class="st">   r[y] ~ dnorm(mean.r.est, tau.proc.est)</span></span>
<span id="cb6-20"><a href="Trend.html#cb6-20" tabindex="-1"></a><span class="st">   logC.est[y+1] &lt;- logC.est[y] + r[y]</span></span>
<span id="cb6-21"><a href="Trend.html#cb6-21" tabindex="-1"></a><span class="st">   } #y</span></span>
<span id="cb6-22"><a href="Trend.html#cb6-22" tabindex="-1"></a><span class="st">for (y in 1:(n.years+p.years)) {</span></span>
<span id="cb6-23"><a href="Trend.html#cb6-23" tabindex="-1"></a><span class="st">  C.est[y] &lt;- exp(logC.est[y])</span></span>
<span id="cb6-24"><a href="Trend.html#cb6-24" tabindex="-1"></a><span class="st">  C[y] ~ dnorm(C.est[y], tau.obs.est)</span></span>
<span id="cb6-25"><a href="Trend.html#cb6-25" tabindex="-1"></a><span class="st">   } #y</span></span>
<span id="cb6-26"><a href="Trend.html#cb6-26" tabindex="-1"></a><span class="st">p.pos &lt;- step(mean.r.est)</span></span>
<span id="cb6-27"><a href="Trend.html#cb6-27" tabindex="-1"></a><span class="st">p.increase &lt;- step(C.est[n.years+p.years]-C.est[1])</span></span>
<span id="cb6-28"><a href="Trend.html#cb6-28" tabindex="-1"></a><span class="st">  # Prob of increase from first to last</span></span>
<span id="cb6-29"><a href="Trend.html#cb6-29" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb6-30"><a href="Trend.html#cb6-30" tabindex="-1"></a><span class="st">    &quot;</span>,<span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-31"><a href="Trend.html#cb6-31" tabindex="-1"></a><span class="fu">sink</span>()</span>
<span id="cb6-32"><a href="Trend.html#cb6-32" tabindex="-1"></a></span>
<span id="cb6-33"><a href="Trend.html#cb6-33" tabindex="-1"></a><span class="co"># Bundle data</span></span>
<span id="cb6-34"><a href="Trend.html#cb6-34" tabindex="-1"></a>jags.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;n.years&quot;</span>, <span class="st">&quot;p.years&quot;</span>, <span class="st">&quot;C&quot;</span>)</span>
<span id="cb6-35"><a href="Trend.html#cb6-35" tabindex="-1"></a></span>
<span id="cb6-36"><a href="Trend.html#cb6-36" tabindex="-1"></a><span class="co"># Initial values.</span></span>
<span id="cb6-37"><a href="Trend.html#cb6-37" tabindex="-1"></a>jags.inits <span class="ot">&lt;-</span> <span class="cf">function</span>(){<span class="fu">list</span>(<span class="at">sigma.proc.est =</span> <span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">1</span>), </span>
<span id="cb6-38"><a href="Trend.html#cb6-38" tabindex="-1"></a>                              <span class="at">mean.r.est =</span> <span class="fu">rnorm</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>),</span>
<span id="cb6-39"><a href="Trend.html#cb6-39" tabindex="-1"></a>                              <span class="at">sigma.obs.est =</span> <span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">100</span>),</span>
<span id="cb6-40"><a href="Trend.html#cb6-40" tabindex="-1"></a>                              <span class="at">logC.est =</span> <span class="fu">c</span>(<span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min=</span><span class="dv">5</span>, <span class="at">max=</span><span class="dv">10</span>),</span>
<span id="cb6-41"><a href="Trend.html#cb6-41" tabindex="-1"></a>                                           <span class="fu">rep</span>(<span class="cn">NA</span>, (n.years<span class="sc">+</span>p.years<span class="dv">-1</span>))))}</span>
<span id="cb6-42"><a href="Trend.html#cb6-42" tabindex="-1"></a></span>
<span id="cb6-43"><a href="Trend.html#cb6-43" tabindex="-1"></a>model.file <span class="ot">&lt;-</span> <span class="st">&#39;PopTrend_ExpGr.txt&#39;</span></span>
<span id="cb6-44"><a href="Trend.html#cb6-44" tabindex="-1"></a></span>
<span id="cb6-45"><a href="Trend.html#cb6-45" tabindex="-1"></a><span class="co"># Parameters monitored</span></span>
<span id="cb6-46"><a href="Trend.html#cb6-46" tabindex="-1"></a>jags.params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;mean.r.est&quot;</span>, <span class="st">&quot;sigma.proc.est&quot;</span>, <span class="st">&quot;sigma.obs.est&quot;</span>, <span class="st">&quot;C.est&quot;</span>,</span>
<span id="cb6-47"><a href="Trend.html#cb6-47" tabindex="-1"></a>                 <span class="st">&quot;p.pos&quot;</span>, <span class="st">&quot;p.increase&quot;</span>)</span>
<span id="cb6-48"><a href="Trend.html#cb6-48" tabindex="-1"></a></span>
<span id="cb6-49"><a href="Trend.html#cb6-49" tabindex="-1"></a><span class="co"># Call JAGS from R</span></span>
<span id="cb6-50"><a href="Trend.html#cb6-50" tabindex="-1"></a>jagsfit <span class="ot">&lt;-</span> <span class="fu">jags</span>(<span class="at">data=</span>jags.data, jags.params, <span class="at">inits=</span>jags.inits,</span>
<span id="cb6-51"><a href="Trend.html#cb6-51" tabindex="-1"></a>                <span class="at">n.chains =</span> <span class="dv">3</span>, <span class="at">n.thin=</span><span class="dv">1</span>, <span class="at">n.iter =</span> <span class="dv">40000</span>,</span>
<span id="cb6-52"><a href="Trend.html#cb6-52" tabindex="-1"></a>                model.file)</span>
<span id="cb6-53"><a href="Trend.html#cb6-53" tabindex="-1"></a><span class="fu">print</span>(jagsfit)</span>
<span id="cb6-54"><a href="Trend.html#cb6-54" tabindex="-1"></a><span class="fu">plot</span>(jagsfit)</span></code></pre></div>
<p>Convergence was slower for this model compared to Section <a href="Trend.html#ExpGr">10.2</a>, so the number of iterations was increased to 40,000. Plotting the jagsfit object shows that uncertainty about predicted catch increases sharply over the forecast years. The future forecasts use annual population growth rates that are drawn randomly from the normal distribution. This makes clear how little can be said about population size or trends, even a couple of years into the future.</p>
<p>We can now plot the observed catches, augmented by the predicted catch vector and lines representing lower and upper 95% credible intervals <span class="citation">(<a href="#ref-kéry.schaub_2011">Kéry and Schaub 2011</a>)</span>. The <code>quantile()</code> function provides the 0.025 and 0.975 quantiles from the vector of retained MCMC updates (draws from the posterior distribution). The <code>ylim</code> plot option allows us to scale the y-axis to accommodate all four series.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="Trend.html#cb7-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co"># Return to default of 1 panel</span></span>
<span id="cb7-2"><a href="Trend.html#cb7-2" tabindex="-1"></a>year.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C))</span>
<span id="cb7-3"><a href="Trend.html#cb7-3" tabindex="-1"></a>lower <span class="ot">&lt;-</span> upper <span class="ot">&lt;-</span> <span class="fu">length</span>(C)</span>
<span id="cb7-4"><a href="Trend.html#cb7-4" tabindex="-1"></a><span class="cf">for</span> (y <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C)){</span>
<span id="cb7-5"><a href="Trend.html#cb7-5" tabindex="-1"></a>  lower[y] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.list<span class="sc">$</span>C.est[,y], <span class="fl">0.025</span>)</span>
<span id="cb7-6"><a href="Trend.html#cb7-6" tabindex="-1"></a>  upper[y] <span class="ot">&lt;-</span> <span class="fu">quantile</span>(jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>sims.list<span class="sc">$</span>C.est[,y], <span class="fl">0.975</span>)</span>
<span id="cb7-7"><a href="Trend.html#cb7-7" tabindex="-1"></a>} <span class="co">#y</span></span>
<span id="cb7-8"><a href="Trend.html#cb7-8" tabindex="-1"></a>min.y <span class="ot">&lt;-</span> <span class="fu">min</span>(C[<span class="dv">1</span><span class="sc">:</span>n.years],jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>mean<span class="sc">$</span>C.est, lower)</span>
<span id="cb7-9"><a href="Trend.html#cb7-9" tabindex="-1"></a>max.y <span class="ot">&lt;-</span> <span class="fu">max</span>(C[<span class="dv">1</span><span class="sc">:</span>n.years],jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>mean<span class="sc">$</span>C.est, upper)</span>
<span id="cb7-10"><a href="Trend.html#cb7-10" tabindex="-1"></a><span class="fu">plot</span>(year.seq, C, <span class="at">ylab=</span><span class="st">&quot;Survey Catch&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>,</span>
<span id="cb7-11"><a href="Trend.html#cb7-11" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(min.y, max.y))</span>
<span id="cb7-12"><a href="Trend.html#cb7-12" tabindex="-1"></a></span>
<span id="cb7-13"><a href="Trend.html#cb7-13" tabindex="-1"></a><span class="fu">points</span>(year.seq, jagsfit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>mean<span class="sc">$</span>C.est, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb7-14"><a href="Trend.html#cb7-14" tabindex="-1"></a><span class="fu">points</span>(year.seq, lower, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb7-15"><a href="Trend.html#cb7-15" tabindex="-1"></a><span class="fu">points</span>(year.seq, upper, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<p>The observed catches should generally fall within the 95% credible intervals (Figure <a href="Trend.html#fig:ForecastTrendPlot">10.3</a>). As in Section <a href="Trend.html#ExpGr">10.2</a>, the red line for predicted catch has a smoother trajectory than the individual catches. How many years into the future would you be confident in predicting the population trend?</p>
<div class="figure"><span style="display:block;" id="fig:ForecastTrendPlot"></span>
<img src="bookdown_files/figure-html/ForecastTrendPlot-1.png" alt="Example of fitted exponential growth model for survey catch versus year with forecasts for five additional years. Dashed lines represent lower and upper 95% credible intervals." width="90%" />
<p class="caption">
FIGURE 10.3: Example of fitted exponential growth model for survey catch versus year with forecasts for five additional years. Dashed lines represent lower and upper 95% credible intervals.
</p>
</div>
</div>
</div>
<div id="exercises-7" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Exercises<a href="Trend.html#exercises-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>For the linear model (Section <a href="Trend.html#Linear">10.1</a>), compare the probability of a positive mean growth rate (p.pos) for sigma.lambda=0.02 (default) and 0.01, using ten simulation trials at each level.</p></li>
<li><p>For the exponential growth model (Section <a href="Trend.html#ExpGr">10.2</a>), use simulation to determine the approximate level for observation error where p.pos would typically (e.g., 8 of 10) exceed 90%.</p></li>
<li><p>For the exponential growth model that includes forecasting (Section <a href="Trend.html#Forecast">10.2.1</a>), compare a sequence of estimates for p.increase (probability that predicted catch in final year exceeds year one) for mean population growth rates of 1.02 and 1.05.</p></li>
</ol>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-auger-méthé.etal_2021" class="csl-entry">
Auger-Méthé, Marie, Ken Newman, Diana Cole, Fanny Empacher, Rowenna Gryba, Aaron A. King, Vianey Leos-Barajas, et al. 2021. <span>“A Guide to State–Space Modeling of Ecological Time Series.”</span> <em>Ecological Monographs</em> 91 (4): e01470. <a href="https://doi.org/10.1002/ecm.1470">https://doi.org/10.1002/ecm.1470</a>.
</div>
<div id="ref-kéry.schaub_2011" class="csl-entry">
Kéry, Marc, and Michael Schaub. 2011. <em>Bayesian <span>Population Analysis</span> Using <span>WinBUGS</span>: <span>A Hierarchical Perspective</span></em>. 1st edition. Boston: Academic Press.
</div>
<div id="ref-pregler.etal_2019" class="csl-entry">
Pregler, Kasey C., R. Daniel Hanks, Evan S. Childress, Nathaniel P. Hitt, Daniel J. Hocking, Benjamin H. Letcher, Tyler Wagner, and Yoichiro Kanno. 2019. <span>“State-Space Analysis of Power to Detect Regional Brook Trout Population Trends over Time.”</span> <em>Canadian Journal of Fisheries and Aquatic Sciences</em> 76 (11): 2145–55. <a href="https://doi.org/10.1139/cjfas-2018-0241">https://doi.org/10.1139/cjfas-2018-0241</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Recruit.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="PopModels.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-crc/edit/master/10-AbundanceTrends.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown.pdf", "bookdown.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
